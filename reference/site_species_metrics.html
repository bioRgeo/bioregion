<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">bioregionalization</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bioregionalization">bioregionalization<a class="anchor" aria-label="anchor" href="#arg-bioregionalization"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species         rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1  945.036475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  719.454482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  824.641591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  422.970387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  370.027219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  360.063719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7  183.228045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  903.247868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  100.371314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10 1231.204734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11  549.190736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12  344.283940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13  193.837626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14  724.806678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15  209.256688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16  697.276477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17  526.743290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18 1562.079647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  559.003852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  666.227270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21  668.331313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22  162.915839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23  317.235474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24  175.225890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  330.192828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         3  Species1  610.405412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         3  Species2  191.096834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         3  Species3   40.197116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         3  Species4  854.194755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         3  Species5  175.244631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         3  Species6  142.753940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         3  Species7  945.517829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         3  Species8  564.153360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         3  Species9  616.826676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         3 Species10  851.120862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         3 Species11 1193.468888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         3 Species12  220.650366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         3 Species13  357.913882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         3 Species14  662.947826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         3 Species15  170.438636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         3 Species16  392.724542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         3 Species17  443.639048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         3 Species18  693.472580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         3 Species19   56.181364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         3 Species20 1182.540086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         3 Species21 1119.268384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         3 Species22  754.210598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         3 Species23  238.716037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         3 Species24 1031.916412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         3 Species25  108.851393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         2  Species1  424.310447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         2  Species2  215.729048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         2  Species3   46.784613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         2  Species4  380.595122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         2  Species5  129.542871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         2  Species6  108.128205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         2  Species7  147.336166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         2  Species8  534.420247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         2  Species9 1076.695882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         2 Species10  249.992400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         2 Species11  222.013253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         2 Species12    0.472789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         2 Species13  151.009124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         2 Species14  134.744857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         2 Species15  345.111321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         2 Species16   26.641238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         2 Species17  712.175852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         2 Species18  576.014564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         2 Species19  979.280086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         2 Species20  116.311746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         2 Species21  620.894818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         2 Species22  600.678213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         2 Species23   83.683648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         2 Species24  113.583065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         2 Species25  402.187911</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity    fidelity      indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2  Species1     8.2589664   8.00000   0.5000000     4.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2  Species2    42.6713265  38.00000   2.3750000    90.25000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2  Species3   712.5652694 622.00000  38.8750000 24180.25000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          2  Species4    68.0495403  62.00000   3.6470588   226.11765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2  Species5   157.9473684 151.00000   7.9473684  1200.05263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          2  Species6   404.5802243 375.00000  20.8333333  7812.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          2  Species7    15.2488136  15.00000   0.8333333    12.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          2  Species8   255.8421053 244.00000  12.8421053  3133.47368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2  Species9    -0.9176629   0.00000   0.0000000     0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2 Species10   753.7368421 717.00000  37.7368421 27057.31579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2 Species11   198.0138220 194.00000   9.7000000  1881.80000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2 Species12   201.5891125 182.00000  10.7058824  1948.47059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2 Species13    21.1052632  21.00000   1.1052632    23.21053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2 Species14    -0.9459053   0.00000   0.0000000     0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2 Species15    54.7922712  47.00000   3.1333333   147.26667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2 Species16     9.4060451   9.00000   0.5625000     5.06250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         2 Species17    -0.9733285   0.00000   0.0000000     0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         2 Species18   773.5836133 696.00000  40.9411765 28495.05882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         2 Species19   267.2327544 248.00000  13.7777778  3416.88889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         2 Species20   305.3523418 267.00000  16.6875000  4455.56250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         2 Species21    16.3302897  16.00000   0.8888889    14.22222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         2 Species22    -0.9733285   0.00000   0.0000000     0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         2 Species23   272.8102177 246.00000  14.4705882  3559.76471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         2 Species24   262.1143784 222.00000  14.8000000  3285.60000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         2 Species25    -0.9733285   0.00000   0.0000000     0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         1  Species1 15439.0000000 163.31579 193.9375000 31673.05592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         1  Species2  8639.0000000  91.73684 108.9375000  9993.58224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         1  Species3  4074.0000000  43.68421  51.8750000  2266.11842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         1  Species4 12620.8263200 137.78947 154.0000000 21219.57895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         1  Species5  4592.6735764  53.63158  53.6315789  2876.34626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         1  Species6  3021.2315737  34.63158  36.5555556  1265.97661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         1  Species7  9875.4533061 111.15789 117.3333333 13042.52632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         1  Species8 14517.1982236 167.47368 167.4736842 28047.43490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         1  Species9 13884.0000000 146.94737 174.5000000 25642.31579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         1 Species10 14980.6180060 172.78947 172.7894737 29856.20222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         1 Species11 14471.8319504 171.31579 162.7500000 27881.64474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         1 Species12  3559.6953687  39.47368  44.1176471  1741.48607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         1 Species13  5386.4520155  62.73684  62.7368421  3935.91136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         1 Species14 11922.3237199 130.21053 145.5294118 18949.46130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         1 Species15  5395.0658013  55.73684  70.6000000  3935.02105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         1 Species16  8724.0000000  92.63158 110.0000000 10189.47368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         1 Species17 13095.1461831 147.10526 155.2777778 22842.17836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         1 Species18 18786.0819084 204.68421 228.7647059 46824.52322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         1 Species19 11218.9561903 126.15789 133.1666667 16800.02632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         1 Species20 14029.0000000 148.47368 176.3125000 26177.76645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         1 Species21 18695.4318901 209.63158 221.2777778 46386.80994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         1 Species22 11784.6416153 132.47368 139.8333333 18524.23684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         1 Species23  3816.7831312  42.26316  47.2352941  1996.31269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         1 Species24  9149.2776582  94.00000 119.0666667 11192.26667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         1 Species25  6552.0514345  74.05263  78.1666667  5788.44737</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>net <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         4     site 0.8050000  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         1     site 0.8052930  0.6681531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         3     site 0.8050000  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         4     site 0.7901701  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         4     site 0.8052930  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         5     site 0.8016529  0.6454972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         5     site 0.8117914  0.6454972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         6     site 0.7986111        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         1     site 0.7951389  1.6035675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         6     site 0.7850000        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         3     site 0.8254848  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         6     site 0.8000000        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         1     site 0.7845805  0.6681531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         5     site 0.7709751 -1.2909944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         1     site 0.7727273  1.6035675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         2     site 0.8125000  1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         2     site 0.7986111 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         2     site 0.8052930  1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         1     site 0.7654321  0.6681531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         1     site 0.7981859  0.6681531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species1         5  species 0.8125000  0.6454972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species2         1  species 0.7578125 -0.2672612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species3         3  species 0.8046875 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species4         1  species 0.7889273 -0.2672612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species5         3  species 0.8033241 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species6         4  species 0.7901235 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species7         2  species 0.8271605 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  Species8         6  species 0.8199446        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Species10         4  species 0.7977839 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species11         2  species 0.8100000 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species12         4  species 0.8096886 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species13         1  species 0.8199446 -1.2026756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species15         5  species 0.8266667 -1.2909944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species16         6  species 0.8281250        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species18         6  species 0.7820069        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species19         1  species 0.7962963 -0.2672612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species20         4  species 0.7812500 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species21         1  species 0.8086420 -1.2026756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species23         1  species 0.8027682 -1.2026756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species24         2  species 0.7911111 -1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species14         5  species 0.8096886  0.6454972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 Species17         3  species 0.8148148 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 Species22         2  species 0.7962963 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species25         1  species 0.7901235 -0.2672612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  Species9         1  species 0.7968750 -1.2026756</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

