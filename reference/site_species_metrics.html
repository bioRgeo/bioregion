<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate metrics for sites and species relative to bioregions and chorotypes — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate metrics for sites and species relative to bioregions and chorotypes — site_species_metrics"><meta name="description" content="This function computes metrics that quantify how species and sites relate
to clusters (bioregions or chorotypes). Depending on the type of clustering,
metrics can measure how species are distributed across bioregions (site
clusters), how sites relate to chorotypes (species clusters), or both."><meta property="og:description" content="This function computes metrics that quantify how species and sites relate
to clusters (bioregions or chorotypes). Depending on the type of clustering,
metrics can measure how species are distributed across bioregions (site
clusters), how sites relate to chorotypes (species clusters), or both."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_summary_metrics.html">5.2 Summary metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_compare_bioregionalizations.html">5.3 Compare bioregionalizations</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.3.0">Version 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate metrics for sites and species relative to bioregions and chorotypes</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes metrics that quantify how species and sites relate
to clusters (bioregions or chorotypes). Depending on the type of clustering,
metrics can measure how species are distributed across bioregions (site
clusters), how sites relate to chorotypes (species clusters), or both.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">bioregionalization</span>,</span>
<span>  bioregion_metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Specificity"</span>, <span class="st">"NSpecificity"</span>, <span class="st">"Fidelity"</span>, <span class="st">"IndVal"</span>, <span class="st">"NIndVal"</span>,</span>
<span>    <span class="st">"Rho"</span><span class="op">)</span>,</span>
<span>  bioregionalization_metrics <span class="op">=</span> <span class="st">"P"</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_cluster <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">similarity</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bioregionalization">bioregionalization<a class="anchor" aria-label="anchor" href="#arg-bioregionalization"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-bioregion-metrics">bioregion_metrics<a class="anchor" aria-label="anchor" href="#arg-bioregion-metrics"></a></dt>
<dd><p>A <code>character</code> vector or a single <code>character</code> string
specifying the metrics to compute for each cluster. Available metrics depend
on the type of clustering (see arg <code>cluster_on</code>):</p><ul><li><p><strong>When sites are clustered into bioregions</strong> (default case):
species-level metrics include <code>"Specificity"</code>, <code>"NSpecificity"</code>,
<code>"Fidelity"</code>, <code>"IndVal"</code>, <code>"NIndVal"</code>, <code>"Rho"</code>, and <code>"CoreTerms"</code>.
Site-level metrics include <code>"Richness"</code>, <code>"Rich_Endemics"</code>,
<code>"Prop_Endemics"</code>, <code>"MeanSim"</code>, and <code>"SdSim"</code>.</p></li>
<li><p><strong>When species are clustered into chorotypes</strong> (e.g., bipartite
network clustering): site-level metrics include <code>"Specificity"</code>,
<code>"NSpecificity"</code>, <code>"Fidelity"</code>, <code>"IndVal"</code>, <code>"NIndVal"</code>, <code>"Rho"</code>,
and <code>"CoreTerms"</code>.</p></li>
</ul><p>Use <code>"all"</code> to compute all available metrics. See Details for metric
descriptions.</p></dd>


<dt id="arg-bioregionalization-metrics">bioregionalization_metrics<a class="anchor" aria-label="anchor" href="#arg-bioregionalization-metrics"></a></dt>
<dd><p>A <code>character</code> vector or a single <code>character</code>
string specifying summary metrics computed across all clusters. These
metrics assess how an entity (species or site) is distributed across the
entire bioregionalization, rather than relative to each individual cluster:</p><ul><li><p><code>"P"</code>: Participation coefficient measuring how evenly a species or
site is distributed across clusters (0 = restricted to one cluster,
1 = evenly spread).</p></li>
<li><p><code>"Silhouette"</code>: How well a site fits its assigned bioregion compared
to the nearest alternative bioregion (requires similarity data).</p></li>
</ul><p>Use <code>"all"</code> to compute all available metrics.</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>A <code>character</code> string specifying whether metrics should be
computed based on presence/absence (<code>"occurrence"</code>) or abundance values
(<code>"abundance"</code>). This affects how Specificity, Fidelity, IndVal, Rho and
CoreTerms are calculated:</p><ul><li><p><code>"auto"</code> (default): Automatically detected from input data (<code>bioregionalization</code> and/or <code>comat</code>).</p></li>
<li><p><code>"occurrence"</code>: Metrics based on presence/absence only.</p></li>
<li><p><code>"abundance"</code>: Metrics weighted by abundance values.</p></li>
<li><p><code>"both"</code>: Compute both versions of the metrics.</p></li>
</ul></dd>


<dt id="arg-cluster-on">cluster_on<a class="anchor" aria-label="anchor" href="#arg-cluster-on"></a></dt>
<dd><p>A <code>character</code> string specifying what was clustered in the
bioregionalization, which determines what types of metrics can be computed:</p><ul><li><p><code>"site"</code> (default): Sites were clustered into bioregions. Metrics
describe how each <strong>species</strong> is distributed across bioregions.</p></li>
<li><p><code>"species"</code>: Species were clustered into chorotypes. Metrics describe
how each <strong>site</strong> relates to chorotypes. Only available when species have
been assigned to clusters (e.g., bipartite network clustering).</p></li>
<li><p><code>"both"</code>: Compute metrics for both perspectives. Only available
when both sites and species have cluster assignments.</p></li>
</ul></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A site-species <code>matrix</code> with sites as rows and species as
columns. Values can be occurrence (1/0) or abundance. Required for most
metrics.</p></dd>


<dt id="arg-similarity">similarity<a class="anchor" aria-label="anchor" href="#arg-similarity"></a></dt>
<dd><p>A site-by-site similarity object from <code><a href="similarity.html">similarity()</a></code> or
<code><a href="dissimilarity_to_similarity.html">dissimilarity_to_similarity()</a></code>. Required only for similarity-based metrics
(<code>"MeanSim"</code>, <code>"SdSim"</code>, <code>"Silhouette"</code>).</p></dd>


<dt id="arg-include-cluster">include_cluster<a class="anchor" aria-label="anchor" href="#arg-include-cluster"></a></dt>
<dd><p>A <code>boolean</code> indicating whether to add an <code>Assigned</code>
column in the output, marking <code>TRUE</code> for rows where the site belongs to the
bioregion being evaluated. Useful for quickly identifying a site's own
bioregion. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>The name or number of the column to use as similarity.
By default, the third column name of <code>similarity</code> is used.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>boolean</code> indicating whether to
display progress messages. Set to <code>FALSE</code> to suppress these messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> containing one or more <code>data.frame</code> elements, depending on the
selected metrics and clustering type:</p>
<p><strong>When sites are clustered (<code>cluster_on = "site"</code>):</strong></p><ul><li><p><strong>species_bioregions</strong>: Metrics for each species x bioregion
combination (e.g., Specificity, IndVal). One row per species x bioregion
pair.</p></li>
<li><p><strong>species_bioregionalization</strong>: Summary metrics for each species
across all bioregions (e.g., Participation coefficient). One row per
species.</p></li>
<li><p><strong>site_bioregions</strong>: Metrics for each site x bioregion combination
(e.g., MeanSim, Richness). One row per site x bioregion pair.</p></li>
<li><p><strong>site_bioregionalization</strong>: Summary metrics for each site
(e.g., Silhouette). One row per site.</p></li>
</ul><p><strong>When species are clustered (<code>cluster_on = "species"</code>):</strong></p><ul><li><p><strong>site_chorotypes</strong>: Metrics for each site x chorotype combination
(e.g., Specificity, IndVal). One row per site x chorotype pair.</p></li>
<li><p><strong>site_chorological</strong>: Summary metrics for each site across all
chorotypes (e.g., Participation coefficient). One row per site.</p></li>
</ul><p>Note that if <code>bioregionalization</code> contains multiple partitions
(i.e., if <code>dim(bioregionalization$clusters) &gt; 2</code>), a nested list will be
returned, with one sublist per partition.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function computes metrics that characterize the relationship between
species, sites, and clusters. The available metrics depend on whether you
clustered sites (into bioregions) or species (into chorotypes).</p><div class="section">
<h3 id="-understanding-the-two-perspectives-">— 1. Understanding the two perspectives —<a class="anchor" aria-label="anchor" href="#-understanding-the-two-perspectives-"></a></h3>

<ul><li><p><strong>Bioregions</strong> are clusters of sites with similar species composition.</p></li>
<li><p><strong>Chorotypes</strong> are clusters of species with similar distributions.</p></li>
</ul><p>In general, the package is designed to cluster sites into bioregions.
However, it is possible to group species into clusters.
We call these species clusters 'chorotypes',
following conceptual definitions in the biogeographical literature, to
avoid any confusion in the calculation of metrics.</p>
<p>In some cases, such as bipartite network clustering, both species and sites
receive the same clusters. We maintain the name distinction in the
calculation of metrics - but remember that in this case
BIOREGION IDs = CHOROTYPE IDs.
The <code>cluster_on</code> argument determines
which perspective to use.</p>
</div>

<div class="section">
<h3 id="-metrics-when-sites-are-clustered-cluster-on-site-or-cluster-on-both-">— 2. Metrics when sites are clustered (<code>cluster_on = "site"</code> or <code>cluster_on = "both"</code>) —<a class="anchor" aria-label="anchor" href="#-metrics-when-sites-are-clustered-cluster-on-site-or-cluster-on-both-"></a></h3>


<p><strong>Species-per-bioregion metrics</strong> quantify how each species is distributed
across bioregions.</p>
<p>These metrics are derived from three core terms (<a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#metric-components" class="external-link">see the online vignette for a visual diagram</a>):</p><ul><li><p><strong>n_sb</strong>: Number of sites in bioregion <strong>b</strong> where species
<strong>s</strong> is present</p></li>
<li><p><strong>n_s</strong>: Total number of sites in which species <strong>s</strong> is present.</p></li>
<li><p><strong>n_b</strong>: Total number of sites in bioregion <strong>b</strong>.</p></li>
</ul><p>Abundance version of these core terms can also be calculated when
<code>data_type = "abundance"</code> (or <code>data_type = "auto"</code> and
<code>bioregionalization was based on abundance</code>):</p><ul><li><p><strong>w_sb</strong>: Sum of abundances of species <strong>s</strong> in sites of bioregion <strong>b</strong>.</p></li>
<li><p><strong>w_s</strong>: Total abundance of species <strong>s</strong>.</p></li>
<li><p><strong>w_b</strong>: Total abundance of all species present in sites of bioregion <strong>b</strong>.</p></li>
</ul><p>The species-per-bioregion metrics are (click on metric names to access formulas):</p><ul><li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#specificity-occurrence" class="external-link"><strong>Specificity</strong></a>:
Fraction of a species' occurrences found in a given bioregion
(De Cáceres &amp; Legendre 2009). A value of
1 means the species occurs only in that bioregion.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#nspecificity-occurrence" class="external-link"><strong>NSpecificity</strong></a>:
Normalized specificity that accounts for differences in bioregion size
(De Cáceres &amp; Legendre 2009).</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#fidelity-occurrence" class="external-link"><strong>Fidelity</strong></a>:
Fraction of sites in a bioregion where the species occurs
(De Cáceres &amp; Legendre 2009). A value of 1
means the species is present in all sites of that bioregion.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#indval-occurrence" class="external-link"><strong>IndVal</strong></a>:
Indicator Value = Specificity × Fidelity
(De Cáceres &amp; Legendre 2009). High values identify species
that are both restricted to and frequent within a bioregion.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#nindval-occurrence" class="external-link"><strong>NIndVal</strong></a>:
Normalized IndVal accounting for bioregion size
(De Cáceres &amp; Legendre 2009).</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#rho-occurrence" class="external-link"><strong>Rho</strong></a>:
Standardized contribution index comparing observed vs. expected
co-occurrence under random association (Lenormand 2019).</p></li>
<li><p><strong>CoreTerms</strong>: Raw counts (n, n_b, n_s, n_sb) for custom calculations.</p></li>
</ul><p>These metrics can be found in the output slot <code>species_bioregions</code>.</p>
<p><strong>Site-per-bioregion metrics</strong> characterize sites relative to bioregions:</p><ul><li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#diversity-endemicity-site-metrics" class="external-link"><strong>Richness</strong></a>:
Number of species in the site.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#diversity-endemicity-site-metrics" class="external-link"><strong>Rich_Endemics</strong></a>:
Number of species in the site that are endemic to one bioregion.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#diversity-endemicity-site-metrics" class="external-link"><strong>Prop_Endemics</strong></a>:
Proportion of endemic species in the site.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#meansim" class="external-link"><strong>MeanSim</strong></a>:
Mean similarity of a site to all sites in each bioregion.</p></li>
<li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#sdsim" class="external-link"><strong>SdSim</strong></a>:
Standard deviation of similarity values.</p></li>
</ul><p>These metrics can be found in the output slot <code>site_bioregions</code>.</p>
<p><strong>Summary metrics across the whole bioregionalization:</strong></p>
<p>These metrics summarize how an entity (species or site) is distributed
across all clusters, rather than in relation to each individual cluster.</p>
<p><em>Species-level summary metric:</em></p><ul><li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#p-occurrence-1" class="external-link"><strong>P</strong></a>
(Participation): Evenness of species distribution across bioregions
(Denelle et al. 2020). Found in output slot <code>species_bioregionalization</code>.</p></li>
</ul><p><em>Site-level summary metric:</em></p><ul><li><p><a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html#silhouette" class="external-link"><strong>Silhouette</strong></a>:
How well a site fits its assigned bioregion vs. the nearest alternative
(Rousseeuw 1987). Found in output slot <code>site_bioregionalization</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="-metrics-when-species-are-clustered-cluster-on-species-or-cluster-on-both-">— 3. Metrics when species are clustered (<code>cluster_on = "species"</code> or <code>cluster_on = "both"</code>) —<a class="anchor" aria-label="anchor" href="#-metrics-when-species-are-clustered-cluster-on-species-or-cluster-on-both-"></a></h3>


<p><strong>Site-per-chorotype metrics</strong> quantify how each site relates to species
clusters (chorotypes).</p>
<p>The same metrics as above (Specificity, Fidelity,
IndVal, etc.) can be computed, but their interpretation is inverted. These
metrics are based on the following core terms:</p><ul><li><p><strong>n_gc</strong>: Number of species belonging to chorotype <strong>c</strong> that are present
in site <strong>g</strong>.</p></li>
<li><p><strong>n_g</strong>: Total number of species present in site <strong>g</strong>.</p></li>
<li><p><strong>n_c</strong>: Total number of species belonging to chorotype <strong>c</strong>.</p></li>
</ul><p>Abundance version of these core terms can also be calculated when
<code>data_type = "abundance"</code> (or <code>data_type = "auto"</code> and
<code>bioregionalization was based on abundance</code>).</p>
<p>Their interpretation changes, for example:</p><ul><li><p><strong>Specificity</strong>: Fraction of a site's species belonging to a chorotype.</p></li>
<li><p><strong>Fidelity</strong>: Fraction of a chorotype's species present in the site.</p></li>
<li><p><strong>IndVal</strong>: Indicator value for site-chorotype associations.</p></li>
<li><p><strong>P</strong>: Evenness of sites across chorotypes</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If <code>data_type = "auto"</code>, the choice between occurrence- or abundance-
based metrics will be determined automatically from the input data, and a
message will explain the choice made.</p>
<p>Strict matching between entity IDs (site and species IDs) in
<code>bioregionalization</code> and in <code>comat</code> / <code>similarity</code> is required.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De Cáceres M &amp; Legendre P (2009) Associations between species and groups of
sites: indices and statistical inference. <em>Ecology</em> 90, 3566–3574.</p>
<p>Denelle P, Violle C &amp; Munoz F (2020) Generalist plants are more competitive
and more functionally similar to each other than specialist plants: insights
from network analyses. <em>Journal of Biogeography</em> 47, 1922–-1933.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
<p>Rousseeuw PJ (1987) Silhouettes: A graphical aid to the interpretation and
validation of cluster analysis. <em>Journal of Computational and Applied
Mathematics</em> 20, 53–65.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_2_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fishmat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fishsim</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">fishmat</span>, metric <span class="op">=</span> <span class="st">"Jaccard"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bioregionalization</span> <span class="op">&lt;-</span> <span class="fu"><a href="hclu_hierarclust.html">hclu_hierarclust</a></span><span class="op">(</span><span class="fu"><a href="similarity_to_dissimilarity.html">similarity_to_dissimilarity</a></span><span class="op">(</span><span class="va">fishsim</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       index <span class="op">=</span> <span class="st">"Jaccard"</span>,</span></span>
<span class="r-in"><span>                                       method <span class="op">=</span> <span class="st">"average"</span>,</span></span>
<span class="r-in"><span>                                       randomize <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                       optimal_tree_method <span class="op">=</span> <span class="st">"best"</span>,</span></span>
<span class="r-in"><span>                                       n_clust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                     </span></span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">bioregionalization</span>,</span></span>
<span class="r-in"><span>                             bioregion_metrics <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>                             bioregionalization_metrics <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>                             data_type <span class="op">=</span> <span class="st">"auto"</span>,</span></span>
<span class="r-in"><span>                             cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span></span>
<span class="r-in"><span>                             comat <span class="op">=</span> <span class="va">fishmat</span>,</span></span>
<span class="r-in"><span>                             similarity <span class="op">=</span> <span class="va">fishsim</span>,</span></span>
<span class="r-in"><span>                             include_cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                             index <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                             verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The bioregionalization is based on occurence data and comat is based on occurence data so occurrence-based metrics will be computed.</span>
<span class="r-in"><span>                                     </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

