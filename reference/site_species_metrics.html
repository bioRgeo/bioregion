<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">cluster_object</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  bipartite_link <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-object">cluster_object<a class="anchor" aria-label="anchor" href="#arg-cluster-object"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object, a <code>data.frame</code>, or a
list of <code>data.frame</code>s containing multiple partitions. At least two
partitions are required. If a list of <code>data.frame</code>s is provided, they must
all have the same number of rows (i.e., the same items in the clustering).</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code> and <code>Cz</code>.</p></dd>


<dt id="arg-bipartite-link">bipartite_link<a class="anchor" aria-label="anchor" href="#arg-bipartite-link"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity, fidelity, and individual contributions describe how species are
linked to their bioregions. These metrics are described in Bernardo-Madrid
et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species         rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          3  Species1 1191.229995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          3  Species2  338.426329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          3  Species3 1236.049759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          3  Species4  995.801235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          3  Species5  393.120705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          3  Species6 1229.184152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          3  Species7 1376.897148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          3  Species8  283.831132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          3  Species9  392.148314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         3 Species10  377.235660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         3 Species11  698.520261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         3 Species12 2033.028308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         3 Species13  808.701425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         3 Species14 1134.941452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         3 Species15 1690.869865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         3 Species16 1013.666612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         3 Species17 1467.296632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         3 Species18 1426.422338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         3 Species19  195.044290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         3 Species20  240.234261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         3 Species21  267.784143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         3 Species22 2000.140620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         3 Species23 1029.668442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         3 Species24  216.378834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         3 Species25 1322.873723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1   17.762011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  284.675902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3  125.179418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4  427.341085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5  437.062360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6  955.319364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7  268.880931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8  164.763439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  523.085323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10   39.485148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11    1.605051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12  848.467163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13  752.870899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14  108.779583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15  559.112793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16  353.320570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17   31.918653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18   -1.661700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19   84.084431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20   95.365694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21  481.436687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22  258.211417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23   50.776337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24  442.645146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25  132.449843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         1  Species1  232.215557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         1  Species2  712.417704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         1  Species3   58.735849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         1  Species4  762.528787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         1  Species5  337.361842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         1  Species6  737.355158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         1  Species7  142.603633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         1  Species8  692.225571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         1  Species9  237.319552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         1 Species10 1333.206945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         1 Species11  441.312542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         1 Species12   68.818608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         1 Species13  371.947144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         1 Species14  746.247241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         1 Species15  535.750103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         1 Species16  261.489779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         1 Species17  780.133085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         1 Species18  976.890267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         1 Species19  414.031670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         1 Species20 1285.807906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         1 Species21  794.272056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         1 Species22 1084.670815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         1 Species23  588.287424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         1 Species24  412.636487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         1 Species25  383.012426</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity     fidelity       indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1 10589.6008597 122.42105 122.42105263 1.498691e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  9999.6959954 118.68421 112.75000000 1.338164e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  8643.2078343  88.84211 112.53333333 9.997698e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4 16118.5200460 185.84211 185.84210526 3.453729e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  8470.6678341  95.47368 100.77777778 9.621626e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6 21153.2030671 249.94737 237.45000000 5.935000e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7 12934.8686460 145.31579 153.38888889 2.228983e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  7910.7844818  86.68421  96.88235294 8.398170e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  8124.2158318  89.00000  99.47058824 8.852882e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10 13527.1604982 133.89474 181.71428571 2.433059e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11  8465.9537889  95.42105 100.72222222 9.611020e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12 18426.4423287 212.31579 212.31578947 4.507799e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13 13862.6087202 151.26316 169.05882353 2.557237e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14 12787.4035902 147.63158 147.63157895 2.179508e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15 20261.7681997 233.36842 233.36842105 5.446082e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16 11761.0713892 132.21053 139.55555556 1.845071e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17 16991.3182832 185.21053 207.00000000 3.833858e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18 18038.5302616 178.31579 242.00000000 4.315242e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  4534.0000000  48.52632  57.62500000 2.796329e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20 12536.8470917 128.52632 162.80000000 2.092408e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21 11451.8046073 125.10526 139.82352941 1.749266e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22 24808.7880450 285.52632 285.52631579 8.152528e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23 12459.0000000 131.94737 156.68750000 2.067450e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24  7815.4155502  88.15789  93.05555556 8.203582e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25 13178.6582576 143.84211 160.76470588 2.312473e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1     1.1052632   2.00000   0.10526316 2.105263e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2     0.0000000   1.00000   0.05000000 5.000000e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3   374.6606652 317.00000  21.13333333 6.699267e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4     2.1578947   3.00000   0.15789474 4.736842e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5    -0.9733285   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6     8.2078268   9.00000   0.45000000 4.050000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7    -0.9733285   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8   165.9785599 150.00000   8.82352941 1.323529e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9    29.1004984  27.00000   1.58823529 4.288235e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10    -0.8583951   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11    21.7376704  21.00000   1.16666667 2.450000e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12   595.8421053 567.00000  29.84210526 1.692047e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13     5.7310733   6.00000   0.35294118 2.117647e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14   474.7894737 452.00000  23.78947368 1.075284e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15     2.1578947   3.00000   0.15789474 4.736842e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16     9.8414329  10.00000   0.55555556 5.555556e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17     5.7310733   6.00000   0.35294118 2.117647e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18     1.5941623   2.00000   0.14285714 2.857143e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19   164.2616655 144.00000   9.00000000 1.296000e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20    -0.8885233   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21     2.3925840   3.00000   0.17647059 5.294118e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22     1.1052632   2.00000   0.10526316 2.105263e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23    -0.9176629   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24     0.1081476   1.00000   0.05555556 5.555556e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25    76.9521785  70.00000   4.11764706 2.882353e+02</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>bipartite_link <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Column 'Node1' has been renamed 'Sites'. If this column does not</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             correspond to sites, rename it before running the function.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Column 'Node2' has been renamed 'Species'. If this column does not</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             correspond to species, rename it before running the function.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         1     site 0.8163265  1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         1     site 0.8199446 -1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         3     site 0.8128544  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         5     site 0.8144044  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         3     site 0.8159722  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         3     site 0.8090737  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         2     site 0.8140496 -1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         2     site 0.7977316  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         2     site 0.8159722  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         4     site 0.7936508  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         4     site 0.7845805  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         2     site 0.7809917  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         5     site 0.8057851  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         1     site 0.8072562  1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         2     site 0.8117914 -1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         1     site 0.8194444  1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         2     site 0.8200000 -1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         6     site 0.8128544  1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         2     site 0.7981859  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         4     site 0.8099174  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species1         4  species 0.7645429 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species2         3  species 0.7800000 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species3         5  species 0.7733333 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species5         1  species 0.7839506  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species6         1  species 0.7800000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species7         4  species 0.8024691 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species8         6  species 0.7958478 -0.5773503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 Species11         3  species 0.7530864 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Species12         2  species 0.7700831  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species13         5  species 0.7958478 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species15         4  species 0.7645429 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species16         1  species 0.7777778  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species17         1  species 0.7474048 -1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species18         4  species 0.7244898 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species19         3  species 0.7421875 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species20         3  species 0.7466667 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species21         6  species 0.7820069 -0.5773503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species22         2  species 0.7756233  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species23         2  species 0.8125000 -2.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species24         2  species 0.7592593  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species25         1  species 0.7820069 -1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  Species4         2  species 0.7756233  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  Species9         5  species 0.7820069 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species10         3  species 0.8061224 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species14         2  species 0.7756233  1.0000000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

