<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">bioregionalization</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bioregionalization">bioregionalization<a class="anchor" aria-label="anchor" href="#arg-bioregionalization"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of class <code>bioregion.site.species.metrics</code> containing one element
per bioregionalization. Each element is a list with:</p><ul><li><p><code>name</code>: Character, the bioregionalization name</p></li>
<li><p><code>metrics</code>: A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and
the requested contribution metrics (e.g., <code>rho</code>, <code>affinity</code>, <code>fidelity</code>,
<code>indicator_value</code>)</p></li>
<li><p><code>indices</code>: Character vector of computed indices</p></li>
<li><p><code>cz_metrics</code>: (If <code>Cz</code> requested) A <code>data.frame</code> with Cz metrics for nodes</p></li>
<li><p><code>args</code>: List of input arguments</p></li>
</ul><p>For a single bioregionalization, the list contains one element accessible via
<code>result[[1]]</code> or <code>result$bioregionalization_name</code>.</p>
<p>For multiple bioregionalizations, access individual results via
<code>result$bioregionalization_name</code> or <code>result[[i]]</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When multiple bioregionalizations are provided (i.e., the <code>clusters</code> arg has more
than 2 columns), the function computes metrics for each bioregionalization
separately. The output is always returned as a named list of class
<code>bioregion.site.species.metrics</code>, regardless of the number of
bioregionalizations.</p>
<p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single bioregionalization</span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust1</span>, </span></span>
<span class="r-in"><span>                                comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>                                indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print shows summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site and species contribution metrics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of bioregionalizations:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Bioregionalizations:  K_3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Computed indices:  rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bioregionalization 'K_3':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Metrics:  75  rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Unique species:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Bioregions:  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Columns:  Bioregion, Species, rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Access individual results with:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   your_object[[1]]$metrics  # Contribution metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Or see the full list structure with str(your_object)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the data</span></span></span>
<span class="r-in"><span><span class="va">metrics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metrics</span>  <span class="co"># The contribution metrics data.frame</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species         rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1 -0.35355339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  1.32637071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  1.02740233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  0.48432210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  0.48432210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  0.66318535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10  0.23570226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13  0.38527588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14  0.48432210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15 -0.35355339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16  0.23570226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18  0.48432210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  1.02740233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  0.12459083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22 -1.54110350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23 -1.98955606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25 -0.12108053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1  0.27272727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3 -1.87577145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4 -0.79252708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5 -0.68493489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6 -0.68493489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8 -1.19367274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10 -0.33333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13  1.18879062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14 -0.68493489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15  0.27272727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16 -0.33333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18 -0.68493489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19 -1.45296631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20 -0.41646811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22  1.18879062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23  1.53472209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24 -0.51157403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25 -0.06226681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         3  Species1  0.10188534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         3  Species2  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         3  Species3  0.57334084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         3  Species4 -0.29607194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         3  Species5  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         3  Species6  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         3  Species7  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         3  Species8  0.57334084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         3  Species9  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         3 Species10  0.10188534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         3 Species11  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         3 Species12  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         3 Species13 -1.77643163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         3 Species14  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         3 Species15  0.10188534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         3 Species16  0.10188534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         3 Species17  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         3 Species18  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         3 Species19  0.44410791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         3 Species20  0.32313597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         3 Species21  0.20935448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         3 Species22  0.44410791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         3 Species23  0.57334084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         3 Species24  0.57334084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         3 Species25  0.20935448</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metrics</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Bioregion  Species        rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1 Species1 -0.3535534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1 Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1 Species3  1.3263707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1 Species4  1.0274023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         1 Species5  0.4843221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         1 Species6  0.4843221</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple contribution metrics</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">metrics_all</span> <span class="op">&lt;-</span> <span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">com</span>, </span></span>
<span class="r-in"><span>                                    comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>                                    indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, </span></span>
<span class="r-in"><span>                                               <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metrics_all</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metrics</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Bioregion  Species        rho  affinity  fidelity    indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1 Species1  4.3588989 1.0000000 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1 Species2  0.0000000 1.0000000 0.9500000 0.9500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         1 Species3 -1.2909944 0.7368421 0.9333333 0.6877193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1 Species4 -1.0000000 0.7894737 0.9375000 0.7401316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         1 Species5 -0.4714045 0.8947368 0.9444444 0.8450292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         1 Species6 -0.4714045 0.8947368 0.9444444 0.8450292</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple bioregionalizations</span></span></span>
<span class="r-in"><span><span class="co"># Create two different clustering solutions</span></span></span>
<span class="r-in"><span><span class="va">clust_k3</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_k4</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">4</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine them into one bioregion.clusters object</span></span></span>
<span class="r-in"><span><span class="va">clust_multi</span> <span class="op">&lt;-</span> <span class="va">clust_k3</span></span></span>
<span class="r-in"><span><span class="va">clust_multi</span><span class="op">$</span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">clust_k3</span><span class="op">$</span><span class="va">clusters</span>, K_4 <span class="op">=</span> <span class="va">clust_k4</span><span class="op">$</span><span class="va">clusters</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metrics_multi</span> <span class="op">&lt;-</span> <span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust_multi</span>, </span></span>
<span class="r-in"><span>                                      comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>                                      indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Multiple bioregionalizations detected (2 columns). Computing metrics for each...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pretty print of results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">metrics_multi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site and species contribution metrics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of bioregionalizations:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Bioregionalizations:  K_3, K_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Computed indices:  rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bioregionalization 'K_3':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Metrics:  75  rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Unique species:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Bioregions:  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Columns:  Bioregion, Species, rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bioregionalization 'K_4':</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Metrics:  100  rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Unique species:  25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Bioregions:  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Columns:  Bioregion, Species, rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Access individual results with:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   your_object$bioregionalization_name$metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   your_object[[1]]$metrics  # First bioregionalization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Or see the full list structure with str(your_object)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access individual bioregionalization by name</span></span></span>
<span class="r-in"><span><span class="va">metrics_multi</span><span class="op">$</span><span class="va">K_3</span><span class="op">$</span><span class="va">metrics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species        rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2  Species1 -0.4472136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2  Species3  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          2  Species4  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2  Species5  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          2  Species6  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          2  Species7 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          2  Species8  0.1677741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2 Species10  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2 Species11 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2 Species12  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2 Species13  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2 Species14  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2 Species15 -0.4472136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2 Species16  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         2 Species17  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         2 Species18  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         2 Species19  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         2 Species20  0.4727890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         2 Species21  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         2 Species22 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         2 Species23 -2.5166115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         2 Species24 -0.5033223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         2 Species25  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         3  Species1  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         3  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         3  Species3  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         3  Species4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         3  Species5  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         3  Species6  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         3  Species7  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         3  Species8  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         3  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         3 Species10  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         3 Species11  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         3 Species12 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         3 Species13 -1.2995726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         3 Species14  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         3 Species15  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         3 Species16  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         3 Species17  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         3 Species18  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         3 Species19  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         3 Species20  0.4727890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         3 Species21 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         3 Species22  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         3 Species23  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         3 Species24  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         3 Species25 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         1  Species1  0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         1  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         1  Species3 -1.7795130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         1  Species4 -0.6892024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         1  Species5 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         1  Species6 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         1  Species7  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         1  Species8 -1.0677078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         1  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         1 Species10 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         1 Species11  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         1 Species12  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         1 Species13  1.3784049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         1 Species14 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         1 Species15  0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         1 Species16 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         1 Species17 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         1 Species18 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         1 Species19 -1.3784049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         1 Species20 -1.0029369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         1 Species21  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         1 Species22  0.6892024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         1 Species23  1.7795130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         1 Species24 -0.3559026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         1 Species25  0.0000000</span>
<span class="r-in"><span><span class="co"># Or by index</span></span></span>
<span class="r-in"><span><span class="va">metrics_multi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metrics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species        rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2  Species1 -0.4472136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2  Species3  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          2  Species4  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2  Species5  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          2  Species6  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          2  Species7 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          2  Species8  0.1677741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2 Species10  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2 Species11 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2 Species12  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2 Species13  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2 Species14  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2 Species15 -0.4472136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2 Species16  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         2 Species17  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         2 Species18  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         2 Species19  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         2 Species20  0.4727890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         2 Species21  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         2 Species22 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         2 Species23 -2.5166115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         2 Species24 -0.5033223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         2 Species25  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         3  Species1  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         3  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         3  Species3  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         3  Species4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         3  Species5  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         3  Species6  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         3  Species7  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         3  Species8  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         3  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         3 Species10  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         3 Species11  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         3 Species12 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         3 Species13 -1.2995726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         3 Species14  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         3 Species15  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         3 Species16  0.1490712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         3 Species17  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         3 Species18  0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         3 Species19  0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         3 Species20  0.4727890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         3 Species21 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         3 Species22  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         3 Species23  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         3 Species24  0.8388705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         3 Species25 -0.3063122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         1  Species1  0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         1  Species2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         1  Species3 -1.7795130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         1  Species4 -0.6892024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         1  Species5 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         1  Species6 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         1  Species7  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         1  Species8 -1.0677078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         1  Species9  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         1 Species10 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         1 Species11  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         1 Species12  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         1 Species13  1.3784049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         1 Species14 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         1 Species15  0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         1 Species16 -0.3162278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         1 Species17 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         1 Species18 -0.6497863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         1 Species19 -1.3784049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         1 Species20 -1.0029369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         1 Species21  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         1 Species22  0.6892024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         1 Species23  1.7795130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         1 Species24 -0.3559026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         1 Species25  0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See structure</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">metrics_multi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2 bioregionalization(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Class: bioregion.site.species.metrics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Indices: rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of bioregionalizations: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ K_3:List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ name   : chr "K_3"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ metrics:'data.frame':	75 obs. of  3 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ indices: chr "rho"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ args   :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ K_4:List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ name   : chr "K_4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ metrics:'data.frame':	100 obs. of  3 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ indices: chr "rho"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ args   :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "bioregion.site.species.metrics" "list"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "indices")= chr "rho"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "n_bioregionalizations")= int 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices (bipartite only)</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">metrics_cz</span> <span class="op">&lt;-</span> <span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust_bip</span>, </span></span>
<span class="r-in"><span>                                   comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>                                   net <span class="op">=</span> <span class="va">net_bip</span>, </span></span>
<span class="r-in"><span>                                   indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">metrics_cz</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cz_metrics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         4     site 0.8140496        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         2     site 0.8015123  1.2613124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         5     site 0.7922438  0.5400617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         3     site 0.8016529 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         6     site 0.8223140  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         5     site 0.7981859  0.5400617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         1     site 0.8055556  1.5021914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         2     site 0.8052930  1.2613124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         3     site 0.7981859  1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         4     site 0.7933884        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         2     site 0.8015123  1.2613124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         4     site 0.7768595        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         6     site 0.7777778 -1.4142136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         5     site 0.8057851  0.5400617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         6     site 0.8140496  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         2     site 0.8016529  1.2613124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         1     site 0.8016529 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         5     site 0.8055556 -1.6201852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         1     site 0.7981859  1.5021914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         3     site 0.7851240  1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species1         1  species 0.8310249 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species2         2  species 0.8300000 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species3         6  species 0.8177778  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species4         3  species 0.8281250 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species5         5  species 0.8209877  0.5400617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species6         2  species 0.8271605 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species7         2  species 0.8148148 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  Species8         1  species 0.8088889 -1.0729938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  Species9         2  species 0.8300000 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species10         1  species 0.8254848 -1.0729938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species11         3  species 0.8209877 -1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species12         5  species 0.8271605  0.5400617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species13         5  species 0.8281250 -1.6201852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species14         6  species 0.8148148  1.4142136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species15         2  species 0.8254848 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species16         3  species 0.8310249 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species17         4  species 0.8209877        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species18         2  species 0.8271605 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species19         4  species 0.8203125        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species20         4  species 0.8166090        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species21         3  species 0.8271605 -0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 Species25         1  species 0.8271605 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 Species23         1  species 0.8088889 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species24         2  species 0.8088889 -0.7207500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species22         5  species 0.8203125  0.5400617</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

