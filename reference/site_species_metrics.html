<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">bioregionalization</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bioregionalization">bioregionalization<a class="anchor" aria-label="anchor" href="#arg-bioregionalization"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species         rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1 1515.511843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  364.794029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  171.937257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  714.327872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  453.213412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  450.241223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7  660.588567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  834.441913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  285.287785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10 1110.387912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11 1791.976471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12 1155.609692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13 1107.664249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14  482.090909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15  840.849114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16  773.914158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17  314.177135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18  614.034174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  712.064360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  816.170805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21 1043.316688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22  791.513661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23  673.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24 1133.842077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  739.426209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1  174.724740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  741.049144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3  652.263823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4   86.970784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5  754.613568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6  100.418459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7  775.715529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8  482.091959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  427.633703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10  791.389856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11  416.199603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12  393.430261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13    5.153062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14  718.691955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15 1067.828448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16  331.114167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17  113.386253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18  197.239056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19  884.092160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20  575.291145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21   51.729780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22  258.895528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23  493.572183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24  467.249282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25   63.405401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         3  Species1  974.991715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         3  Species2  466.957908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         3  Species3  165.633736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         3  Species4   59.224257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         3  Species5  324.490831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         3  Species6  438.671957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         3  Species7    7.045180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         3  Species8  896.250294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         3  Species9  287.397031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         3 Species10   -2.431278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         3 Species11  809.583130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         3 Species12  100.776712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         3 Species13 1036.254154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         3 Species14 1207.029494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         3 Species15  477.044072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         3 Species16  563.920750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         3 Species17  115.202913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         3 Species18  775.846703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         3 Species19  182.023754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         3 Species20  129.307472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         3 Species21   77.379795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         3 Species22  695.157385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         3 Species23  518.916842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         3 Species24 1371.049071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         3 Species25   23.259566</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity     fidelity       indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1 20350.0617580 228.10526 240.77777778 5.492268e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2 12189.1129075 133.10526 148.76470588 1.980137e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  4151.4822937  45.89474  51.29411765 2.354130e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  6112.8587148  63.05263  79.86666667 5.035804e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5 11825.3094699 129.15789 144.35294118 1.864432e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  7299.9735616  72.57895  98.50000000 7.149026e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7 11152.9595574 125.42105 132.38888889 1.660435e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8 16928.2590207 184.52632 206.23529412 3.805584e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  6582.7806941  67.84211  85.93333333 5.829898e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10 13634.0649949 134.94737 183.14285714 2.471465e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11 21071.3106748 236.15789 249.27777778 5.886892e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12 12279.6163621 138.00000 145.66666667 2.010200e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13 16399.6918738 184.00000 194.22222222 3.573689e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14 15076.9726142 173.89474 173.89473684 3.023938e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15 18441.6813209 200.94737 224.58823529 4.513041e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16 11369.8056370 127.84211 134.94444444 1.725158e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17  4136.9301562  45.73684  51.11764706 2.337960e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18 12174.5607699 132.94737 148.58823529 1.975441e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19 10219.7236322 111.73684 124.88235294 1.395396e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20 11614.0000000 123.05263 146.12500000 1.798107e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21  8905.1805445  97.47368 108.94117647 1.061890e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22 12761.4969825 139.31579 155.70588235 2.169229e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23 12346.9253812 142.57895 142.57894737 2.032876e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24 22814.0000000 240.94737 286.12500000 6.894107e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  6279.2615277  57.84211  91.58333333 5.297373e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1     0.1081476   1.00000   0.05555556 5.555556e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2    -0.9459053   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3   815.8711445 734.00000  43.17647059 3.169153e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4    99.8107859  85.00000   5.66666667 4.816667e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5     9.0695626   9.00000   0.52941176 4.764706e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6    62.9080962  52.00000   3.71428571 1.931429e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7     1.1896238   2.00000   0.11111111 2.222222e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8    17.9722008  17.00000   1.00000000 1.700000e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9   264.4837739 224.00000  14.93333333 3.345067e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10   224.7768819 184.00000  13.14285714 2.418286e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11   458.6540313 425.00000  23.61111111 1.003472e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12    77.9744298  73.00000   4.05555556 2.960556e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13     0.1081476   1.00000   0.05555556 5.555556e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14   806.3684211 767.00000  40.36842105 3.096258e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15    -0.9459053   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16   328.8768944 305.00000  16.94444444 5.168056e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17     4.6182435   5.00000   0.29411765 1.470588e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18    -0.9459053   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19   809.1941659 728.00000  42.82352941 3.117553e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20    19.7297531  18.00000   1.12500000 2.025000e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21    -0.9459053   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22   141.4963050 128.00000   7.52941176 9.637647e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23   143.2105263 137.00000   7.21052632 9.878421e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24    -0.9176629   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25    -0.7947194   0.00000   0.00000000 0.000000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>net <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         1     site 0.8204159  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         3     site 0.8254848  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         1     site 0.8223140  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         1     site 0.8254848 -0.8581163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         4     site 0.8223140 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         6     site 0.8264463  0.6437963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         6     site 0.8140496  0.6437963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         6     site 0.8027211  1.5021914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         1     site 0.8223140  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         2     site 0.8204159  1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         2     site 0.8181818  1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         5     site 0.8204159  1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         3     site 0.8117914  1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         2     site 0.8223140  0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         5     site 0.8100000  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         4     site 0.8033241 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         4     site 0.8150000 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         5     site 0.7977839  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         3     site 0.8235294  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         1     site 0.8200000 -0.8581163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species1         6  species 0.8333333 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species2         2  species 0.8096886 -1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species3         3  species 0.8096886 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species4         2  species 0.8266667 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species5         5  species 0.8096886  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species6         6  species 0.8061224 -1.9313889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species7         3  species 0.8271605  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  Species8         6  species 0.8027682 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  Species9         5  species 0.8000000  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species11         2  species 0.8086420 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species12         6  species 0.8271605 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species13         1  species 0.8148148  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species14         1  species 0.8199446  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species15         3  species 0.8096886 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species16         1  species 0.8148148  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species18         6  species 0.8235294 -0.2145988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species19         3  species 0.8027682  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species20         4  species 0.7890625  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species21         2  species 0.8166090 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species22         5  species 0.8096886 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species23         4  species 0.8199446  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 Species24         1  species 0.7968750  0.5720776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 Species25         1  species 0.8194444 -2.2883102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species10         5  species 0.8163265 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species17         2  species 0.8304498 -0.4677072</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

