<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">bioregionalization</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bioregionalization">bioregionalization<a class="anchor" aria-label="anchor" href="#arg-bioregionalization"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species          rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2  Species1  691.3133454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2  Species2 1096.2512131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2  Species3  412.6304623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          2  Species4  710.4705820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2  Species5 1963.8050546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          2  Species6 1101.5075599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          2  Species7  367.9637192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          2  Species8  723.8416417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2  Species9 1069.7368973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2 Species10  662.1893978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2 Species11  316.5853082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2 Species12  942.3847907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2 Species13  742.1085669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2 Species14  675.9023104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2 Species15  527.5710984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2 Species16  227.0991279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         2 Species17 1202.4261351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         2 Species18  925.0473763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         2 Species19  307.7180046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         2 Species20  177.3817961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         2 Species21  436.1779924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         2 Species22  608.1278588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         2 Species23 1947.3126985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         2 Species24  512.1929169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         2 Species25  560.4276251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         1  Species1  183.3278484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         1  Species2 1051.4573220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         1  Species3 1009.6815711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         1  Species4  536.3843150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         1  Species5 1194.3072004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         1  Species6  488.4302527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         1  Species7 1242.3913858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         1  Species8 1506.1928495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         1  Species9  676.9823831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         1 Species10 1606.9214943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         1 Species11  440.2892832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         1 Species12  269.4781531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         1 Species13  437.9754559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         1 Species14  913.8824323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         1 Species15  642.3366718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         1 Species16  595.4568834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         1 Species17  353.3680884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         1 Species18 1938.7264570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         1 Species19 1343.5323467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         1 Species20   87.6778193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         1 Species21   96.5192801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         1 Species22 1145.6882108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         1 Species23 1142.0084391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         1 Species24  517.8497341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         1 Species25  293.9785706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         3  Species1    0.3424674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         3  Species2   11.8636804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         3  Species3  190.4118992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         3  Species4  201.4804211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         3  Species5  341.6085246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         3  Species6  112.3809319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         3  Species7    9.0406793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         3  Species8  639.6173673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         3  Species9  212.0535988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         3 Species10  575.6975420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         3 Species11   64.2058096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         3 Species12   30.3083688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         3 Species13  579.1204538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         3 Species14   14.0411652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         3 Species15   -1.3698698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         3 Species16  166.6414981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         3 Species17  864.9095668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         3 Species18  278.5972662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         3 Species19   94.1723204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         3 Species20  257.7436212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         3 Species21   90.2468787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         3 Species22   78.3261041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         3 Species23  115.0690614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         3 Species24  251.0920600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         3 Species25   -1.2813958</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity     fidelity       indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1  6.704000e+03  71.36842  84.75000000 6.048474e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  1.571016e+04 181.15789 181.15789474 3.281818e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  8.989000e+03  95.42105 113.31250000 1.081240e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  1.006091e+04  92.31579 146.16666667 1.349349e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  2.572407e+04 288.10526 304.11111111 8.761601e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  1.278090e+04 139.52632 155.94117647 2.175790e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7  1.178936e+04 132.52632 139.88888889 1.853896e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  2.028930e+04 233.68421 233.68421053 5.460831e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  1.231523e+04 134.47368 150.29411765 2.021060e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10  1.613099e+04 181.00000 191.05555556 3.458106e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11  5.466025e+03  60.15789  67.23529412 4.044734e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12  9.469000e+03 100.47368 119.31250000 1.198777e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13  1.217257e+04 140.57895 140.57894737 1.976244e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14  8.834000e+03  93.78947 111.37500000 1.044580e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15  7.939000e+03  84.36842 100.18750000 8.452661e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16  7.061187e+03  81.94737  81.94736842 6.715371e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17  1.698162e+04 185.10526 206.88235294 3.829501e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18  2.289900e+04 241.84211 287.18750000 6.945403e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  1.269693e+04 130.15789 164.86666667 2.145870e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  3.103972e+03  31.26316  42.42857143 1.326451e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21  4.627361e+03  46.26316  62.78571429 2.904665e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22  1.313500e+04 143.36842 160.23529412 2.297268e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23  2.412400e+04 254.73684 302.50000000 7.705789e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24  9.011896e+03  98.63158 110.23529412 1.087268e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  6.460773e+03  64.31579  87.28571429 5.613850e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1  2.523573e+00   3.00000   0.18750000 5.625000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  1.200526e+02 115.00000   6.05263158 6.960526e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3  6.104753e+02 533.00000  33.31250000 1.775556e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4  1.237113e+02  94.00000   7.83333333 7.363333e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5  5.201900e+01  49.00000   2.72222222 1.333889e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6 -9.459053e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7  3.255243e+01  31.00000   1.72222222 5.338889e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8  2.157895e+00   3.00000   0.15789474 4.736842e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  4.964890e+02 447.00000  26.29411765 1.175347e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10  9.280147e+02 859.00000  47.72222222 4.099339e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11  1.303680e+02 118.00000   6.94117647 8.190588e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12  2.294157e-01   1.00000   0.06250000 6.250000e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13  3.794737e+01  37.00000   1.94736842 7.205263e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14  7.205948e+02 629.00000  39.31250000 2.472756e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15  1.883503e+02 165.00000  10.31250000 1.701562e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16  5.263158e-02   1.00000   0.05263158 5.263158e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17 -9.459053e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18 -9.176629e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19 -8.885233e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20  9.601762e+01  79.00000   5.64285714 4.457857e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21 -8.583951e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22  8.474199e+01  77.00000   4.52941176 3.487647e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23 -9.176629e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24  4.579294e+01  42.00000   2.47058824 1.037647e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25  6.499277e+00   6.00000   0.42857143 2.571429e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>net <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         7     site 0.8368056 -0.5773503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         5     site 0.8088643  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         3     site 0.8299320  1.0223973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         2     site 0.8144044  0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         1     site 0.8299320        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         1     site 0.8199446        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         7     site 0.8209877 -0.5773503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         5     site 0.8365651  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         4     site 0.8350000 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         4     site 0.8347107 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         2     site 0.8209877  1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         4     site 0.8250000 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         4     site 0.8166090 -1.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         3     site 0.8279773  1.7380754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         6     site 0.8347107  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         6     site 0.8355388  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         5     site 0.8388430  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         4     site 0.8253968 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         6     site 0.8355388  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         2     site 0.8347107  1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species1         6  species 0.8437500 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species2         5  species 0.8310249 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species3         5  species 0.8046875 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species4         2  species 0.8055556 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species5         2  species 0.8395062 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species6         6  species 0.8373702 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species7         4  species 0.8271605  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  Species8         4  species 0.8365651  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  Species9         3  species 0.8166090 -1.1246370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species10         5  species 0.8209877 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species11         2  species 0.8512111 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species12         5  species 0.8281250 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species13         2  species 0.8365651 -0.4677072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species15         1  species 0.8281250        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species16         3  species 0.8365651 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species17         7  species 0.8235294  1.1547005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species18         4  species 0.8203125  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species19         4  species 0.8355556 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species20         2  species 0.8469388 -1.4031215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species21         3  species 0.8571429 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species22         3  species 0.8442907 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 Species23         6  species 0.8203125 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 Species24         1  species 0.8442907        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species25         6  species 0.8265306 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species14         3  species 0.8046875 -0.4089589</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

