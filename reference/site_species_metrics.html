<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">cluster_object</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-object">cluster_object<a class="anchor" aria-label="anchor" href="#arg-cluster-object"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species          rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          3  Species1  706.5546173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          3  Species2  648.2651373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          3  Species3  365.2772919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          3  Species4  696.4503570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          3  Species5  793.5617688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          3  Species6  891.7795022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          3  Species7 1152.2304999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          3  Species8 1047.0133698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          3  Species9  241.2078538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         3 Species10  708.9451443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         3 Species11   83.8617155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         3 Species12  254.9128455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         3 Species13  921.2422848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         3 Species14 1578.0899848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         3 Species15  637.2210610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         3 Species16 1547.0317861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         3 Species17  921.9071266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         3 Species18 1307.0824353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         3 Species19  636.6579406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         3 Species20   87.9611285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         3 Species21  297.7702243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         3 Species22  421.7858856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         3 Species23 1041.8443515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         3 Species24  296.6507748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         3 Species25  124.3156824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1   78.1024455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  226.2421277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3  776.4616190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4   66.7874779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5  773.4768489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6  143.2485353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7  938.7183800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8   31.1718168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  448.1746391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10  626.1339682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11 1116.7575998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12  591.4085612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13   34.5110638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14  398.1902382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15  768.3436252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16  452.5979193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17  194.5789833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18  588.3348719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19 1135.2870670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20  584.0317069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21 1270.1013836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22   71.1701793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23 1238.9380286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24  944.2680946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25  549.6343294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         1  Species1  150.5044893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         1  Species2  446.9094918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         1  Species3  221.4320663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         1  Species4  241.0707135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         1  Species5  408.3141553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         1  Species6  206.4636099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         1  Species7  113.4431821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         1  Species8 1185.0393261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         1  Species9   79.9013362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         1 Species10   98.1478477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         1 Species11  420.4117294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         1 Species12  212.9126336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         1 Species13  763.3936075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         1 Species14 1046.8057126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         1 Species15  181.4196486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         1 Species16  613.1298394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         1 Species17  543.7041452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         1 Species18  182.0237541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         1 Species19  741.7292897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         1 Species20   14.9716508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         1 Species21  173.3106438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         1 Species22    0.1677741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         1 Species23  475.4105781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         1 Species24 1399.9281452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         1 Species25  224.8260562</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity    fidelity       indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1  7076.4619317  77.63158  86.7647059 6.735681e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2 10266.7190583 115.52632 121.9444444 1.408779e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3 10107.0272583 119.94737 113.9500000 1.366800e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  7434.0000000  79.05263  93.8750000 7.421066e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5 15103.3294416 169.52632 178.9444444 3.033579e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  7226.3662012  83.84211  83.8421053 7.029499e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7 13796.8328192 159.21053 159.2105263 2.534799e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8 17512.8843998 207.10526 196.7500000 4.074796e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  5834.6795315  64.15789  71.7058824 4.600498e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10 10693.3070189 109.73684 139.0000000 1.525342e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11 12699.0000000 134.47368 159.6875000 2.147377e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12  8293.9907694  90.84211 101.5294118 9.223146e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13 12351.5136959 142.63158 142.6315789 2.034377e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14 23474.0000000 247.89474 294.3750000 7.297401e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15 12333.1604371 142.42105 142.4210526 2.028376e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16 20248.0032557 233.21053 233.2105263 5.438715e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17 10596.7022229 119.21053 125.8333333 1.500066e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18 16224.9057081 176.89474 197.7058824 3.497313e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19 19626.9886041 200.78947 254.3333333 5.106746e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  5402.9661189  59.47368  66.4705882 3.953251e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21 13678.0861844 140.15789 177.5333333 2.488270e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22  2854.3887262  29.84211  37.8000000 1.128032e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23 21224.7572424 250.78947 238.2500000 5.975059e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24 20537.1891212 223.68421 250.0000000 5.592105e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  6354.0000000  67.68421  80.3750000 5.440118e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1    45.7929450  42.00000   2.4705882 1.037647e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2     1.1896238   2.00000   0.1111111 2.222222e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3   130.2992507 128.00000   6.4000000 8.192000e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4    85.1132373  75.00000   4.6875000 3.515625e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5    73.6485252  69.00000   3.8333333 2.645000e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6   559.0000000 532.00000  28.0000000 1.489600e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7   792.6842105 754.00000  39.6842105 2.992189e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8     1.0259784   2.00000   0.1000000 2.000000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9    44.6801152  41.00000   2.4117647 9.888235e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10   119.9506477 102.00000   6.8000000 6.936000e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11     0.2294157   1.00000   0.0625000 6.250000e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12    -0.9459053   0.00000   0.0000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13   222.1578947 212.00000  11.1578947 2.365474e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14     2.5235731   3.00000   0.1875000 5.625000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15    20.0526316  20.00000   1.0526316 2.105263e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16    20.0526316  20.00000   1.0526316 2.105263e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17   527.8685044 489.00000  27.1666667 1.328450e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18    -0.9459053   0.00000   0.0000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19    -0.8885233   0.00000   0.0000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20     1.2797542   2.00000   0.1176471 2.352941e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21    -0.8885233   0.00000   0.0000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22   227.7581435 193.00000  12.8666667 2.483267e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23    73.8704414  73.00000   3.6500000 2.664500e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24    -0.9459053   0.00000   0.0000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25   156.2321148 137.00000   8.5625000 1.173062e+03</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>net <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         5     site 0.7936508 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         3     site 0.7743056  1.0568458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         3     site 0.7922438 -1.4411534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         4     site 0.7750473  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         5     site 0.7755102 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         2     site 0.7685950  0.7046643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         2     site 0.7845805  1.5854946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         2     site 0.7750000  0.7046643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         1     site 0.7901701  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         4     site 0.7922438  1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         1     site 0.7826087  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         1     site 0.7777778  1.2076147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         3     site 0.7561983  1.0568458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         3     site 0.7674858  1.0568458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         3     site 0.7847222  1.0568458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         3     site 0.7600000  1.0568458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         5     site 0.7755102 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         4     site 0.7851240  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         5     site 0.7933884 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         2     site 0.7845805  0.7046643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species2         3  species 0.7901235 -1.4411534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species3         1  species 0.7850000 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species4         4  species 0.7890625  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species6         2  species 0.7756233 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species7         2  species 0.7922438 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species8         5  species 0.7850000  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species9         3  species 0.7820069 -1.4411534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 Species10         4  species 0.7466667 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Species11         1  species 0.7890625 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species12         1  species 0.7889273 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species13         4  species 0.7756233 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species14         5  species 0.7968750  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species15         3  species 0.7811634 -0.1921538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species16         3  species 0.7756233 -0.1921538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species17         2  species 0.7839506 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species18         2  species 0.7681661 -1.0569964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species19         3  species 0.7466667 -0.1921538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species21         1  species 0.7644444 -0.7245688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species22         2  species 0.7733333 -1.9378267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species23         4  species 0.7850000  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 Species24         5  species 0.7958478  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  Species1         2  species 0.7820069 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  Species5         3  species 0.7777778 -0.1921538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species20         3  species 0.7612457 -0.1921538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species25         1  species 0.7812500 -0.7245688</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

