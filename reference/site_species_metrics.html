<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate contribution metrics of sites and species — site_species_metrics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate contribution metrics of sites and species — site_species_metrics"><meta name="description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:description" content="This function calculates metrics to assess the contribution of a given
species or site to its bioregion."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate contribution metrics of sites and species</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/site_species_metrics.R" class="external-link"><code>R/site_species_metrics.R</code></a></small>
      <div class="d-none name"><code>site_species_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates metrics to assess the contribution of a given
species or site to its bioregion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">site_species_metrics</span><span class="op">(</span></span>
<span>  <span class="va">cluster_object</span>,</span>
<span>  <span class="va">comat</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,</span>
<span>  net <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-object">cluster_object<a class="anchor" aria-label="anchor" href="#arg-cluster-object"></a></dt>
<dd><p>A <code>bioregion.clusters</code> object.</p></dd>


<dt id="arg-comat">comat<a class="anchor" aria-label="anchor" href="#arg-comat"></a></dt>
<dd><p>A co-occurrence <code>matrix</code> with sites as rows and species as
columns.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>A <code>character</code> specifying the contribution metric to compute.
Available options are <code>rho</code>, <code>affinity</code>, <code>fidelity</code>, <code>indicator_value</code> and
<code>Cz</code>.</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p><code>NULL</code> by default. Required for <code>Cz</code> indices. A
<code>data.frame</code> where each row represents an interaction between two nodes
and an optional third column indicating the interaction's weight.</p></dd>


<dt id="arg-site-col">site_col<a class="anchor" aria-label="anchor" href="#arg-site-col"></a></dt>
<dd><p>A number indicating the position of the column containing
the sites in <code>net</code>. 1 by default.</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>A number indicating the position of the column
containing the species in <code>net</code>. 2 by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with columns <code>Bioregion</code>, <code>Species</code>, and the desired summary
statistics, or a list of <code>data.frame</code>s if <code>Cz</code> and other indices are
selected.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The \(\rho\) metric is derived from Lenormand et al. (2019) with the
following formula:</p>
<p>\(\rho_{ij} = \frac{n_{ij} - \frac{n_i n_j}{n}}{\sqrt{\left(\frac{n - n_j}{
n-1}\right) \left(1-\frac{n_j}{n}\right) \frac{n_i n_j}{n}}}\)</p>
<p>where \(n\) is the number of sites, \(n_i\) is the number of sites in
which species \(i\) is present, \(n_j\) is the number of sites in
bioregion \(j\), and \(n_{ij}\) is the number of occurrences of species
\(i\) in sites of bioregion \(j\).</p>
<p>Affinity \(A\), fidelity \(F\), and individual contributions
\(IndVal\) describe how species are linked to their bioregions. These
metrics are described in Bernardo-Madrid et al. (2019):</p><ul><li><p>Affinity of species to their region:
\(A_i = \frac{R_i}{Z}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its associated bioregion, and \(Z\) is the total
size (number of sites) of the bioregion. High affinity indicates that the
species occupies most sites in its bioregion.</p></li>
<li><p>Fidelity of species to their region:
\(F_i = \frac{R_i}{D_i}\), where \(R_i\) is the occurrence/range size
of species \(i\) in its bioregion, and \(D_i\) is its total range size.
High fidelity indicates that the species is not present in other regions.</p></li>
<li><p>Indicator Value of species:
\(IndVal = F_i \cdot A_i\).</p></li>
</ul><p><code>Cz</code> metrics are derived from Guimerà &amp; Amaral (2005):</p><ul><li><p>Participation coefficient:
\(C_i = 1 - \sum_{s=1}^{N_M}{\left(\frac{k_{is}}{k_i}\right)^2}\), where
\(k_{is}\) is the number of links of node \(i\) to nodes in bioregion
\(s\), and \(k_i\) is the total degree of node \(i\). A high value
means links are uniformly distributed; a low value means links are within
the node's bioregion.</p></li>
<li><p>Within-bioregion degree z-score:
\(z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}\), where
\(k_i\) is the number of links of node \(i\) to nodes in its bioregion
\(s_i\), \(\overline{k_{si}}\) is the average degree of nodes in
\(s_i\), and \(\sigma_{k_{si}}\) is the standard deviation of degrees
in \(s_i\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bernardo-Madrid R, Calatayud J, González‐Suárez M, Rosvall M, Lucas P,
Antonelli A &amp; Revilla E (2019) Human activity is altering the world’s
zoogeographical regions. <em>Ecology Letters</em> 22, 1297–1305.</p>
<p>Guimerà R &amp; Amaral LAN (2005) Functional cartography of complex metabolic
networks. <em>Nature</em> 433, 895–900.</p>
<p>Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque S (2019)
Biogeographical network analysis of plant species distribution in the
Mediterranean region. <em>Ecology and Evolution</em> 9, 237–250.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a5_3_summary_metrics.html</a>.</p>
<p>Associated functions:
<a href="bioregion_metrics.html">bioregion_metrics</a> <a href="bioregionalization_metrics.html">bioregionalization_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust1</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species         rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          2  Species1  273.693082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2  Species2  899.748523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          2  Species3  371.859306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          2  Species4 1365.500801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          2  Species5   -1.174174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          2  Species6   64.473189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          2  Species7  694.190225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          2  Species8  730.567543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          2  Species9  644.616165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         2 Species10   76.457053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         2 Species11   29.997506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         2 Species12  169.396488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         2 Species13  569.593065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         2 Species14  390.926899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         2 Species15  173.526353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         2 Species16  533.042279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         2 Species17  646.098176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         2 Species18  203.500027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         2 Species19  523.176834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         2 Species20  578.721112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         2 Species21  161.542489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         2 Species22   24.323280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         2 Species23  283.777904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         2 Species24  204.637832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         2 Species25  492.896334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         1  Species1  710.416933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         1  Species2  257.659360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         1  Species3  452.195405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         1  Species4  143.333278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         1  Species5  100.641349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         1  Species6  189.047062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         1  Species7   -1.412029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         1  Species8    1.079787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         1  Species9  147.029853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         1 Species10    1.775848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         1 Species11  319.693360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         1 Species12   94.191000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         1 Species13  612.828903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         1 Species14  135.214530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         1 Species15  109.941118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         1 Species16   50.208058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         1 Species17   -1.412029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         1 Species18  384.762174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         1 Species19  859.079585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         1 Species20  313.562574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         1 Species21   -1.452966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         1 Species22  879.220605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         1 Species23  157.566125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         1 Species24  279.332649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         1 Species25   60.701704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         3  Species1  803.244206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         3  Species2  705.280336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         3  Species3  893.612133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         3  Species4  594.908251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55         3  Species5 1727.032086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         3  Species6 1701.066175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57         3  Species7 2763.288247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58         3  Species8 1765.336668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59         3  Species9 1096.622882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60         3 Species10  812.051118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         3 Species11 1815.420605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62         3 Species12 1031.908767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         3 Species13 1233.944002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         3 Species14 1324.008505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         3 Species15 1200.578132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66         3 Species16 1378.529437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         3 Species17 1483.041497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         3 Species18 1676.220533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         3 Species19  717.548848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70         3 Species20 1288.645801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71         3 Species21 1424.500190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         3 Species22  527.648980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         3 Species23  556.987582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74         3 Species24 1592.144766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75         3 Species25  947.738988</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Contribution metrics</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">com</span>, comat <span class="op">=</span> <span class="va">comat</span>,</span></span>
<span class="r-in"><span>indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho"</span>, <span class="st">"affinity"</span>, <span class="st">"fidelity"</span>, <span class="st">"indicator_value"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Bioregion   Species           rho  affinity     fidelity       indval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1  Species1  1.139845e+04 124.52632 139.17647059 1.733113e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1  Species2  1.087012e+04 122.26316 129.05555556 1.577874e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1  Species3  9.215487e+03 103.78947 109.55555556 1.137071e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1  Species4  1.027192e+04 101.84211 138.21428571 1.407603e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1  Species5  1.156202e+04 106.00000 167.83333333 1.779033e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1  Species6  1.235504e+04 138.84211 146.55555556 2.034808e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1  Species7  2.038682e+04 222.05263 248.17647059 5.510824e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1  Species8  1.692341e+04 184.47368 206.17647059 3.803413e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1  Species9  1.286634e+04 152.42105 144.80000000 2.207057e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 Species10  5.727094e+03  64.84211  68.44444444 4.438082e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 Species11  1.364900e+04 144.47368 171.56250000 2.478627e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 Species12  8.434448e+03 100.26316  95.25000000 9.550066e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         1 Species13  1.590943e+04 178.52632 188.44444444 3.364229e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         1 Species14  1.228269e+04 141.84211 141.84210526 2.011918e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         1 Species15  8.979785e+03 101.15789 106.77777778 1.080142e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         1 Species16  1.323185e+04 148.63158 156.88888889 2.331864e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         1 Species17  1.433313e+04 156.36842 174.76470588 2.732768e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         1 Species18  1.450900e+04 153.52632 182.31250000 2.798977e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         1 Species19  1.369900e+04 145.00000 172.18750000 2.496719e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         1 Species20  1.458143e+04 168.21053 168.21052632 2.829478e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         1 Species21  1.021958e+04 115.00000 121.38888889 1.395972e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         1 Species22  8.620244e+03  85.57895 116.14285714 9.939383e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         1 Species23  5.925083e+03  67.05263  70.77777778 4.745836e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         1 Species24  1.194173e+04 130.42105 145.76470588 1.901079e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         1 Species25  1.021958e+04 115.00000 121.38888889 1.395972e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         2  Species1  2.392584e+00   3.00000   0.17647059 5.294118e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         2  Species2  5.040760e+02 467.00000  25.94444444 1.211606e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         2  Species3  4.662244e+02 432.00000  24.00000000 1.036800e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         2  Species4  1.167785e+03 953.00000  68.07142857 6.487207e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         2  Species5 -7.947194e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         2  Species6  1.633029e+01  16.00000   0.88888889 1.422222e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         2  Species7  6.044335e+02 544.00000  32.00000000 1.740800e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         2  Species8  1.240805e+01  12.00000   0.70588235 8.470588e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         2  Species9  8.207827e+00   9.00000   0.45000000 4.050000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         2 Species10  1.092291e+01  11.00000   0.61111111 6.722222e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         2 Species11 -9.176629e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         2 Species12  2.051957e+00   3.00000   0.15000000 4.500000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         2 Species13 -9.733285e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         2 Species14  5.263158e-02   1.00000   0.05263158 5.263158e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         2 Species15  1.515148e+02 141.00000   7.83333333 1.104500e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         2 Species16  4.434052e+00   5.00000   0.27777778 1.388889e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         2 Species17  3.911597e+01  36.00000   2.11764706 7.623529e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         2 Species18 -9.176629e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         2 Species19 -9.176629e-01   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         2 Species20 -1.000000e+00   0.00000   0.00000000 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         2 Species21  2.281915e+01  22.00000   1.22222222 2.688889e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47         2 Species22  1.385695e+01  12.00000   0.85714286 1.028571e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48         2 Species23  1.763888e+02 164.00000   9.11111111 1.494222e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49         2 Species24  3.262260e+02 294.00000  17.29411765 5.084471e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50         2 Species25  8.759957e+00   9.00000   0.50000000 4.500000e+00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cz indices</span></span></span>
<span class="r-in"><span><span class="va">net_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span>, weight <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">net_bip</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">site_species_metrics</span><span class="op">(</span>cluster_object <span class="op">=</span> <span class="va">clust_bip</span>, comat <span class="op">=</span> <span class="va">comat</span>, </span></span>
<span class="r-in"><span>net <span class="op">=</span> <span class="va">net_bip</span>, indices <span class="op">=</span> <span class="st">"Cz"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Node Bioregion Category         C          z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      Site1         3     site 0.8050000  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Site2         1     site 0.8208617  0.7046643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      Site3         2     site 0.8128544 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Site4         4     site 0.8199446  1.0223973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      Site5         6     site 0.8194444 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Site6         2     site 0.8052930  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Site7         1     site 0.8088643 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Site8         5     site 0.8128544 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Site9         2     site 0.8181818  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Site10         6     site 0.8229167 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Site11         1     site 0.8140496  1.5854946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Site12         5     site 0.8200000  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Site13         1     site 0.8117914  1.5854946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Site14         5     site 0.8166352  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Site15         3     site 0.8128544  1.0954451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Site16         2     site 0.8125000 -1.2421180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Site17         5     site 0.8099174  1.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Site18         6     site 0.8181818 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Site19         4     site 0.8033241  1.7380754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    Site20         6     site 0.7958478 -0.8017837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  Species2         4  species 0.8209877 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  Species3         1  species 0.8209877 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  Species4         1  species 0.7959184 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  Species6         2  species 0.8086420  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  Species7         6  species 0.8096886  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  Species8         3  species 0.8235294 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  Species9         1  species 0.8200000 -0.1761661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 Species12         5  species 0.8200000 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Species13         1  species 0.8209877 -1.0569964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Species14         6  species 0.8199446  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Species15         3  species 0.8086420 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Species16         5  species 0.7901235 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 Species17         1  species 0.8096886 -1.0569964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 Species18         5  species 0.7890625 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Species19         1  species 0.8125000 -1.0569964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 Species20         3  species 0.8199446 -0.7302967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 Species21         5  species 0.8086420 -0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 Species22         4  species 0.7959184 -1.1246370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 Species24         2  species 0.8166090  1.6561573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 Species25         4  species 0.8209877 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  Species1         4  species 0.8096886 -0.4089589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  Species5         2  species 0.7777778  0.2070197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 Species10         5  species 0.8086420 -1.8333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 Species11         6  species 0.8046875  1.0690450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 Species23         4  species 0.8086420 -0.4089589</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

