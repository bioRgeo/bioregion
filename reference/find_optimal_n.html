<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function aims at optimizing one or several criteria on a set of
ordered partitions. It is usually applied to find one (or several) optimal
number(s) of clusters on, for example, a hierarchical tree to cut, or a
range of partitions obtained from k-means or PAM. Users are advised to be
careful if applied in other cases (e.g., partitions which are not ordered in
an increasing or decreasing sequence, or partitions which are not related
to each other)."><title>Search for an optimal number of clusters in a list of partitions — find_optimal_n • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search for an optimal number of clusters in a list of partitions — find_optimal_n"><meta property="og:description" content="This function aims at optimizing one or several criteria on a set of
ordered partitions. It is usually applied to find one (or several) optimal
number(s) of clusters on, for example, a hierarchical tree to cut, or a
range of partitions obtained from k-means or PAM. Users are advised to be
careful if applied in other cases (e.g., partitions which are not ordered in
an increasing or decreasing sequence, or partitions which are not related
to each other)."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/bioregion.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a>
    <a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a>
    <a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a>
    <a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a>
    <a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a>
    <a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a>
    <a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a>
    <a class="dropdown-item" href="../articles/a5_visualization.html">5. Visualization</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Search for an optimal number of clusters in a list of partitions</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/HEAD/R/find_optimal_n.R" class="external-link"><code>R/find_optimal_n.R</code></a></small>
      <div class="d-none name"><code>find_optimal_n.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function aims at optimizing one or several criteria on a set of
ordered partitions. It is usually applied to find one (or several) optimal
number(s) of clusters on, for example, a hierarchical tree to cut, or a
range of partitions obtained from k-means or PAM. Users are advised to be
careful if applied in other cases (e.g., partitions which are not ordered in
an increasing or decreasing sequence, or partitions which are not related
to each other).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_optimal_n</span><span class="op">(</span></span>
<span>  <span class="va">partitions</span>,</span>
<span>  metrics_to_use <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"elbow"</span>,</span>
<span>  step_quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  step_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  step_round_above <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  metric_cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="fl">0.999</span><span class="op">)</span>,</span>
<span>  n_breakpoints <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>partitions</dt>
<dd><p>a <code>bioregion.partition.metrics</code> object (output from
<code><a href="partition_metrics.html">partition_metrics()</a></code> or a <code>data.frame</code> with the first two
columns named "K" (partition name) and "n_clusters" (number of clusters) and
the following columns containing evaluation metrics (numeric values)</p></dd>


<dt>metrics_to_use</dt>
<dd><p>character string or vector of character strings
indicating upon which metric(s) in <code>partitions</code> the optimal number of
clusters should be calculated. Defaults to <code>"all"</code> which means all
metrics available in <code>partitions</code> will be used</p></dd>


<dt>criterion</dt>
<dd><p>character string indicating the criterion to be used to
identify optimal number(s) of clusters. Available methods currently include
<code>"elbow"</code>,
<code>"increasing_step"</code>, <code>"decreasing_step"</code>, <code>"cutoff"</code>,
<code>"breakpoints"</code>, <code>"min"</code> or
<code>"max"</code>. Default is <code>"elbow"</code>. See details.</p></dd>


<dt>step_quantile</dt>
<dd><p>if <code>"increasing_step"</code> or <code>"decreasing_step"</code>,
specify here the quantile
of differences between two consecutive k to be used as the cutoff to
identify the most important steps in <code>eval_metric</code></p></dd>


<dt>step_levels</dt>
<dd><p>if <code>"increasing_step"</code> or <code>"decreasing_step"</code>, specify
here the number of largest steps to keep as cutoffs.</p></dd>


<dt>step_round_above</dt>
<dd><p>a <code>boolean</code> indicating if the optimal number of
clusters should be picked above or below the identified steps. Indeed, each
step will correspond to a sudden increase or decrease between partition X &amp;
partition X+1: should the optimal partition be X+1
(<code>step_round_above = TRUE</code>) or X (<code>step_round_above = FALSE</code>?
Defaults to <code>TRUE</code></p></dd>


<dt>metric_cutoffs</dt>
<dd><p>if <code>criterion = "cutoff"</code>, specify here the cutoffs
of <code>eval_metric</code> at which the number of clusters should be extracted</p></dd>


<dt>n_breakpoints</dt>
<dd><p>specify here the number of breakpoints to look for in
the curve. Defaults to 1</p></dd>


<dt>plot</dt>
<dd><p>a boolean indicating if a plot of the first <code>eval_metric</code>
should be drawn with the identified optimal numbers of cutoffs</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>list</code> of class <code>bioregion.optimal.n</code> with three elements:</p><ul><li><p><code>args</code>: input arguments</p></li>
<li><p><code>evaluation_df</code>: the input evaluation data.frame appended with
<code>boolean</code> columns identifying the optimal numbers of clusters</p></li>
<li><p><code>optimal_nb_clusters</code>: a list containing the optimal number(s)
of cluster(s) for each metric specified in <code>"metrics_to_use"</code>, based on
the chosen <code>criterion</code></p></li>
<li><p><code>plot</code>: if requested, the plot will be stored in this slot</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
<p>This function explores the relationship evaluation metric ~ number of
clusters, and a criterion is applied to search an optimal number of
clusters.</p>
<p><strong>Please read the note section about the following criteria.</strong></p>
<p>Foreword:</p>
<p>Here we implemented a set of criteria commonly found in the literature or
recommended in the bioregionalisation literature. Nevertheless, we also
advocate to move
beyond the "Search one optimal number of clusters" paradigm, and consider
investigating "multiple optimal numbers of clusters". Indeed, using only one
optimal number of clusters may simplify the natural complexity of biological
datasets, and, for example, ignore the often hierarchical / nested nature of
bioregionalisations. Using multiple partitions likely avoids this
oversimplification bias and may convey more information.
See, for example, the reanalysis of Holt et al. (2013)
by (Ficetola et al. 2017)
, where they used deep, intermediate
and shallow cuts.</p>
<p>Following this rationale, several of the criteria implemented here can/will
return multiple "optimal" numbers of clusters, depending on user choices.</p>
<p><strong>Criteria to find optimal number(s) of clusters</strong></p><ul><li><p><code>elbow</code>:
This method consists in finding one elbow in the evaluation metric curve, as
is commonly done in clustering analyses. The idea is to approximate the
number of clusters at which the evaluation metric no longer increments.It is
based on a fast method finding the maximum distance between the curve and a
straight line linking the minimum and maximum number of points. The code we
use here is based on code written by Esben Eickhardt available here
<a href="https://stackoverflow.com/questions/2018178/finding-the-best-trade-off-point-on-a-curve/42810075#42810075" class="external-link">https://stackoverflow.com/questions/2018178/finding-the-best-trade-off-point-on-a-curve/42810075#42810075</a>.
The code has been modified to work on both increasing and decreasing
evaluation metrics.</p></li>
<li><p><code>increasing_step</code> or <code>decreasing_step</code>:
This method consists in identifying clusters at the most important changes,
or steps, in the evaluation metric. The objective can be to either look for
largest increases (<code>increasing_step</code>) or largest decreases
<code>decreasing_step</code>. Steps are calculated based on the pairwise differences
between partitions. Therefore, this is relative to the distribution of
differences in the evaluation metric over the tested partitions. Specify
<code>step_quantile</code> as the quantile cutoff above which steps will be selected as
most important (by default, 0.99, i.e. the largest 1\<!-- % steps will be -->
selected).Alternatively, you can also choose to specify the number of top
steps to keep, e.g. to keep the largest three steps, specify
<code>step_level = 3</code>. Basically this method will emphasize the most important
changes in the evaluation metric as a first approximation of where important
cuts can be chosen.**Please note that you should choose between <code>increasing_step</code> and
<code>decreasing_step</code> depending on the nature of your evaluation metrics. For
example, for metrics that are monotonously decreasing (e.g., endemism
metrics <code>"avg_endemism" &amp; "tot_endemism"</code>) with the number of clusters
should n_clusters, you should choose <code>decreasing_step</code>. On the contrary, for
metrics that are monotonously increasing with the number of clusters (e.g.,
<code>"pc_distance"</code>), you should choose <code>increasing_step</code>. **</p></li>
<li><p><code>cutoffs</code>:
This method consists in specifying the cutoff value(s) in the evaluation
metric from which the number(s) of clusters should be derived. This is the
method used by (Holt et al. 2013)
. Note, however, that the
cut-offs suggested by Holt et al. (0.9, 0.95, 0.99, 0.999) may be only
relevant at very large spatial scales, and lower cut-offs should be
considered at finer spatial scales.</p></li>
<li><p><code>breakpoints</code>:
This method consists in finding break points in the curve using a segmented
regression. Users have to specify the number of expected break points in
<code>n_breakpoints</code> (defaults to 1). Note that since this method relies on a
regression model, it should probably not be applied with a low number of
partitions.</p></li>
<li><p><code>min</code> &amp; <code>max</code>:
Picks the optimal partition(s) respectively at the minimum or maximum value
of the evaluation metric.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Please note that finding the optimal number of clusters is a procedure
which normally requires decisions from the users, and as such can hardly be
fully automatized. Users are strongly advised to read the references
indicated below to look for guidance on how to choose their optimal
number(s) of clusters. Consider the "optimal" numbers of clusters returned
by this function as first approximation of the best numbers for your
bioregionalisation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Castro-Insua A, Gómez-Rodríguez C, Baselga A (2018).
“Dissimilarity measures affected by richness differences yield biased delimitations of biogeographic realms.”
<em>Nature Communications</em>, <b>9</b>(1), 9--11.</p>
<p>Ficetola GF, Mazel F, Thuiller W (2017).
“Global determinants of zoogeographical boundaries.”
<em>Nature Ecology &amp; Evolution</em>, <b>1</b>, 0089.</p>
<p>Holt BG, Lessard J, Borregaard MK, Fritz SA, Araújo MB, Dimitrov D, Fabre P, Graham CH, Graves GR, Jønsson Ka, Nogués-Bravo D, Wang Z, Whittaker RJ, Fjeldså J, Rahbek C (2013).
“An update of Wallace's zoogeographic regions of the world.”
<em>Science</em>, <b>339</b>(6115), 74--78.</p>
<p>Kreft H, Jetz W (2010).
“A framework for delineating biogeographical regions based on species distributions.”
<em>Journal of Biogeography</em>, <b>37</b>, 2029--2053.</p>
<p>Langfelder P, Zhang B, Horvath S (2008).
“Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R.”
<em>BIOINFORMATICS</em>, <b>24</b>(5), 719--720.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>),
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>) and
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">comnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="mat_to_net.html">mat_to_net</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User-defined number of clusters</span></span></span>
<span class="r-in"><span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu"><a href="hclu_hierarclust.html">hclu_hierarclust</a></span><span class="op">(</span><span class="va">dissim</span>,</span></span>
<span class="r-in"><span>                          n_clust <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">15</span>,</span></span>
<span class="r-in"><span>                          index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  -- range of cophenetic correlation coefficients among</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                      trials: 0.3 - 0.48</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimal tree has a 0.48 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-in"><span><span class="va">tree1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : hierarchical_clustering </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(hierarchical clustering based on a dissimilarity matrix)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Name of dissimilarity metric:  Simpson </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Tree construction method:  average </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Randomization of the dissimilarity matrix:  yes, number of trials 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Cophenetic correlation coefficient:  0.479 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters requested by the user:  2 3 4 5 6 7 8 9 10 11 ... (with 4 more values) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Partitions are hierarchical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  2 3 4 5 6 7 8 9 10 11 ... (with 4 more values) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Height of cut of the hierarchical tree: 0.133 0.125 0.109 0.094 0.078 0.07 0.062 0.055 0.051 0.049 ... (with 4 more values) </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="partition_metrics.html">partition_metrics</a></span><span class="op">(</span><span class="va">tree1</span>,</span></span>
<span class="r-in"><span>                   dissimilarity <span class="op">=</span> <span class="va">dissim</span>,</span></span>
<span class="r-in"><span>                   net <span class="op">=</span> <span class="va">comnet</span>,</span></span>
<span class="r-in"><span>                   species_col <span class="op">=</span> <span class="st">"Node2"</span>,</span></span>
<span class="r-in"><span>                   site_col <span class="op">=</span> <span class="st">"Node1"</span>,</span></span>
<span class="r-in"><span>                   eval_metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tot_endemism"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"avg_endemism"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"pc_distance"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"anosim"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing similarity-based metrics...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - pc_distance OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - anosim OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing composition-based metrics...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - avg_endemism OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   - tot_endemism OK</span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the elbow method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    * elbow found at:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tot_endemism 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> avg_endemism 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> pc_distance 7</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> anosim 10</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The elbow method is likely not suitable for the ANOSIM metric. You should rather look for leaps in the curve (see criterion = 'increasing_step' or decreasing_step)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  elbow </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 10</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"increasing_step"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the increasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'increasing_step' cannot work properly with metric 'tot_endemism', because this metric is usually monotonously decreasing. Consider using criterion = 'decreasing_step' instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  increasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.99  (i.e., only the top 1 %  increase  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 10</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"decreasing_step"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the decreasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'decreasing_step' cannot work properly with metrics 'pc_distance' or 'avg_endemism', because these metrics are usually monotonously decreasing. Consider using criterion = 'increasing_step' instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  decreasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.99  (i.e., only the top 1 %  decrease  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 12</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"decreasing_step"</span>,</span></span>
<span class="r-in"><span>               step_levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the decreasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'decreasing_step' cannot work properly with metrics 'pc_distance' or 'avg_endemism', because these metrics are usually monotonously decreasing. Consider using criterion = 'increasing_step' instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'tot_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'avg_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  decreasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.99  (i.e., only the top 1 %  decrease  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 11 12 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 11 12 14</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"decreasing_step"</span>,</span></span>
<span class="r-in"><span>               step_quantile <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the decreasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'decreasing_step' cannot work properly with metrics 'pc_distance' or 'avg_endemism', because these metrics are usually monotonously decreasing. Consider using criterion = 'increasing_step' instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  decreasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.9  (i.e., only the top 10 %  decrease  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 12 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 11 12</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"decreasing_step"</span>,</span></span>
<span class="r-in"><span>               step_levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the decreasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'decreasing_step' cannot work properly with metrics 'pc_distance' or 'avg_endemism', because these metrics are usually monotonously decreasing. Consider using criterion = 'increasing_step' instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'tot_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'avg_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  decreasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.99  (i.e., only the top 1 %  decrease  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 11 12 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 11 12 14</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"decreasing_step"</span>,</span></span>
<span class="r-in"><span>               step_levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>                 </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the decreasing_step method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Step method</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Criterion 'decreasing_step' cannot work properly with metrics 'pc_distance' or 'avg_endemism', because these metrics are usually monotonously decreasing. Consider using criterion = 'increasing_step' instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'tot_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of optimal N for method 'avg_endemism' is suspiciously high, consider switching between 'increasing_step' and 'decreasing_step'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-plt img"><img src="find_optimal_n-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  decreasing_step </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (step quantile chosen:  0.99  (i.e., only the top 1 %  decrease  in evaluation metrics  are used as break points for the number of clusters)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3 4 5 6 7 8 9 10 11 12 13 14 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 11 12 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 11 12 14</span>
<span class="r-in"><span><span class="fu">find_optimal_n</span><span class="op">(</span><span class="va">a</span>, criterion <span class="op">=</span> <span class="st">"breakpoints"</span><span class="op">)</span>             </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tot_endemism" "avg_endemism" "pc_distance"  "anosim"      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of partitions: 14</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Searching for potential optimal number(s) of clusters based on the breakpoints method</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting results...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    (the red line is the prediction from the segmented regression)</span>
<span class="r-plt img"><img src="find_optimal_n-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Search for an optimal number of clusters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 14  partition(s) evaluated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Range of clusters explored: from  2  to  15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Evaluated metric(s):  tot_endemism avg_endemism pc_distance anosim </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Potential optimal partition(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Criterion chosen to optimise the number of clusters:  breakpoints </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Optimal partition(s) of clusters for each metric:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tot_endemism - 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg_endemism - 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pc_distance - 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> anosim - 5</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

