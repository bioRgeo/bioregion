<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add color palettes to bioregion cluster objects — bioregion_colors • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add color palettes to bioregion cluster objects — bioregion_colors"><meta name="description" content="This function assigns colors to clusters in a bioregion.clusters object
using color palettes from the rcartocolor package. It
handles large numbers of clusters by assigning vivid colors to the most
important clusters (based on size), grey shades to less important clusters,
and optionally black to insignificant clusters."><meta property="og:description" content="This function assigns colors to clusters in a bioregion.clusters object
using color palettes from the rcartocolor package. It
handles large numbers of clusters by assigning vivid colors to the most
important clusters (based on size), grey shades to less important clusters,
and optionally black to insignificant clusters."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Add color palettes to bioregion cluster objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/bioregion_colors.R" class="external-link"><code>R/bioregion_colors.R</code></a></small>
      <div class="d-none name"><code>bioregion_colors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function assigns colors to clusters in a <code>bioregion.clusters</code> object
using color palettes from the <code>rcartocolor</code> package. It
handles large numbers of clusters by assigning vivid colors to the most
important clusters (based on size), grey shades to less important clusters,
and optionally black to insignificant clusters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bioregion_colors</span><span class="op">(</span></span>
<span>  <span class="va">clusters</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"Vivid"</span>,</span>
<span>  cluster_ordering <span class="op">=</span> <span class="st">"n_sites"</span>,</span>
<span>  cutoff_insignificant <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>An object of class <code>bioregion.clusters</code>, typically output
from clustering functions such as <code><a href="netclu_infomap.html">netclu_infomap()</a></code>, <code><a href="hclu_hierarclust.html">hclu_hierarclust()</a></code>,
or <code><a href="nhclu_pam.html">nhclu_pam()</a></code>.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>A <code>character</code> string indicating which color palette from
<code>rcartocolor</code> to use. Default is <code>"Vivid"</code>. Other qualitative palettes
include <code>"Bold"</code>, <code>"Prism"</code>, <code>"Safe"</code>, <code>"Antique"</code>, and <code>"Pastel"</code>.</p></dd>


<dt id="arg-cluster-ordering">cluster_ordering<a class="anchor" aria-label="anchor" href="#arg-cluster-ordering"></a></dt>
<dd><p>A <code>character</code> string indicating the criterion for
ranking clusters to determine color assignment priority. Options are:</p><ul><li><p><code>"n_sites"</code> (default): Rank by number of sites in each cluster</p></li>
<li><p><code>"n_species"</code>: Rank by number of species (bipartite networks only)</p></li>
<li><p><code>"n_both"</code>: Rank by combined sites + species (bipartite networks only)</p></li>
</ul><p>Larger clusters (by the chosen criterion) receive vivid colors first.</p></dd>


<dt id="arg-cutoff-insignificant">cutoff_insignificant<a class="anchor" aria-label="anchor" href="#arg-cutoff-insignificant"></a></dt>
<dd><p>A <code>numeric</code> value or <code>NULL</code> (default). When
specified, clusters with values at or below this threshold (based on the
<code>cluster_ordering</code> criterion) are considered insignificant and colored
black, reducing visual clutter on maps. If <code>NULL</code>, all clusters receive
distinct colors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A modified <code>bioregion.clusters</code> object with two additional elements:</p><ul><li><p><code>colors</code>: A <code>list</code> where each element corresponds to a partition
(bioregionalization). Each list element is a <code>data.frame</code> with two columns:</p><ul><li><p><code>cluster</code> (<code>character</code>): Cluster identifier for that partition</p></li>
<li><p><code>color</code> (<code>character</code>): Hex color code (e.g., "#FF5733")</p></li>
</ul></li>
<li><p><code>clusters_colors</code>: A <code>data.frame</code> with the same structure as the
<code>clusters</code> element, but with cluster IDs replaced by their corresponding
hex color codes for direct use in plotting functions.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses a two-step algorithm to assign colors:</p>
<p><strong>Step 1: Identify insignificant clusters</strong> (if <code>cutoff_insignificant</code> is specified)</p>
<p>Insignificant clusters are those with a marginal size compared to others.
This is a subjective threshold set by the user. All such clusters are assigned
the color black (#000000) to minimize their visual impact.
Clusters with values at or below the threshold are assigned black (#000000).</p>
<p><strong>Step 2: Assign colors to significant clusters</strong></p>
<p>Remaining clusters are ranked by the <code>cluster_ordering</code> criterion:</p><ul><li><p><strong>Top clusters</strong> (up to 12): Receive distinct colors from the chosen
palette. This limit is because above 12 the human eye struggles to
distinguish between colors.</p></li>
<li><p><strong>Remaining clusters</strong> (beyond top 12): Receive shades of grey from
light (#CCCCCC) to dark (#404040), maintaining visual distinction but
with less prominence.</p></li>
</ul><p><strong>Multiple partitions</strong>: If the cluster object contains multiple partitions
(e.g., from hierarchical clustering with different k values), colors are
assigned independently for each partition. Each partition gets its own color
scale optimized for the number of clusters in that partition.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The colored cluster object can be directly used with <code><a href="map_bioregions.html">map_bioregions()</a></code>,
which will automatically detect and apply the color scheme when present.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Color palettes from the <code>rcartocolor</code> package:
Nowosad J (2018). "CARTOColors: color palettes inspired by CARTO."
<a href="https://github.com/Nowosad/rcartocolor" class="external-link">https://github.com/Nowosad/rcartocolor</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="map_bioregions.html">map_bioregions()</a></code> for visualizing colored clusters on maps</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fishmat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fishsf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic example with few clusters</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity.html">similarity</a></span><span class="op">(</span><span class="va">fishmat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_colored</span> <span class="op">&lt;-</span> <span class="fu">bioregion_colors</span><span class="op">(</span><span class="va">clust</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">clust_colored</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : netclu_greedy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  338 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Color palette assigned:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    *  K_4 : 4 vivid colors </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Map with automatic colors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="map_bioregions.html">map_bioregions</a></span><span class="op">(</span><span class="va">clust_colored</span>, <span class="va">fishsf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with many clusters and cutoff</span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="similarity_to_dissimilarity.html">similarity_to_dissimilarity</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="hclu_hierarclust.html">hclu_hierarclust</a></span><span class="op">(</span><span class="va">dissim</span>,</span></span>
<span class="r-in"><span>                          optimal_tree_method <span class="op">=</span> <span class="st">"best"</span>,</span></span>
<span class="r-in"><span>                          n_clust <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_colored2</span> <span class="op">&lt;-</span> <span class="fu">bioregion_colors</span><span class="op">(</span><span class="va">clust</span>, </span></span>
<span class="r-in"><span>                                   cluster_ordering <span class="op">=</span> <span class="st">"n_sites"</span>,</span></span>
<span class="r-in"><span>                                   cutoff_insignificant <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="map_bioregions.html">map_bioregions</a></span><span class="op">(</span><span class="va">clust_colored2</span>, <span class="va">fishsf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with different palette</span></span></span>
<span class="r-in"><span><span class="va">clust_colored3</span> <span class="op">&lt;-</span> <span class="fu">bioregion_colors</span><span class="op">(</span><span class="va">clust</span>, palette <span class="op">=</span> <span class="st">"Bold"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="map_bioregions.html">map_bioregions</a></span><span class="op">(</span><span class="va">clust_colored3</span>, <span class="va">fishsf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with bipartite network</span></span></span>
<span class="r-in"><span><span class="va">clust_bip</span> <span class="op">&lt;-</span> <span class="fu"><a href="netclu_greedy.html">netclu_greedy</a></span><span class="op">(</span><span class="va">fishdf</span>, bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust_bip_colored</span> <span class="op">&lt;-</span> <span class="fu">bioregion_colors</span><span class="op">(</span><span class="va">clust_bip</span>, </span></span>
<span class="r-in"><span>                                      cluster_ordering <span class="op">=</span> <span class="st">"n_both"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="map_bioregions.html">map_bioregions</a></span><span class="op">(</span><span class="va">clust_bip_colored</span>, <span class="va">fishsf</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                      </span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

