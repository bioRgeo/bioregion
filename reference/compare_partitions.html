<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function aims at computing pairwise comparisons for several
partitions, usually on outputs from netclu_, hclu_ or nhclu_ functions.
It also provides the confusion matrix from pairwise comparisons, so that
the user can compute additional comparison metrics."><title>Compare cluster memberships among multiple partitions — compare_partitions • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare cluster memberships among multiple partitions — compare_partitions"><meta property="og:description" content="This function aims at computing pairwise comparisons for several
partitions, usually on outputs from netclu_, hclu_ or nhclu_ functions.
It also provides the confusion matrix from pairwise comparisons, so that
the user can compute additional comparison metrics."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/bioregion.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a>
    <a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a>
    <a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a>
    <a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a>
    <a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a>
    <a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a>
    <a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a>
    <a class="dropdown-item" href="../articles/a5_visualization.html">5. Visualization</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compare cluster memberships among multiple partitions</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/HEAD/R/compare_partitions.R" class="external-link"><code>R/compare_partitions.R</code></a></small>
      <div class="d-none name"><code>compare_partitions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function aims at computing pairwise comparisons for several
partitions, usually on outputs from <code>netclu_</code>, <code>hclu_</code> or <code>nhclu_</code> functions.
It also provides the confusion matrix from pairwise comparisons, so that
the user can compute additional comparison metrics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compare_partitions</span><span class="op">(</span></span>
<span>  <span class="va">cluster_object</span>,</span>
<span>  sample_comparisons <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rand"</span>, <span class="st">"jaccard"</span><span class="op">)</span>,</span>
<span>  cor_frequency <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  store_pairwise_membership <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  store_confusion_matrix <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>cluster_object</dt>
<dd><p>a <code>bioregion.clusters</code> object or a <code>data.frame</code> or a
list of <code>data.frame</code> containing multiple partitions. At least two partitions
are required. If a list of <code>data.frame</code> is provided, they should all have
the same number of rows (i.e., same items in the clustering for all
partitions).</p></dd>


<dt>sample_comparisons</dt>
<dd><p><code>NULL</code> or a positive integer. Reduce computation
time by sampling a number of pairwise comparisons in cluster membership
of items. Useful if the number of items clustered is high. Suggested
values 5000 or 10000.</p></dd>


<dt>indices</dt>
<dd><p><code>NULL</code> or <code>character</code>. Indices to compute for the pairwise
comparison of partitions. Current available metrics are <code>"rand"</code> and
<code>"jaccard"</code></p></dd>


<dt>cor_frequency</dt>
<dd><p>a boolean. If <code>TRUE</code>, then computes the correlation
between each partition and the total frequency of co-membership of items
across all partitions. Useful to identify which partition(s) is(are) most
representative of all the computed partitions.</p></dd>


<dt>store_pairwise_membership</dt>
<dd><p>a boolean. If <code>TRUE</code>, the pairwise
membership of items is stored in the output object.</p></dd>


<dt>store_confusion_matrix</dt>
<dd><p>a boolean. If <code>TRUE</code>, the confusion matrices
of pairwise partition comparisons are stored in the output object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>list</code> with 4 to 7 elements:</p><ul><li><p><code>args</code>: arguments provided by the user</p></li>
<li><p><code>inputs</code>: information on the input partitions, such as the number of items
being clustered</p></li>
<li><p>(facultative) <code>pairwise_membership</code>: only if
<code>store_pairwise_membership = TRUE</code>. This
element contains the pairwise memberships of all items for each
partition, in the form of a <code>boolean matrix</code> where <code>TRUE</code> means that
two items are in the same cluster, and <code>FALSE</code> means that two items
are not in the same cluster</p></li>
<li><p><code>freq_item_pw_membership</code>: A <code>numeric vector</code>
containing the number of times each pair of items are clustered
together. It corresponds to the sum of rows of the table in
<code>pairwise_membership</code></p></li>
<li><p>(facultative) <code>partition_freq_cor</code>:  only if <code>cor_frequency = TRUE</code>.
A <code>numeric vector</code>
indicating the correlation between individual partitions and the total
frequency of pairwise membership across all partitions. It corresponds to
the correlation between individual columns in <code>pairwise_membership</code> and
<code>freq_item_pw_membership</code></p></li>
<li><p>(facultative) <code>confusion_matrix</code>: only if <code>store_confusion_matrix = TRUE</code>.
A <code>list</code>
containing all confusion matrices between each pair of partitions.</p></li>
<li><p><code>partition_comparison</code>: a <code>data.frame</code> containing the results of the
comparison of partitions, where the first column indicates which partitions
are compared, and the next columns correspond to the requested <code>indices</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

This function proceeds in two main steps:</p><ol><li><p>The first step is done within each partition. It will compare all pairs of
items and document if they are clustered together (<code>TRUE</code>) or separately
(<code>FALSE</code>) in each partition. For example, if site 1 and site 2 are clustered
in the same cluster in partition 1, then the pairwise membership site1_site2
will be <code>TRUE</code>. The output of this first step is stored in the slot
<code>pairwise_membership</code> if <code>store_pairwise_membership = TRUE</code>.</p></li>
<li><p>The second step compares all pairs of partitions by analysing if their
pairwise memberships are similar or not. To do so, for each pair of
partitions, the function computes a confusion matrix with four elements:</p></li>
</ol><ul><li><p><em>a</em>: number of pairs of items grouped in partition 1 and in partition 2</p></li>
<li><p><em>b</em>: number of pairs of items grouped in partition 1 but not in partition
2</p></li>
<li><p><em>c</em>: number of pairs of items not grouped in partition 1 but grouped in
partition 2</p></li>
<li><p><em>d</em>: number of pairs of items not grouped in both partition 1 &amp; 2</p></li>
</ul><p>The confusion matrix is stored in <code>confusion_matrix</code> if
<code>store_confusion_matrix = TRUE</code>.</p>
<p>Based on the confusion matrices, we can compute a range of indices to
indicate the agreement among partitions. As of now, we have implemented:</p><ul><li><p><em>Rand index</em>
<em></em>\((a + d)/(a + b + c + d)\)
The Rand index measures agreement among partitions by accounting for both
the pairs of sites that are grouped, but also the pairs of sites that are
not grouped.</p></li>
<li><p><em>Jaccard index</em>
<em></em>\((a)/(a + b + c)\)
The Jaccard index measures agreement among partitions by only accounting
for pairs of sites that are grouped - it is</p></li>
</ul><p>These two metrics are complementary, because the Jaccard index will tell
if partitions are similar in their clustering structure, whereas the
Rand index will tell if partitions are similar not only in the pairs of
items clustered together, but also in terms of the pairs of sites that are
not clustered together. For example, take two partitions which
never group together the same pairs of sites. Their Jaccard index will be 0,
whereas the Rand index can be &gt; 0 due to the sites that are not grouped
together.</p>
<p>Additional indices can be manually computed by the users on the basis of the
list of confusion matrices.</p>
<p>In some cases, users may be interested in finding which of the partitions
is most representative of all partitions. To find it out, we can
compare the pairwise membership of each partition with the total frequency
of pairwise membership across all partitions. This correlation can be
requested with <code>cor_frequency = TRUE</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="partition_metrics.html">partition_metrics</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>),
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>) and
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A simple case with four partitions of four items</span></span></span>
<span class="r-in"><span><span class="va">partitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nr <span class="op">=</span> <span class="fl">4</span>, nc <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">partitions</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X1 X2 X3 X4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  2  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1  2  2  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2  1  3  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2  1  4  2</span>
<span class="r-in"><span><span class="fu">compare_partitions</span><span class="op">(</span><span class="va">partitions</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing pairwise membership comparisons for eachpartition...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Comparing memberships among partitions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing Rand index...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing Jaccard index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition comparison:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 4 partitions compared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 4 items in the clustering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Requested indices:  rand jaccard </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Metric summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           rand jaccard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min  0.5000000    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean 0.6388889    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max  1.0000000    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Item pairwise membership  stored in outputs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Confusion matrices of partition comparisons  stored in outputs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find out which partitions are most representative</span></span></span>
<span class="r-in"><span><span class="fu">compare_partitions</span><span class="op">(</span><span class="va">partitions</span>,</span></span>
<span class="r-in"><span>                   cor_frequency <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing pairwise membership comparisons for eachpartition...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Comparing memberships among partitions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing Rand index...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing Jaccard index...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2023-04-15 11:22:33 - Computing the correlation between each partition and the vector of frequency of pairwise membership...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Partition comparison:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 4 partitions compared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - 4 items in the clustering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Requested indices:  rand jaccard </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Metric summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           rand jaccard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min  0.5000000    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean 0.6388889    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max  1.0000000    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Correlation between each partition and the total frequency of item  pairwise membership computed:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    # Range:  0  -  0.883 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    # Partition(s) most representative (i.e., highest correlation): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  X1, X2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation =  0.883 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Item pairwise membership  stored in outputs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Confusion matrices of partition comparisons  stored in outputs</span>
<span class="r-in"><span>                                </span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

