<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>OPTICS hierarchical clustering algorithm — hclu_optics • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="OPTICS hierarchical clustering algorithm — hclu_optics"><meta name="description" content="This function performs semi-hierarchical clustering based on dissimilarity
using the OPTICS algorithm (Ordering Points To Identify the
Clustering Structure)."><meta property="og:description" content="This function performs semi-hierarchical clustering based on dissimilarity
using the OPTICS algorithm (Ordering Points To Identify the
Clustering Structure)."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>OPTICS hierarchical clustering algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/v1.2.0/R/hclu_optics.R" class="external-link"><code>R/hclu_optics.R</code></a></small>
      <div class="d-none name"><code>hclu_optics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs semi-hierarchical clustering based on dissimilarity
using the OPTICS algorithm (Ordering Points To Identify the
Clustering Structure).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hclu_optics</span><span class="op">(</span></span>
<span>  <span class="va">dissimilarity</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dissimilarity</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  minPts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xi <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  minimum <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_hierarchy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  algorithm_in_output <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dissimilarity">dissimilarity<a class="anchor" aria-label="anchor" href="#arg-dissimilarity"></a></dt>
<dd><p>The output object from <code><a href="dissimilarity.html">dissimilarity()</a></code> or
<code><a href="similarity_to_dissimilarity.html">similarity_to_dissimilarity()</a></code>, or a <code>dist</code> object.
If a <code>data.frame</code> is used, the first two columns represent pairs of
sites (or any pair of nodes), and the subsequent column(s) contain the
dissimilarity indices.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>The name or number of the dissimilarity column to use. By
default, the third column name of <code>dissimilarity</code> is used.</p></dd>


<dt id="arg-minpts">minPts<a class="anchor" aria-label="anchor" href="#arg-minpts"></a></dt>
<dd><p>A <code>numeric</code> value specifying the minPts argument of
<a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan</a>. minPts is the minimum number of points required
to form a dense region. By default, it is set to the natural logarithm
of the number of sites in <code>dissimilarity</code>.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>A <code>numeric</code> value specifying the eps argument of
<a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">optics</a>. It defines the upper limit of the size
of the epsilon neighborhood. Limiting the neighborhood size improves
performance and has no or very little impact on the ordering as long as it
is not set too low. If not specified (default behavior), the largest
minPts-distance in the dataset is used, which gives the same result as
infinity.</p></dd>


<dt id="arg-xi">xi<a class="anchor" aria-label="anchor" href="#arg-xi"></a></dt>
<dd><p>A <code>numeric</code> value specifying the steepness threshold to
identify clusters hierarchically using the Xi method
(see <a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">optics</a>).</p></dd>


<dt id="arg-minimum">minimum<a class="anchor" aria-label="anchor" href="#arg-minimum"></a></dt>
<dd><p>A <code>boolean</code> specifying whether the hierarchy should be pruned
from the output to only retain clusters at the "minimal" level, i.e.,
only leaf / non-overlapping clusters.
If <code>TRUE</code>, then the argument <code>show_hierarchy</code> should be set to <code>FALSE</code>.</p></dd>


<dt id="arg-show-hierarchy">show_hierarchy<a class="anchor" aria-label="anchor" href="#arg-show-hierarchy"></a></dt>
<dd><p>A <code>boolean</code> specifying whether the hierarchy of
clusters should be included in the output. By default, the hierarchy is not
visible in the clusters obtained from OPTICS; it can only be visualized by
plotting the OPTICS object. If <code>show_hierarchy = TRUE</code>,
the output cluster <code>data.frame</code> will contain additional columns
showing the hierarchy of clusters.</p></dd>


<dt id="arg-algorithm-in-output">algorithm_in_output<a class="anchor" aria-label="anchor" href="#arg-algorithm-in-output"></a></dt>
<dd><p>A <code>boolean</code> indicating whether the original output
of <a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan</a> should be returned in the output (<code>TRUE</code> by
default, see Value).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to <code>optics()</code>
(see <a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">optics</a>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of class <code>bioregion.clusters</code> with five slots:</p><ol><li><p><strong>name</strong>: A <code>character</code> string containing the name of the algorithm.</p></li>
<li><p><strong>args</strong>: A <code>list</code> of input arguments as provided by the user.</p></li>
<li><p><strong>inputs</strong>: A <code>list</code> describing the characteristics of the clustering process.</p></li>
<li><p><strong>algorithm</strong>: A <code>list</code> containing all objects associated with the
clustering procedure, such as the original cluster objects.</p></li>
<li><p><strong>clusters</strong>: A <code>data.frame</code> containing the clustering results.</p></li>
</ol><p>In the <code>algorithm</code> slot, if <code>algorithm_in_output = TRUE</code>, users can
find the output of <a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">optics</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The OPTICS (Ordering points to identify the clustering structure) is a
semi-hierarchical clustering algorithm which orders the points in the
dataset such that points which are closest become neighbors, and calculates
a reachability distance for each point. Then, clusters can be extracted in a
hierarchical manner from this reachability distance, by identifying clusters
depending on changes in the relative cluster density. The reachability plot
should be explored to understand the clusters and their hierarchical nature,
by running plot on the output of the function
if <code>algorithm_in_output = TRUE</code>: <code>plot(object$algorithm)</code>.
We recommend reading (Hahsler et al., 2019) to grasp the
algorithm, how it works, and what the clusters mean.</p>
<p>To extract the clusters, we use the
<a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">extractXi</a> function which is based on the
steepness of the reachability plot (see
<a href="https://rdrr.io/pkg/dbscan/man/optics.html" class="external-link">optics</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hahsler M, Piekenbrock M &amp; Doran D (2019) Dbscan: Fast density-based
clustering with R. <em>Journal of Statistical Software</em> 91, 1–30.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a4_1_hierarchical_clustering.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a4_1_hierarchical_clustering.html</a>.</p>
<p>Associated functions:
<a href="nhclu_dbscan.html">nhclu_dbscan</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">fishmat</span>, metric <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu">hclu_optics</span><span class="op">(</span><span class="va">dissim</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : hclu_optics </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  338 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  4 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize the optics plot (the hierarchy of clusters is illustrated at the</span></span></span>
<span class="r-in"><span><span class="co"># bottom)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clust1</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hclu_optics-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the hierarchy of clusters</span></span></span>
<span class="r-in"><span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="fu">hclu_optics</span><span class="op">(</span><span class="va">dissim</span>, index <span class="op">=</span> <span class="st">"Simpson"</span>, show_hierarchy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clust1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : hclu_optics </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  338 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Partitions are hierarchical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  2 4 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

