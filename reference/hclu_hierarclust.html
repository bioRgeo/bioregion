<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hierarchical clustering based on dissimilarity or beta-diversity — hclu_hierarclust • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical clustering based on dissimilarity or beta-diversity — hclu_hierarclust"><meta name="description" content="This function generates a hierarchical tree from a dissimilarity
(beta-diversity) data.frame, calculates the cophenetic correlation
coefficient, and can get clusters from the tree if requested by the user.
The function implements randomization of the dissimilarity matrix to
generate the tree, with two different methods to generate the final tree.
Typically, the dissimilarity data.frame is a
bioregion.pairwise.metric object obtained by running similarity
or similarity and then similarity_to_dissimilarity."><meta property="og:description" content="This function generates a hierarchical tree from a dissimilarity
(beta-diversity) data.frame, calculates the cophenetic correlation
coefficient, and can get clusters from the tree if requested by the user.
The function implements randomization of the dissimilarity matrix to
generate the tree, with two different methods to generate the final tree.
Typically, the dissimilarity data.frame is a
bioregion.pairwise.metric object obtained by running similarity
or similarity and then similarity_to_dissimilarity."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_partitions.html">5.2 Compare partitions</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_contribution.html">5.3 Contribution</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Hierarchical clustering based on dissimilarity or beta-diversity</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/hclu_hierarclust.R" class="external-link"><code>R/hclu_hierarclust.R</code></a></small>
      <div class="d-none name"><code>hclu_hierarclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a hierarchical tree from a dissimilarity
(beta-diversity) <code>data.frame</code>, calculates the cophenetic correlation
coefficient, and can get clusters from the tree if requested by the user.
The function implements randomization of the dissimilarity matrix to
generate the tree, with two different methods to generate the final tree.
Typically, the dissimilarity <code>data.frame</code> is a
<code>bioregion.pairwise.metric</code> object obtained by running <code>similarity</code>
or <code>similarity</code> and then <code>similarity_to_dissimilarity</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hclu_hierarclust</span><span class="op">(</span></span>
<span>  <span class="va">dissimilarity</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dissimilarity</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  randomize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_runs <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  keep_trials <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optimal_tree_method <span class="op">=</span> <span class="st">"best"</span>,</span>
<span>  n_clust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cut_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  find_h <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  h_max <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  h_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  consensus_p <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dissimilarity">dissimilarity<a class="anchor" aria-label="anchor" href="#arg-dissimilarity"></a></dt>
<dd><p>the output object from <code><a href="dissimilarity.html">dissimilarity()</a></code> or
<code><a href="similarity_to_dissimilarity.html">similarity_to_dissimilarity()</a></code>, or a <code>dist</code> object.
If a <code>data.frame</code> is used, the first two
columns represent pairs of sites (or any pair of nodes), and the next
column(s) are the dissimilarity indices.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>name or number of the dissimilarity column to use. By default,
the third column name of <code>dissimilarity</code> is used.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>name of the hierarchical classification method, as in
<a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a>. Should be one of "ward.D",
"ward.D2", "single", "complete", "average"
(= UPGMA), "mcquitty" (= WPGMA), "median" (= WPGMC) or
"centroid" (= UPGMC).</p></dd>


<dt id="arg-randomize">randomize<a class="anchor" aria-label="anchor" href="#arg-randomize"></a></dt>
<dd><p>a <code>boolean</code> indicating if the dissimilarity matrix should be
randomized, to account for the order of sites in the dissimilarity matrix.</p></dd>


<dt id="arg-n-runs">n_runs<a class="anchor" aria-label="anchor" href="#arg-n-runs"></a></dt>
<dd><p>number of trials to randomize the dissimilarity matrix.</p></dd>


<dt id="arg-keep-trials">keep_trials<a class="anchor" aria-label="anchor" href="#arg-keep-trials"></a></dt>
<dd><p>a <code>boolean</code> indicating if all random trial results.
should be stored in the output object (set to FALSE to save space if your
<code>dissimilarity</code> object is large).</p></dd>


<dt id="arg-optimal-tree-method">optimal_tree_method<a class="anchor" aria-label="anchor" href="#arg-optimal-tree-method"></a></dt>
<dd><p>a <code>character</code> indicating how the final tree
should be obtained from all trials. The only option currently is
"best", which means the tree with the best cophenetic correlation
coefficient will be chosen.</p></dd>


<dt id="arg-n-clust">n_clust<a class="anchor" aria-label="anchor" href="#arg-n-clust"></a></dt>
<dd><p>an <code>integer</code> or an <code>integer</code> vector indicating the number of
clusters to be obtained from the hierarchical tree, or the output from
<a href="partition_metrics.html">partition_metrics</a>. Should not be used at the same time as
<code>cut_height</code>.</p></dd>


<dt id="arg-cut-height">cut_height<a class="anchor" aria-label="anchor" href="#arg-cut-height"></a></dt>
<dd><p>a <code>numeric</code> vector indicating the height(s) at which the
tree should be cut. Should not be used at the same time as <code>n_clust</code>.</p></dd>


<dt id="arg-find-h">find_h<a class="anchor" aria-label="anchor" href="#arg-find-h"></a></dt>
<dd><p>a <code>boolean</code> indicating if the height of cut should be found for
the requested <code>n_clust</code>.</p></dd>


<dt id="arg-h-max">h_max<a class="anchor" aria-label="anchor" href="#arg-h-max"></a></dt>
<dd><p>a <code>numeric</code> indicating the maximum possible tree height for
the chosen <code>index</code>.</p></dd>


<dt id="arg-h-min">h_min<a class="anchor" aria-label="anchor" href="#arg-h-min"></a></dt>
<dd><p>a <code>numeric</code> indicating the minimum possible height in the tree
for the chosen <code>index</code>.</p></dd>


<dt id="arg-consensus-p">consensus_p<a class="anchor" aria-label="anchor" href="#arg-consensus-p"></a></dt>
<dd><p>a <code>numeric</code>, (only if <code>optimal_tree_method = "consensus"</code>,
indicating the threshold proportion of trees that must
support a region/cluster for it to be included in the final consensus tree.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of class <code>bioregion.clusters</code> with five slots:</p><ol><li><p><strong>name</strong>: <code>character</code> containing the name of the algorithm</p></li>
<li><p><strong>args</strong>: <code>list</code> of input arguments as provided by the user</p></li>
<li><p><strong>inputs</strong>: <code>list</code> of characteristics of the clustering process</p></li>
<li><p><strong>algorithm</strong>: <code>list</code> of all objects associated with the
clustering procedure, such as original cluster objects</p></li>
<li><p><strong>clusters</strong>: <code>data.frame</code> containing the clustering results</p></li>
</ol><p>In the <code>algorithm</code> slot, users can find the following elements:</p>
<ul><li><p><code>trials</code>: a list containing all randomization trials. Each trial
contains the dissimilarity matrix, with site order randomized, the
associated tree and the cophenetic correlation coefficient (Spearman) for
that tree</p></li>
<li><p><code>final.tree</code>: a <code>hclust</code> object containing the final
hierarchical tree to be used</p></li>
<li><p><code>final.tree.coph.cor</code>: the cophenetic correlation coefficient
between the initial dissimilarity matrix and <code>final.tree</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function is based on <a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a>.
The default method for the hierarchical tree is <code>average</code>, i.e.
UPGMA as it has been recommended as the best method to generate a tree
from beta diversity dissimilarity Kreft2010bioregion.</p>
<p>Clusters can be obtained by two methods:</p><ul><li><p>Specifying a desired number of clusters in <code>n_clust</code></p></li>
<li><p>Specifying one or several heights of cut in <code>cut_height</code></p></li>
</ul><p>To find an optimal number of clusters, see <code><a href="partition_metrics.html">partition_metrics()</a></code></p>
<p>It is important to pay attention to the fact that the order of rows
in the input distance matrix
influences the tree topology as explained in
Dapporto2013bioregion. To address this, the function generates
multiple trees by randomizing the distance matrix.
Two methods are available to obtain the final tree:</p><ul><li><p><code>optimal_tree_method = "best"</code>: This method selects the tree with
the highest cophenetic correlation coefficient, representing the best fit
between the hierarchical structure and the original distance matrix.</p></li>
<li><p><code>optimal_tree_method = "consensus"</code>: This method constructs a consensus
tree using phylogenetic methods with the function
<a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a>.
When using this option, you must set the <code>consensus_p</code> parameter, which
indicates
the proportion of trees that must contain a region/cluster for it to be
included
in the final consensus tree.
Consensus trees lack an inherent height because they represent a majority
structure rather than an actual hierarchical clustering. To assign heights,
we use a non-negative least squares method (<a href="https://klausvigo.github.io/phangorn/reference/designTree.html" class="external-link">nnls.tree</a>)
based on the initial distance matrix, ensuring that the consensus
tree preserves
approximate distances among clusters.</p></li>
</ul><p>AIt is currently unresolved which method is best to use, and so we recommend
users to consult the literature.
Consensus trees can offer more stable solutions
in certain contexts Dapporto2013bioregion, but at large
spatial scales, they may yield inconsistent results
(see appendix S2 in Leroy2019bioregion).
Additionally, consensus trees often have a lower cophenetic
correlation coefficient
than the best individual tree, so users should consider these factors when
choosing the method.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kreft2010bioregion</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="cut_tree.html">cut_tree</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>),
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) and
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User-defined number of clusters</span></span></span>
<span class="r-in"><span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  -- range of cophenetic correlation coefficients among</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                      trials: 0.36 - 0.44</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final tree has a 0.44 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining the cut height to reach 5 groups...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --&gt; 0.0859375</span>
<span class="r-in"><span><span class="va">tree1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : hclu_hierarclust </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(hierarchical clustering based on a dissimilarity matrix)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Name of dissimilarity metric:  Simpson </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Tree construction method:  average </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Randomization of the dissimilarity matrix:  yes, number of trials 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Method to compute the final tree:  Tree with the best cophenetic correlation coefficient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Cophenetic correlation coefficient:  0.438 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters requested by the user:  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Height of cut of the hierarchical tree: 0.086 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hclu_hierarclust-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tree1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ name        : chr "hclu_hierarclust"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ args        :List of 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ index              : chr "Simpson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ method             : chr "average"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ randomize          : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ n_runs             : num 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ optimal_tree_method: chr "best"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ keep_trials        : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ n_clust            : num 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cut_height         : NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ find_h             : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ h_max              : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ h_min              : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ consensus_p        : num 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ dynamic_tree_cut   : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ inputs      :List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ bipartite      : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ weight         : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pairwise       : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pairwise_metric: chr "Simpson"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ dissimilarity  : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ nb_sites       : int 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ hierarchical   : logi FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ algorithm   :List of 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ trials             : chr "Trials not stored in output"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ final.tree         :List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "class")= chr "hclust"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ final.tree.coph.cor: num 0.438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ output_n_clust     : int 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ output_cut_height  : Named num 0.0859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..- attr(*, "names")= chr "k_5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ clusters    :'data.frame':	20 obs. of  2 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ID : chr [1:20] "Site6" "Site15" "Site7" "Site16" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ K_5: chr [1:20] "1" "1" "2" "1" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cluster_info:'data.frame':	1 obs. of  4 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ partition_name   : chr "K_5"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ n_clust          : int 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ requested_n_clust: num 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ output_cut_height: num 0.0859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "bioregion.clusters" "list"</span>
<span class="r-in"><span><span class="va">tree1</span><span class="op">$</span><span class="va">clusters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ID K_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site6   Site6   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site15 Site15   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site7   Site7   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site16 Site16   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site17 Site17   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site1   Site1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site18 Site18   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site4   Site4   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site10 Site10   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site3   Site3   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site14 Site14   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site12 Site12   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site2   Site2   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site5   Site5   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site8   Site8   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site13 Site13   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site20 Site20   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site11 Site11   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site9   Site9   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site19 Site19   1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User-defined height cut</span></span></span>
<span class="r-in"><span><span class="co"># Only one height</span></span></span>
<span class="r-in"><span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, cut_height <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  -- range of cophenetic correlation coefficients among</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                      trials: 0.36 - 0.44</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final tree has a 0.44 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-in"><span><span class="va">tree2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results for algorithm : hclu_hierarclust </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	(hierarchical clustering based on a dissimilarity matrix)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of sites:  20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Name of dissimilarity metric:  Simpson </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Tree construction method:  average </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Randomization of the dissimilarity matrix:  yes, number of trials 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Method to compute the final tree:  Tree with the best cophenetic correlation coefficient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Cophenetic correlation coefficient:  0.438 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Heights of cut requested by the user:  0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of partitions:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Number of clusters:  9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Height of cut of the hierarchical tree: 0.05 </span>
<span class="r-in"><span><span class="va">tree2</span><span class="op">$</span><span class="va">clusters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ID K_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Site15   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Site5   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Site16   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Site20   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Site19   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Site4   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  Site18   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Site12   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  Site10   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  Site9   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  Site1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  Site7   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Site17   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Site13   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  Site3   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Site11   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  Site2   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  Site8   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  Site6   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Site14   4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple heights</span></span></span>
<span class="r-in"><span><span class="va">tree3</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, cut_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.15</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  -- range of cophenetic correlation coefficients among</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                      trials: 0.36 - 0.43</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final tree has a 0.43 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tree3</span><span class="op">$</span><span class="va">clusters</span> <span class="co"># Mind the order of height cuts: from deep to shallow cuts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ID K_1_1 K_1_2 K_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site15 Site15     1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site10 Site10     1     1   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site4   Site4     1     1   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site5   Site5     1     1   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site8   Site8     1     1   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site11 Site11     1     1   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site13 Site13     1     1   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site7   Site7     1     1   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site20 Site20     1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site17 Site17     1     1   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site2   Site2     1     1   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site12 Site12     1     1   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site6   Site6     1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site18 Site18     1     1   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site1   Site1     1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site14 Site14     1     1   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site3   Site3     1     1   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site9   Site9     1     1   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site19 Site19     1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site16 Site16     1     1   3</span>
<span class="r-in"><span><span class="co"># Info on each partition can be found in table cluster_info</span></span></span>
<span class="r-in"><span><span class="va">tree3</span><span class="op">$</span><span class="va">cluster_info</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        partition_name n_clust requested_cut_height</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h_0.25          K_1_1       1                 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h_0.15          K_1_2       1                 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h_0.05            K_9       9                 0.05</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="hclu_hierarclust-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Recut the tree afterwards</span></span></span>
<span class="r-in"><span><span class="va">tree3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="cut_tree.html">cut_tree</a></span><span class="op">(</span><span class="va">tree3</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining the cut height to reach 5 groups...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --&gt; 0.0859375</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make multiple cuts</span></span></span>
<span class="r-in"><span><span class="va">tree4</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, n_clust <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  -- range of cophenetic correlation coefficients among</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                      trials: 0.36 - 0.44</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final tree has a 0.44 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 10. Closest number found: 9</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 16. Closest number found: 15</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 17. Closest number found: 15</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 18. Closest number found: 15</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 19. Closest number found: 15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change the method to get the final tree (see details)</span></span></span>
<span class="r-in"><span><span class="va">tree5</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>,</span></span>
<span class="r-in"><span>                          optimal_tree_method <span class="op">=</span> <span class="st">"consensus"</span>,</span></span>
<span class="r-in"><span>                          n_clust <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                          consensus_p <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomizing the dissimilarity matrix with 30 trials</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final tree has a 0.27 cophenetic correlation coefficient with the initial dissimilarity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Determining the cut height to reach 10 groups...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> --&gt; 0.0929225905391848</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The requested number of cluster could not be found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>                          for k = 10. Closest number found: 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

