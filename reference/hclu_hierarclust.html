<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hierarchical clustering based on dissimilarity or beta-diversity — hclu_hierarclust • bioregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical clustering based on dissimilarity or beta-diversity — hclu_hierarclust"><meta name="description" content="This function generates a hierarchical tree from a dissimilarity
(beta-diversity) data.frame, calculates the cophenetic correlation
coefficient, and optionally retrieves clusters from the tree upon user
request. The function includes a randomization process for the dissimilarity
matrix to generate the tree, with two methods available for constructing the
final tree. Typically, the dissimilarity data.frame is a
bioregion.pairwise object obtained by running similarity,
or by running similarity followed by similarity_to_dissimilarity."><meta property="og:description" content="This function generates a hierarchical tree from a dissimilarity
(beta-diversity) data.frame, calculates the cophenetic correlation
coefficient, and optionally retrieves clusters from the tree upon user
request. The function includes a randomization process for the dissimilarity
matrix to generate the tree, with two methods available for constructing the
final tree. Typically, the dissimilarity data.frame is a
bioregion.pairwise object obtained by running similarity,
or by running similarity followed by similarity_to_dissimilarity."><meta property="og:image" content="https://bioRgeo.github.io/bioregion/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Hierarchical clustering based on dissimilarity or beta-diversity</h1>
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/R/hclu_hierarclust.R" class="external-link"><code>R/hclu_hierarclust.R</code></a></small>
      <div class="d-none name"><code>hclu_hierarclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a hierarchical tree from a dissimilarity
(beta-diversity) <code>data.frame</code>, calculates the cophenetic correlation
coefficient, and optionally retrieves clusters from the tree upon user
request. The function includes a randomization process for the dissimilarity
matrix to generate the tree, with two methods available for constructing the
final tree. Typically, the dissimilarity <code>data.frame</code> is a
<code>bioregion.pairwise</code> object obtained by running <code>similarity</code>,
or by running <code>similarity</code> followed by <code>similarity_to_dissimilarity</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hclu_hierarclust</span><span class="op">(</span></span>
<span>  <span class="va">dissimilarity</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dissimilarity</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  randomize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_runs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  keep_trials <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  optimal_tree_method <span class="op">=</span> <span class="st">"iterative_consensus_tree"</span>,</span>
<span>  n_clust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cut_height <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  find_h <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  h_max <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  h_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  consensus_p <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dissimilarity">dissimilarity<a class="anchor" aria-label="anchor" href="#arg-dissimilarity"></a></dt>
<dd><p>The output object from <code><a href="dissimilarity.html">dissimilarity()</a></code> or
<code><a href="similarity_to_dissimilarity.html">similarity_to_dissimilarity()</a></code>, or a <code>dist</code> object.
If a <code>data.frame</code> is used, the first two columns represent pairs of sites
(or any pair of nodes), and the subsequent column(s) contain the
dissimilarity indices.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>The name or number of the dissimilarity column to use. By
default, the third column name of <code>dissimilarity</code> is used.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The name of the hierarchical classification method, as in
<a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a>. Should be one of <code>"ward.D"</code>,
<code>"ward.D2"</code>, <code>"single"</code>, <code>"complete"</code>, <code>"average"</code>
(= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (= WPGMC), or
<code>"centroid"</code> (= UPGMC).</p></dd>


<dt id="arg-randomize">randomize<a class="anchor" aria-label="anchor" href="#arg-randomize"></a></dt>
<dd><p>A <code>boolean</code> indicating whether the dissimilarity matrix
should be randomized to account for the order of sites in the dissimilarity
matrix.</p></dd>


<dt id="arg-n-runs">n_runs<a class="anchor" aria-label="anchor" href="#arg-n-runs"></a></dt>
<dd><p>The number of trials for randomizing the dissimilarity matrix.</p></dd>


<dt id="arg-keep-trials">keep_trials<a class="anchor" aria-label="anchor" href="#arg-keep-trials"></a></dt>
<dd><p>A <code>character</code> string indicating whether random trial results
(including the randomized matrix, the associated tree and metrics for that tree)
should be stored in the output object. Possible values are <code>"no"</code> (default),
<code>"all"</code> or <code>"metrics"</code>. Note that this parameter is automatically set to
<code>"no"</code> if <code>optimal_tree_method = "iterative_consensus_tree"</code>.</p></dd>


<dt id="arg-optimal-tree-method">optimal_tree_method<a class="anchor" aria-label="anchor" href="#arg-optimal-tree-method"></a></dt>
<dd><p>A <code>character</code> string indicating how the final tree
should be obtained from all trials. Possible values are
<code>"iterative_consensus_tree"</code> (default), <code>"best"</code> or <code>"consensus"</code>.
<strong>We recommend <code>"iterative_consensus_tree"</code>. See Details.</strong></p></dd>


<dt id="arg-n-clust">n_clust<a class="anchor" aria-label="anchor" href="#arg-n-clust"></a></dt>
<dd><p>An <code>integer</code> vector or a single <code>integer</code> indicating the
number of clusters to be obtained from the hierarchical tree, or the output
from <a href="bioregionalization_metrics.html">bioregionalization_metrics</a>. This parameter should not be used
simultaneously with <code>cut_height</code>.</p></dd>


<dt id="arg-cut-height">cut_height<a class="anchor" aria-label="anchor" href="#arg-cut-height"></a></dt>
<dd><p>A <code>numeric</code> vector indicating the height(s) at which the
tree should be cut. This parameter should not be used simultaneously with
<code>n_clust</code>.</p></dd>


<dt id="arg-find-h">find_h<a class="anchor" aria-label="anchor" href="#arg-find-h"></a></dt>
<dd><p>A <code>boolean</code> indicating whether the height of the cut should be
found for the requested <code>n_clust</code>.</p></dd>


<dt id="arg-h-max">h_max<a class="anchor" aria-label="anchor" href="#arg-h-max"></a></dt>
<dd><p>A <code>numeric</code> value indicating the maximum possible tree height
for the chosen <code>index</code>.</p></dd>


<dt id="arg-h-min">h_min<a class="anchor" aria-label="anchor" href="#arg-h-min"></a></dt>
<dd><p>A <code>numeric</code> value indicating the minimum possible height in the
tree for the chosen <code>index</code>.</p></dd>


<dt id="arg-consensus-p">consensus_p<a class="anchor" aria-label="anchor" href="#arg-consensus-p"></a></dt>
<dd><p>A <code>numeric</code> value (applicable only if
<code>optimal_tree_method = "consensus"</code>) indicating the threshold proportion of
trees that must support a region/cluster for it to be included in the final
consensus tree.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>boolean</code> indicating whether to
display progress messages. Set to <code>FALSE</code> to suppress these messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of class <code>bioregion.clusters</code> with five slots:</p><ol><li><p><strong>name</strong>: A <code>character</code> string containing the name of the algorithm.</p></li>
<li><p><strong>args</strong>: A <code>list</code> of input arguments as provided by the user.</p></li>
<li><p><strong>inputs</strong>: A <code>list</code> describing the characteristics of the clustering process.</p></li>
<li><p><strong>algorithm</strong>: A <code>list</code> containing all objects associated with the
clustering procedure, such as the original cluster objects.</p></li>
<li><p><strong>clusters</strong>: A <code>data.frame</code> containing the clustering results.</p></li>
</ol><p>In the <code>algorithm</code> slot, users can find the following elements:</p>
<ul><li><p><code>trials</code>: A list containing all randomization trials. Each trial
includes the dissimilarity matrix with randomized site order, the
associated tree, and the cophenetic correlation coefficient for
that tree.</p></li>
<li><p><code>final.tree</code>: An <code>hclust</code> object representing the final
hierarchical tree to be used.</p></li>
<li><p><code>final.tree.coph.cor</code>: The cophenetic correlation coefficient
between the initial dissimilarity matrix and the <code>final.tree</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function is based on <a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a>.
The default method for the hierarchical tree is <code>average</code>, i.e.
UPGMA as it has been recommended as the best method to generate a tree
from beta diversity dissimilarity (Kreft &amp; Jetz, 2010).</p>
<p>Clusters can be obtained by two methods:</p><ul><li><p>Specifying a desired number of clusters in <code>n_clust</code></p></li>
<li><p>Specifying one or several heights of cut in <code>cut_height</code></p></li>
</ul><p>To find an optimal number of clusters, see <code><a href="bioregionalization_metrics.html">bioregionalization_metrics()</a></code></p>
<p>It is important to pay attention to the fact that the order of rows
in the input distance matrix influences the tree topology as explained in
Dapporto (2013). To address this, the function generates multiple trees by
randomizing the distance matrix.</p>
<p>Two methods are available to obtain the final tree:</p><ul><li><p><code>optimal_tree_method = "iterative_consensus_tree"</code>: The Iterative
Hierarchical Consensus Tree (IHCT) method reconstructs a consensus tree by
iteratively splitting the dataset into two subclusters based on the pairwise
dissimilarity of sites across <code>n_runs</code> trees based on <code>n_runs</code> randomizations
of the distance matrix. At each iteration, it
identifies the majority membership of sites into two stable groups across
all trees,
calculates the height based on the selected linkage method (<code>method</code>),
and enforces monotonic constraints on
node heights to produce a coherent tree structure.
This approach provides a robust, hierarchical representation of site
relationships, balancing
cluster stability and hierarchical constraints.</p></li>
<li><p><code>optimal_tree_method = "best"</code>: This method selects one tree among with
the highest cophenetic correlation coefficient, representing the best fit
between the hierarchical structure and the original distance matrix.</p></li>
<li><p><code>optimal_tree_method = "consensus"</code>: This method constructs a consensus
tree using phylogenetic methods with the function
<a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a>.
When using this option, you must set the <code>consensus_p</code> parameter, which
indicates
the proportion of trees that must contain a region/cluster for it to be
included
in the final consensus tree.
Consensus trees lack an inherent height because they represent a majority
structure rather than an actual hierarchical clustering. To assign heights,
we use a non-negative least squares method (<a href="https://klausvigo.github.io/phangorn/reference/designTree.html" class="external-link">nnls.tree</a>)
based on the initial distance matrix, ensuring that the consensus
tree preserves
approximate distances among clusters.</p></li>
</ul><p>We recommend using the <code>"iterative_consensus_tree"</code> as all the branches of
this tree will always reflect the majority decision among many randomized
versions of the distance matrix. This method is inspired by
Dapporto et al. (2015), which also used the majority decision
among many randomized versions of the distance matrix, but it expands it
to reconstruct the entire topology of the tree iteratively.</p>
<p>We do not recommend using the basic <code>consensus</code> method because in many
contexts it provides inconsistent results, with a meaningless tree topology
and a very low cophenetic correlation coefficient.</p>
<p>For a fast exploration of the tree, we recommend using the <code>best</code> method
which will only select the tree with the highest cophenetic correlation
coefficient among all randomized versions of the distance matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kreft H &amp; Jetz W (2010) A framework for delineating biogeographical regions
based on species distributions. <em>Journal of Biogeography</em> 37, 2029-2053.</p>
<p>Dapporto L, Ramazzotti M, Fattorini S, Talavera G, Vila R &amp; Dennis, RLH
(2013) Recluster: an unbiased clustering procedure for beta-diversity
turnover. <em>Ecography</em> 36, 1070–1075.</p>
<p>Dapporto L, Ciolli G, Dennis RLH, Fox R &amp; Shreeve TG (2015) A new procedure
for extrapolating turnover regionalization at mid-small spatial scales,
tested on British butterflies. <em>Methods in Ecology and Evolution</em> 6
, 1287–1297.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://biorgeo.github.io/bioregion/articles/a4_1_hierarchical_clustering.html" class="external-link">https://biorgeo.github.io/bioregion/articles/a4_1_hierarchical_clustering.html</a>.</p>
<p>Associated functions:
<a href="cut_tree.html">cut_tree</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris Leroy (<a href="mailto:leroy.boris@gmail.com">leroy.boris@gmail.com</a>) <br>
Pierre Denelle (<a href="mailto:pierre.denelle@gmail.com">pierre.denelle@gmail.com</a>) <br>
Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1</span><span class="op">:</span><span class="fl">1001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Site"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Species"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comat</span>, metric <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User-defined number of clusters</span></span></span>
<span class="r-in"><span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, </span></span>
<span class="r-in"><span>                          n_clust <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building the iterative hierarchical consensus tree... Note that this process can take time especially if you have a lot of sites.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in if (nrow(dist_matrix) &gt; 2) {    subclusters &lt;- stable_binary_split(dist_matrix, method = method,         n_runs = n_runs, binsplit = "tree")} else {    subclusters &lt;- list(attr(dist_matrix, "Labels")[1], attr(dist_matrix,         "Labels")[2])}:</span> argument is of length zero</span>
<span class="r-in"><span><span class="va">tree1</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree1' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree1' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tree1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree1' not found</span>
<span class="r-in"><span><span class="va">tree1</span><span class="op">$</span><span class="va">clusters</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree1' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User-defined height cut</span></span></span>
<span class="r-in"><span><span class="co"># Only one height</span></span></span>
<span class="r-in"><span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, </span></span>
<span class="r-in"><span>                          cut_height <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building the iterative hierarchical consensus tree... Note that this process can take time especially if you have a lot of sites.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in if (nrow(dist_matrix) &gt; 2) {    subclusters &lt;- stable_binary_split(dist_matrix, method = method,         n_runs = n_runs, binsplit = "tree")} else {    subclusters &lt;- list(attr(dist_matrix, "Labels")[1], attr(dist_matrix,         "Labels")[2])}:</span> argument is of length zero</span>
<span class="r-in"><span><span class="va">tree2</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree2' not found</span>
<span class="r-in"><span><span class="va">tree2</span><span class="op">$</span><span class="va">clusters</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple heights</span></span></span>
<span class="r-in"><span><span class="va">tree3</span> <span class="op">&lt;-</span> <span class="fu">hclu_hierarclust</span><span class="op">(</span><span class="va">dissim</span>, </span></span>
<span class="r-in"><span>                          cut_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.15</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building the iterative hierarchical consensus tree... Note that this process can take time especially if you have a lot of sites.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in if (nrow(dist_matrix) &gt; 2) {    subclusters &lt;- stable_binary_split(dist_matrix, method = method,         n_runs = n_runs, binsplit = "tree")} else {    subclusters &lt;- list(attr(dist_matrix, "Labels")[1], attr(dist_matrix,         "Labels")[2])}:</span> argument is of length zero</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tree3</span><span class="op">$</span><span class="va">clusters</span> <span class="co"># Mind the order of height cuts: from deep to shallow cuts</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree3' not found</span>
<span class="r-in"><span><span class="co"># Info on each partition can be found in table cluster_info</span></span></span>
<span class="r-in"><span><span class="va">tree3</span><span class="op">$</span><span class="va">cluster_info</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree3' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree3</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tree3' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

