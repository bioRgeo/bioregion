<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5.2 Summary metrics • bioregion</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5.2 Summary metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_summary_metrics.html">5.2 Summary metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_compare_bioregionalizations.html">5.3 Compare bioregionalizations</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications">
<li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>5.2 Summary metrics</h1>
                        <h4 data-toc-skip class="author">Pierre Denelle,
Boris Leroy and Maxime Lenormand</h4>
            
            <h4 data-toc-skip class="date">2026-01-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/vignettes/a5_2_summary_metrics.Rmd" class="external-link"><code>vignettes/a5_2_summary_metrics.Rmd</code></a></small>
      <div class="d-none name"><code>a5_2_summary_metrics.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we aim to evaluate the contribution of individual
species and sites to each bioregion using the function
<code><a href="../reference/site_species_metrics.html">site_species_metrics()</a></code>. We also show how various metrics at
the bioregion level can be computed, in particular with the function
<code><a href="../reference/bioregion_metrics.html">bioregion_metrics()</a></code>.</p>
<div class="section level2">
<h2 id="data">1. Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We use the vegetation dataset included in the
<code>bioregion</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vegedf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vegemat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculation of (dis)similarity matrices</span></span>
<span><span class="va">vegedissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">vegemat</span>, metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vegesim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity_to_similarity.html">dissimilarity_to_similarity</a></span><span class="op">(</span><span class="va">vegedissim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bioregionalization">2. Bioregionalization<a class="anchor" aria-label="anchor" href="#bioregionalization"></a>
</h2>
<p>We use the same three bioregionalization algorithms as in the <a href="https://biorgeo.github.io/bioregion/articles/a5_visualization.html" class="external-link">visualization
vignette</a>, i.e., non-hierarchical, hierarchical, and network
bioregionalizations. In addition, we include a network
bioregionalization algorithm based on a bipartite network, which assigns
a bioregion (or cluster) to both sites and species. We chose three
bioregions for the non-hierarchical and hierarchical
bioregionalizations. <br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Non hierarchical bioregionalization</span></span>
<span><span class="va">vege_nhclu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">vegedissim</span>, </span>
<span>                           n_clust <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                           index <span class="op">=</span> <span class="st">"Simpson"</span>,</span>
<span>                           seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">vege_nhclu</span><span class="op">$</span><span class="va">cluster_info</span> </span></code></pre></div>
<pre><code><span><span class="co">##     partition_name n_clust</span></span>
<span><span class="co">## K_3            K_3       3</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hierarchical bioregionalization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">vege_hclu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hclu_hierarclust.html">hclu_hierarclust</a></span><span class="op">(</span>dissimilarity <span class="op">=</span> <span class="va">vegedissim</span>,</span>
<span>                              index <span class="op">=</span> <span class="st">"Simpson"</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"average"</span>, </span>
<span>                              n_clust <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                              optimal_tree_method <span class="op">=</span> <span class="st">"best"</span>,</span>
<span>                              verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vege_hclu</span><span class="op">$</span><span class="va">cluster_info</span></span></code></pre></div>
<pre><code><span><span class="co">##   partition_name n_clust requested_n_clust output_cut_height</span></span>
<span><span class="co">## 1            K_3       3                 3            0.5625</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Network bioregionalization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">vege_netclu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netclu_walktrap.html">netclu_walktrap</a></span><span class="op">(</span><span class="va">vegesim</span>,</span>
<span>                               index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span>
<span><span class="va">vege_netclu</span><span class="op">$</span><span class="va">cluster_info</span> </span></code></pre></div>
<pre><code><span><span class="co">##     partition_name n_clust</span></span>
<span><span class="co">## K_3            K_3       3</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bipartite network bioregionalization</span></span>
<span><span class="fu"><a href="../reference/install_binaries.html">install_binaries</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vege_netclubip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netclu_infomap.html">netclu_infomap</a></span><span class="op">(</span><span class="va">vegedf</span>,</span>
<span>                                 seed <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                 bipartite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">vege_netclubip</span><span class="op">$</span><span class="va">cluster_info</span></span></code></pre></div>
<pre><code><span><span class="co">##     partition_name n_clust</span></span>
<span><span class="co">## K_8            K_8       8</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="species-to-bioregion-site-to-bioregion-metrics">3. Species-to-bioregion &amp; site-to-bioregion metrics<a class="anchor" aria-label="anchor" href="#species-to-bioregion-site-to-bioregion-metrics"></a>
</h2>
<p>Several metrics evaluating the contribution of a species or a site to
each bioregion can be computed and further aggregated to assess the
relationship between a species or a site and the bioregionalization.</p>
<div class="section level3">
<h3 id="species-to-bioregion-metrics">3.1 Species-to-bioregion metrics<a class="anchor" aria-label="anchor" href="#species-to-bioregion-metrics"></a>
</h3>
<p>Species-to-bioregion metrics are based on a bioregionalization
containing <span class="math inline">\(K\)</span> bioregions
(<code>vege_nhclu</code> computed above for example) and its associated
site–species co-occurrence matrix <a href="https://biorgeo.github.io/bioregion/reference/vegemat.html" class="external-link">vegemat</a>
to compute three core terms, from which occurrence-based metrics are
derived.</p>
<ul>
<li>
<span class="math inline">\(n_{sb}\)</span> is the number of sites
belonging to bioregion <span class="math inline">\(b\)</span> in which
species <span class="math inline">\(s\)</span> is present.<br>
</li>
<li>
<span class="math inline">\(n_s\)</span> is the total number of
sites in which species <span class="math inline">\(s\)</span> is
present.<br>
</li>
<li>
<span class="math inline">\(n_b\)</span> is the total number of
sites belonging to bioregion <span class="math inline">\(b\)</span>.</li>
</ul>
<center>
<img align="bottom" width="70%" height="70%" src="../reference/figures/core_terms.svg" alt="Illustration of core terms.">
</center>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                            bioregion_metrics <span class="op">=</span> <span class="st">"CoreTerms"</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"occurrence"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsb</span><span class="op">$</span><span class="va">species_bioregions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Species Bioregion n_sb n_s n_b</span></span>
<span><span class="co">## 1    10001         1   27 254 358</span></span>
<span><span class="co">## 2    10001         2   97 254 150</span></span>
<span><span class="co">## 3    10001         3  130 254 207</span></span>
<span><span class="co">## 4    10002         1    5  19 358</span></span>
<span><span class="co">## 5    10002         2    1  19 150</span></span>
<span><span class="co">## 6    10002         3   13  19 207</span></span>
<span><span class="co">## 7    10003         1   82  86 358</span></span>
<span><span class="co">## 8    10003         2    0  86 150</span></span>
<span><span class="co">## 9    10003         3    4  86 207</span></span>
<span><span class="co">## 10   10004         1  205 438 358</span></span></code></pre>
<p>These core terms and associated metrics are computed when
<code>data_type = "occurrence"</code> (or
<code>data_type = "both"</code>) and <code>cluster_on = "site"</code>
(or <code>cluster_on = "both"</code>). <code>cluster_on = "site"</code>
means that a bioregion is assigned to each site in
<code>vege_nhclu</code>.</p>
<p>Several metrics can be derived from these core terms.</p>
<div class="section level4">
<h4 id="specificity-occurrence">Specificity (occurrence)<a class="anchor" aria-label="anchor" href="#specificity-occurrence"></a>
</h4>
<p>The specificity <span class="math inline">\(A_{sb}\)</span> of
species <span class="math inline">\(s\)</span> for bioregion <span class="math inline">\(b\)</span> <span class="citation">(De Cáceres
&amp; Legendre, 2009)</span> is defined as</p>
<p><span class="math display">\[A_{sb} = \frac{n_{sb}}{n_s}\]</span></p>
<p>and measures the fraction of occurrences of species <span class="math inline">\(s\)</span> that belong to bioregion <span class="math inline">\(b\)</span>. It therefore reflects the uniqueness
of a species to a particular bioregion.</p>
</div>
<div class="section level4">
<h4 id="nspecificity-occurrence">NSpecificity (occurrence)<a class="anchor" aria-label="anchor" href="#nspecificity-occurrence"></a>
</h4>
<p>A normalized version that accounts for the size of each bioregion is
also available, as defined in <span class="citation">(De Cáceres &amp;
Legendre, 2009)</span>:</p>
<p><span class="math display">\[\bar{A}_{sb} =
\frac{n_{sb}/n_b}{\sum_{k=1}^K n_{sk}/n_k}\]</span></p>
<p>It corresponds to a normalized specificity value that adjusts for
differences in bioregion size.</p>
</div>
<div class="section level4">
<h4 id="fidelity-occurrence">Fidelity (occurrence)<a class="anchor" aria-label="anchor" href="#fidelity-occurrence"></a>
</h4>
<p>The fidelity <span class="math inline">\(B_{sb}\)</span> of species
<span class="math inline">\(s\)</span> for bioregion <span class="math inline">\(b\)</span> <span class="citation">(De Cáceres
&amp; Legendre, 2009)</span> is defined as</p>
<p><span class="math display">\[B_{sb} = \frac{n_{sb}}{n_b}\]</span></p>
<p>and measures the fraction of sites in bioregion <span class="math inline">\(b\)</span> where species <span class="math inline">\(s\)</span> is present. It therefore reflects the
frequency of occurrence of a species within a bioregion.</p>
</div>
<div class="section level4">
<h4 id="indval-occurrence">IndVal (occurrence)<a class="anchor" aria-label="anchor" href="#indval-occurrence"></a>
</h4>
<p>The indicator value <span class="math inline">\(IndVal_{sb}\)</span>
of species <span class="math inline">\(s\)</span> for bioregion <span class="math inline">\(b\)</span> can be defined as the product of
specificity and fidelity <span class="citation">(De Cáceres &amp;
Legendre, 2009)</span>:</p>
<p><span class="math display">\[IndVal_{sb} = A_{sb} \times
B_{sb}\]</span></p>
<p>This index quantifies the strength of association between a species
and a bioregion by combining its specificity (uniqueness to that
bioregion) and fidelity (consistency of occurrence within that
bioregion). High IndVal values identify species that are both frequent
and restricted to a single bioregion, making them good indicators of
that region.</p>
</div>
<div class="section level4">
<h4 id="nindval-occurrence">NIndVal (occurrence)<a class="anchor" aria-label="anchor" href="#nindval-occurrence"></a>
</h4>
<p>A normalized version of the indicator value is also available:</p>
<p><span class="math display">\[\bar{IndVal}_{sb} = \bar{A}_{sb} \times
B_{sb}\]</span></p>
<p>This normalization adjusts for differences in bioregion size,
allowing more comparable indicator values across regions with unequal
sampling effort or extent.</p>
</div>
<div class="section level4">
<h4 id="rho-occurrence">Rho (occurrence)<a class="anchor" aria-label="anchor" href="#rho-occurrence"></a>
</h4>
<p>The contribution index <span class="math inline">\(\rho\)</span> can
also be calculated following <span class="citation">(Lenormand <em>et
al.</em>, 2019)</span>:</p>
<p><span class="math display">\[\rho_{sb} = \frac{n_{sb} -
n_s\frac{n_b}{n}}{\sqrt{\frac{n_b(n - n_b)}{n - 1}
\frac{n_s}{n}(1 - \frac{n_s}{n}) }}\]</span></p>
<p>This index measures the deviation between the observed number of
occurrences of species <span class="math inline">\(s\)</span> in
bioregion <span class="math inline">\(b\)</span> and the expected value
under random association, providing a standardized measure of
contribution to the bioregional structure.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                            bioregion_metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Specificity"</span>, <span class="st">"NSpecificity"</span>,</span>
<span>                                                  <span class="st">"Fidelity"</span>,</span>
<span>                                                  <span class="st">"IndVal"</span>, <span class="st">"NIndVal"</span>,</span>
<span>                                                  <span class="st">"Rho"</span>,</span>
<span>                                                  <span class="st">"CoreTerms"</span><span class="op">)</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"occurrence"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nsb</span><span class="op">$</span><span class="va">species_bioregions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Species Bioregion n_sb n_s n_b Specificity_occ NSpecificity_occ Fidelity_occ</span></span>
<span><span class="co">## 1    10001         1   27 254 358      0.10629921       0.05586158  0.075418994</span></span>
<span><span class="co">## 2    10001         2   97 254 150      0.38188976       0.47897510  0.646666667</span></span>
<span><span class="co">## 3    10001         3  130 254 207      0.51181102       0.46516332  0.628019324</span></span>
<span><span class="co">## 4    10002         1    5  19 358      0.26315789       0.16739339  0.013966480</span></span>
<span><span class="co">## 5    10002         2    1  19 150      0.05263158       0.07990244  0.006666667</span></span>
<span><span class="co">## 6    10002         3   13  19 207      0.68421053       0.75270417  0.062801932</span></span>
<span><span class="co">## 7    10003         1   82  86 358      0.95348837       0.92219928  0.229050279</span></span>
<span><span class="co">## 8    10003         2    0  86 150      0.00000000       0.00000000  0.000000000</span></span>
<span><span class="co">## 9    10003         3    4  86 207      0.04651163       0.07780072  0.019323671</span></span>
<span><span class="co">## 10   10004         1  205 438 358      0.46803653       0.31989959  0.572625698</span></span>
<span><span class="co">##      IndVal_occ NIndVal_occ    Rho_occ</span></span>
<span><span class="co">## 1  0.0080169797 0.004213024 -15.645265</span></span>
<span><span class="co">## 2  0.2469553806 0.309737230   8.383617</span></span>
<span><span class="co">## 3  0.3214272129 0.292131557   9.721763</span></span>
<span><span class="co">## 4  0.0036753896 0.002337896  -2.097447</span></span>
<span><span class="co">## 5  0.0003508772 0.000532683  -1.704102</span></span>
<span><span class="co">## 6  0.0429697432 0.047271276   3.842178</span></span>
<span><span class="co">## 7  0.2183967780 0.211230003   8.947452</span></span>
<span><span class="co">## 8  0.0000000000 0.000000000  -5.090898</span></span>
<span><span class="co">## 9  0.0008987754 0.001503396  -5.293785</span></span>
<span><span class="co">## 10 0.2680097446 0.183182724  -2.194976</span></span></code></pre>
<p>The abundance version of these metrics can also be computed when
<code>data_type = "abundance"</code> (or
<code>data_type = "both"</code>). In this case the core terms and
associated metrics are:</p>
<ul>
<li>
<span class="math inline">\(w_{sb}\)</span> is the sum of abundances
of species <strong>s</strong> in sites of bioregion
<strong>b</strong>.</li>
<li>
<span class="math inline">\(w_s\)</span> is the total abundance of
species <strong>s</strong>.<br>
</li>
<li>
<span class="math inline">\(w_b\)</span> is the total abundance of
all species present in sites of bioregion <strong>b</strong>.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                            bioregion_metrics <span class="op">=</span> <span class="st">"CoreTerms"</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wsb</span><span class="op">$</span><span class="va">species_bioregions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Species Bioregion w_sb  w_s     w_b</span></span>
<span><span class="co">## 1    10001         1   85 6255 1889243</span></span>
<span><span class="co">## 2    10001         2 3037 6255 1081424</span></span>
<span><span class="co">## 3    10001         3 3133 6255 1271474</span></span>
<span><span class="co">## 4    10002         1   81  295 1889243</span></span>
<span><span class="co">## 5    10002         2    3  295 1081424</span></span>
<span><span class="co">## 6    10002         3  211  295 1271474</span></span>
<span><span class="co">## 7    10003         1  439  444 1889243</span></span>
<span><span class="co">## 8    10003         2    0  444 1081424</span></span>
<span><span class="co">## 9    10003         3    5  444 1271474</span></span>
<span><span class="co">## 10   10004         1 2227 7476 1889243</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="specificity-abundance">Specificity (abundance)<a class="anchor" aria-label="anchor" href="#specificity-abundance"></a>
</h4>
<p><span class="math display">\[A_{sb} = \frac{w_{sb}}{w_s}\]</span></p>
</div>
<div class="section level4">
<h4 id="nspecificity-abundance">NSpecificity (abundance)<a class="anchor" aria-label="anchor" href="#nspecificity-abundance"></a>
</h4>
<p><span class="math display">\[\bar{A}_{sb} =
\frac{w_{sb}/n_b}{\sum_{k=1}^K w_{sk}/n_k}\]</span></p>
</div>
<div class="section level4">
<h4 id="fidelity-abundance">Fidelity (abundance)<a class="anchor" aria-label="anchor" href="#fidelity-abundance"></a>
</h4>
<p><span class="math display">\[B_{sb} = \frac{w_{sb}}{w_b}\]</span></p>
</div>
<div class="section level4">
<h4 id="indval-abundance">IndVal (abundance)<a class="anchor" aria-label="anchor" href="#indval-abundance"></a>
</h4>
<p><span class="math display">\[IndVal_{sb} = A_{sb} \times
\frac{n_{sb}}{n_b}\]</span> Note that the fidelity based on occurrence
is used here <span class="citation">(De Cáceres &amp; Legendre,
2009)</span>.</p>
</div>
<div class="section level4">
<h4 id="nindval-abundance">NIndVal (abundance)<a class="anchor" aria-label="anchor" href="#nindval-abundance"></a>
</h4>
<p><span class="math display">\[\bar{IndVal}_{sb} = \bar{A}_{sb} \times
\frac{n_{sb}}{n_b}\]</span></p>
<p>Note that the fidelity based on occurrence is used here <span class="citation">(De Cáceres &amp; Legendre, 2009)</span>.</p>
</div>
<div class="section level4">
<h4 id="rho-abundance">Rho (abundance)<a class="anchor" aria-label="anchor" href="#rho-abundance"></a>
</h4>
<p><span class="math display">\[\rho_{sb} = \frac{\mu_{sb} -
\mu_s}{\sqrt{\left(\frac{n - n_b}{n-1}\right)
\left(\frac{{\sigma_s}^2}{n_b}\right)}}\]</span> where</p>
<ul>
<li>
<span class="math inline">\(\mu_{sb} = \frac{w_{sb}}{n_b}\)</span>
the average abundance of species <span class="math inline">\(s\)</span>
in bioregion <span class="math inline">\(b\)</span> (as in
<strong>NSpecificity</strong> and <strong>NIndVal</strong>)</li>
<li>
<span class="math inline">\(\mu_s = \frac{w_s}{n}\)</span> the
average abundance of species <span class="math inline">\(s\)</span>
</li>
<li>
<span class="math inline">\(\sigma_s\)</span> the associated
standard deviation.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                            bioregion_metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Specificity"</span>, <span class="st">"NSpecificity"</span>,</span>
<span>                                                  <span class="st">"Fidelity"</span>,</span>
<span>                                                  <span class="st">"IndVal"</span>, <span class="st">"NIndVal"</span>,</span>
<span>                                                  <span class="st">"Rho"</span>,</span>
<span>                                                  <span class="st">"CoreTerms"</span><span class="op">)</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wsb</span><span class="op">$</span><span class="va">species_bioregions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Species Bioregion w_sb  w_s     w_b Specificity_abund NSpecificity_abund</span></span>
<span><span class="co">## 1    10001         1   85 6255 1889243        0.01358913        0.006665761</span></span>
<span><span class="co">## 2    10001         2 3037 6255 1081424        0.48553157        0.568417434</span></span>
<span><span class="co">## 3    10001         3 3133 6255 1271474        0.50087930        0.424916804</span></span>
<span><span class="co">## 4    10002         1   81  295 1889243        0.27457627        0.178777214</span></span>
<span><span class="co">## 5    10002         2    3  295 1081424        0.01016949        0.015803023</span></span>
<span><span class="co">## 6    10002         3  211  295 1271474        0.71525424        0.805419763</span></span>
<span><span class="co">## 7    10003         1  439  444 1889243        0.98873874        0.980682689</span></span>
<span><span class="co">## 8    10003         2    0  444 1081424        0.00000000        0.000000000</span></span>
<span><span class="co">## 9    10003         3    5  444 1271474        0.01126126        0.019317311</span></span>
<span><span class="co">## 10   10004         1 2227 7476 1889243        0.29788657        0.187592363</span></span>
<span><span class="co">##    Fidelity_abund IndVal_abund NIndVal_abund Rho_abund</span></span>
<span><span class="co">## 1    4.499157e-05 1.024878e-03  0.0005027250 -6.805816</span></span>
<span><span class="co">## 2    2.808334e-03 3.139771e-01  0.3675766076  4.731084</span></span>
<span><span class="co">## 3    2.464069e-03 3.145619e-01  0.2668559641  3.255761</span></span>
<span><span class="co">## 4    4.287432e-05 3.834864e-03  0.0024968885 -1.446975</span></span>
<span><span class="co">## 5    2.774120e-06 6.779661e-05  0.0001053535 -1.568655</span></span>
<span><span class="co">## 6    1.659491e-04 4.491935e-02  0.0505819175  3.003468</span></span>
<span><span class="co">## 7    2.323682e-04 2.264709e-01  0.2246256438  4.175535</span></span>
<span><span class="co">## 8    0.000000e+00 0.000000e+00  0.0000000000 -2.204186</span></span>
<span><span class="co">## 9    3.932444e-06 2.176089e-04  0.0003732814 -2.624519</span></span>
<span><span class="co">## 10   1.178779e-03 1.705775e-01  0.1074202078 -5.624022</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="species-to-bioregionalization-metrics">3.2 Species-to-bioregionalization metrics<a class="anchor" aria-label="anchor" href="#species-to-bioregionalization-metrics"></a>
</h3>
<p>Based on all these metrics, it is also possible to derive aggregated
metrics.<br>
For now, only the participation coefficient <span class="math inline">\(P_s\)</span> of a species <span class="math inline">\(s\)</span> to the bioregionalization as described
in <span class="citation">(Denelle <em>et al.</em>, 2020)</span> is
proposed, available in both its occurrence and abundance versions.</p>
<div class="section level4">
<h4 id="p-occurrence">P (occurrence)<a class="anchor" aria-label="anchor" href="#p-occurrence"></a>
</h4>
<p><span class="math display">\[
P_s =  1 - \sum_{k=1}^K \left(\frac{n_{sk}}{n_s}\right)^2
\]</span></p>
</div>
<div class="section level4">
<h4 id="p-abundance">P (abundance)<a class="anchor" aria-label="anchor" href="#p-abundance"></a>
</h4>
<p><span class="math display">\[
P_s =  1 - \sum_{k=1}^K \left(\frac{w_{sk}}{w_s}\right)^2
\]</span></p>
<p>These metrics measure how evenly a species is distributed among
bioregions. There are ranging from 0 to 1. Values close to 0 indicate
that the species is largely restricted to a single bioregion, while
values close to 1 indicate that the species is evenly distributed across
multiple bioregions.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                           bioregion_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="st">"P"</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"site"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span><span class="op">$</span><span class="va">species_bioregionalization</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Species      P_occ    P_abund</span></span>
<span><span class="co">## 1    10001 0.58091016 0.51319436</span></span>
<span><span class="co">## 2    10002 0.45983380 0.41291583</span></span>
<span><span class="co">## 3    10003 0.08869659 0.02226889</span></span>
<span><span class="co">## 4    10004 0.59334668 0.55362167</span></span>
<span><span class="co">## 5    10005 0.53267897 0.50874080</span></span>
<span><span class="co">## 6    10006 0.59944565 0.48784442</span></span>
<span><span class="co">## 7    10007 0.60353798 0.59088266</span></span>
<span><span class="co">## 8    10008 0.61624257 0.53496844</span></span>
<span><span class="co">## 9    10009 0.44444444 0.44444444</span></span>
<span><span class="co">## 10   10010 0.18447026 0.11565410</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="site-to-species-cluster-site-to-species-clustering-metrics">3.3 Site-to-species cluster &amp; site-to-species clustering
metrics<a class="anchor" aria-label="anchor" href="#site-to-species-cluster-site-to-species-clustering-metrics"></a>
</h3>
<p>Dual metrics can also be computed when a cluster or bioregion has
been assigned<br>
to each species in a bioregionalization (as is the case for
<code>vege_netclubip</code><br>
computed above). In this case, setting
<code>cluster_on = "species"</code> (or<br><code>cluster_on = "both"</code>) allows computing site-to-species
cluster and/or<br>
site-to-species clustering metrics. These metrics are derived from the
same<br>
principles as above, based on three core terms:</p>
<ul>
<li>
<span class="math inline">\(n_{gc}\)</span> is the number of species
belonging to cluster <span class="math inline">\(c\)</span> that are
present in site <span class="math inline">\(g\)</span>.<br>
</li>
<li>
<span class="math inline">\(n_g\)</span> is the total number of
species present in site <span class="math inline">\(g\)</span>.<br>
</li>
<li>
<span class="math inline">\(n_c\)</span> is the total number of
species belonging to cluster <span class="math inline">\(c\)</span>.</li>
</ul>
<p>and their abundance counterparts.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_species_metrics.html">site_species_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_netclubip</span>,</span>
<span>                            bioregion_metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Specificity"</span>, <span class="st">"NSpecificity"</span>,</span>
<span>                                                  <span class="st">"Fidelity"</span>,</span>
<span>                                                  <span class="st">"IndVal"</span>, <span class="st">"NIndVal"</span>,</span>
<span>                                                  <span class="st">"Rho"</span>,</span>
<span>                                                  <span class="st">"CoreTerms"</span><span class="op">)</span>,</span>
<span>                            bioregionalization_metrics <span class="op">=</span> <span class="st">"P"</span>,</span>
<span>                            data_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>                            cluster_on <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                            comat <span class="op">=</span> <span class="va">vegemat</span>,</span>
<span>                            similarity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gc</span><span class="op">$</span><span class="va">site_clusters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gc</span><span class="op">$</span><span class="va">site_clustering</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="site-to-bioregion-metrics">3.4 Site-to-bioregion metrics<a class="anchor" aria-label="anchor" href="#site-to-bioregion-metrics"></a>
</h3>
<p>A final type of metrics can be computed when a bioregionalization
containing<br><span class="math inline">\(K\)</span> bioregions (for example,
<code>vege_nhclu</code> computed above) and its associated<br>
site similarity matrix (<code>vegesim</code>) are available.</p>
<p>These metrics include the average similarity of each site to the
sites of<br>
each bioregion (<span class="math inline">\(MeanSim\)</span>) and the
associated standard deviation (<span class="math inline">\(SdSim\)</span>).<br>
When computing the average similarity, the focal site itself is not
included<br>
in the calculation for its own bioregion.</p>
<div class="section level4">
<h4 id="meansim">MeanSim<a class="anchor" aria-label="anchor" href="#meansim"></a>
</h4>
<p>Let <span class="math inline">\(g\)</span> be a site and <span class="math inline">\(b\)</span> a bioregion with sites <span class="math inline">\(g' \in b\)</span>, then:</p>
<p><span class="math display">\[MeanSim_{gb} = \frac{1}{n_b - \delta_{g
\in b}} \sum_{g' \in b, g' \neq g} sim_{gg'}\]</span> where
<span class="math inline">\(sim_{gg'}\)</span> is the similarity
between sites <span class="math inline">\(g\)</span> and <span class="math inline">\(g'\)</span>, <span class="math inline">\(n_b\)</span> is the number of sites in bioregion
<span class="math inline">\(b\)</span>, and <span class="math inline">\(\delta_{g \in b}\)</span> is 1 if site <span class="math inline">\(g\)</span> belongs to bioregion <span class="math inline">\(b\)</span> (to exclude itself), 0 otherwise.</p>
</div>
<div class="section level4">
<h4 id="sdsim">SdSim<a class="anchor" aria-label="anchor" href="#sdsim"></a>
</h4>
<p>The standard deviation of similarities of site <span class="math inline">\(g\)</span> to bioregion <span class="math inline">\(b\)</span> is:</p>
<p><span class="math display">\[SdSim_{gb} = \sqrt{\frac{1}{n_b - 1 -
\delta_{g \in b}} \sum_{g' \in b, g' \neq g} \left(
sim_{gg'} - MeanSim_{gb} \right)^2}\]</span> where <span class="math inline">\(sim_{gg'}\)</span> is the similarity between
sites <span class="math inline">\(g\)</span> and <span class="math inline">\(g'\)</span>, <span class="math inline">\(n_b\)</span> is the number of sites in bioregion
<span class="math inline">\(b\)</span>, and <span class="math inline">\(\delta_{g \in b}\)</span> is 1 if site <span class="math inline">\(g\)</span> belongs to bioregion <span class="math inline">\(b\)</span> (to exclude itself), 0 otherwise.</p>
</div>
</div>
<div class="section level3">
<h3 id="site-to-bioregionalization-metrics">3.5 Site-to-bioregionalization metrics<a class="anchor" aria-label="anchor" href="#site-to-bioregionalization-metrics"></a>
</h3>
<p>Based on <span class="math inline">\(MeanSim\)</span>, it is possible
to derive aggregated metrics that assess<br>
how well a site fits within its assigned bioregion relative to
others.</p>
<p>For now, only the Silhouette index <span class="citation">(Rousseeuw,
1987)</span> is proposed.</p>
<div class="section level4">
<h4 id="silhouette">Silhouette<a class="anchor" aria-label="anchor" href="#silhouette"></a>
</h4>
<p>The Silhouette index for a site <span class="math inline">\(g\)</span> is defined as:</p>
<p><span class="math display">\[Silhouette_g = \frac{a_g -
b_g}{\max(a_g, b_g)}\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(a_g\)</span> is the average similarity
of site <span class="math inline">\(g\)</span> to all other sites in its
own bioregion,<br>
</li>
<li>
<span class="math inline">\(b_g\)</span> is the average similarity
of site <span class="math inline">\(g\)</span> to all sites belonging to
the nearest bioregion.</li>
</ul>
<p>This index reflects how strongly a site is associated with its
assigned bioregion relative to the most similar alternative bioregion,
ranging from -1, when the site may be misassigned (i.e., more similar to
another bioregion than its own), to 1, when the site is well matched to
its own bioregion, and around 0 when the site lies near the boundary
between bioregions.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bioregion-metrics-spatial-coherence">4. Bioregion metrics &amp; spatial coherence<a class="anchor" aria-label="anchor" href="#bioregion-metrics-spatial-coherence"></a>
</h2>
<p>For each bioregion, we calculate the number of sites it contains and
the number of species present in those sites. The number and proportion
of endemic species are also computed. Endemic species are defined as
those occurring only in sites assigned to a particular bioregion.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bioregion_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bioregion_metrics.html">bioregion_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">vege_nhclu</span>,</span>
<span>                                       comat <span class="op">=</span> <span class="va">vegemat</span><span class="op">)</span></span>
<span><span class="va">bioregion_summary</span></span></code></pre></div>
<pre><code><span><span class="co">##   Bioregion Site_number Species_number Endemics Percentage_Endemic</span></span>
<span><span class="co">## 1         2         150           2688      133           4.947917</span></span>
<span><span class="co">## 2         3         207           3090       58           1.877023</span></span>
<span><span class="co">## 3         1         358           2821      407          14.427508</span></span></code></pre>
<p>We use the metric of spatial coherence as in <span class="citation">(Divíšek <em>et al.</em>, 2016)</span>, except that we
replace the number of pixels per bioregion with the area of each
coherent part.</p>
<p>The spatial coherence is expressed in percentage, and has the
following formula:</p>
<p><span class="math display">\[SC_j = 100 \times
\frac{LargestPatch_j}{Area_j}\]</span></p>
<p>where <span class="math inline">\(j\)</span> is a bioregion.</p>
<p>Here is an example with the vegetation dataset.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Spatial coherence</span></span>
<span><span class="va">vegedissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">vegemat</span><span class="op">)</span></span>
<span><span class="va">hclu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span>dissimilarity <span class="op">=</span> <span class="va">vegedissim</span>, n_clust <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">vegemap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_bioregions.html">map_bioregions</a></span><span class="op">(</span><span class="va">hclu</span>, <span class="va">vegesf</span>, write_clusters <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/bioregion_metrics.html">bioregion_metrics</a></span><span class="op">(</span>bioregionalization <span class="op">=</span> <span class="va">hclu</span>, comat <span class="op">=</span> <span class="va">vegemat</span>, map <span class="op">=</span> <span class="va">vegemap</span>,</span>
<span>col_bioregion <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   Bioregion Site_number Species_number Endemics Percentage_Endemic Coherence</span></span>
<span><span class="co">## 1         2         128           2527       90           3.561535  49.21875</span></span>
<span><span class="co">## 2         1         169           2983       45           1.508548  56.21302</span></span>
<span><span class="co">## 3         4         298           2936       56           1.907357  98.99329</span></span>
<span><span class="co">## 4         3         120           2262       67           2.961981  79.16667</span></span></code></pre>
<p>The bioregion 4 is almost constituted of one homogeneous block, which
is why the spatial coherence is very close to 100 %.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">vegemap</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">K_4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="st">"Bioregion"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a5_2_summary_metrics_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">5. References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="1">
<div id="ref-Caceres2009" class="csl-entry">
De Cáceres M &amp; Legendre P (2009) Associations between species and
groups of sites: Indices and statistical inference. <em>Ecology</em> 90,
3566–3574.
</div>
<div id="ref-Denelle2020" class="csl-entry">
Denelle P, Violle C &amp; Munoz F (2020) Generalist plants are more
competitive and more functionally similar to each other than specialist
plants: Insights from network analyses. <em>Journal of Biogeography</em>
47, 1922–1933.
</div>
<div id="ref-Divisek2016" class="csl-entry">
Divíšek J, Storch D, Zelený D &amp; Culek M (2016) Towards the spatial
coherence of biogeographical regionalizations at subcontinental and
landscape scales. <em>Journal of biogeography</em> 43, 2489–2501.
</div>
<div id="ref-Lenormand2019" class="csl-entry">
Lenormand M, Papuga G, Argagnon O, Soubeyrand M, Alleaume S &amp; Luque
S (2019) Biogeographical network analysis of plant species distribution
in the mediterranean region. <em>Ecology and evolution</em> 9, 237–250.
</div>
<div id="ref-Rousseeuw1987" class="csl-entry">
Rousseeuw PJ (1987) Silhouettes: <span>A</span> graphical aid to the
interpretation and validation of cluster analysis. <em>Journal of
Computational and Applied Mathematics</em> 20, 53–65.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
