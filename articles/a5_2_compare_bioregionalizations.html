<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5.2 Compare bioregionalizations • bioregion</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5.2 Compare bioregionalizations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications">
<li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>5.2 Compare bioregionalizations</h1>
                        <h4 data-toc-skip class="author">Pierre Denelle,
Boris Leroy and Maxime Lenormand</h4>
            
            <h4 data-toc-skip class="date">2025-07-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/vignettes/a5_2_compare_bioregionalizations.Rmd" class="external-link"><code>vignettes/a5_2_compare_bioregionalizations.Rmd</code></a></small>
      <div class="d-none name"><code>a5_2_compare_bioregionalizations.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we aim at comparing the assignment of sites into
different bioregions across multiple bioregionalizations, using the
function <code><a href="../reference/compare_bioregionalizations.html">compare_bioregionalizations()</a></code>.</p>
<div class="section level2">
<h2 id="data">1. Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>We use the vegetation dataset that comes with
<code>bioregion</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vegedf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"vegemat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculation of (dis)similarity matrices</span></span>
<span><span class="va">vegedissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">vegemat</span>, metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vegesim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity_to_similarity.html">dissimilarity_to_similarity</a></span><span class="op">(</span><span class="va">vegedissim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bioregionalization">2. Bioregionalization<a class="anchor" aria-label="anchor" href="#bioregionalization"></a>
</h2>
<p>We use the same three bioregionalization algorithms as in the <a href="https://biorgeo.github.io/bioregion/articles/a5_visualization.html" class="external-link">visualization
vignette</a>, i.e. a non-hierarchical, hierarchical and network
bioregionalizations.<br>
We chose 3 bioregions for the non-hierarchical and hierarchical
bioregionalizations. <br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Non hierarchical bioregionalization</span></span>
<span><span class="va">vege_nhclu_kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nhclu_kmeans.html">nhclu_kmeans</a></span><span class="op">(</span><span class="va">vegedissim</span>, n_clust <span class="op">=</span> <span class="fl">3</span>, index <span class="op">=</span> <span class="st">"Simpson"</span><span class="op">)</span></span>
<span><span class="va">vege_nhclu_kmeans</span><span class="op">$</span><span class="va">cluster_info</span> <span class="co"># 3</span></span></code></pre></div>
<pre><code><span><span class="co">##     partition_name n_clust</span></span>
<span><span class="co">## K_3            K_3       3</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hierarchical bioregionalization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">vege_hclu_hierarclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hclu_hierarclust.html">hclu_hierarclust</a></span><span class="op">(</span>dissimilarity <span class="op">=</span> <span class="va">vegedissim</span>,</span>
<span>                                          method <span class="op">=</span> <span class="st">"mcquitty"</span>, n_clust <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                          optimal_tree_method <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span>
<span><span class="va">vege_hclu_hierarclust</span><span class="op">$</span><span class="va">cluster_info</span> <span class="co"># 3</span></span></code></pre></div>
<pre><code><span><span class="co">##   partition_name n_clust requested_n_clust output_cut_height</span></span>
<span><span class="co">## 1            K_3       3                 3             0.625</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Network bioregionalization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">vege_netclu_walktrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netclu_walktrap.html">netclu_walktrap</a></span><span class="op">(</span><span class="va">vegesim</span>,</span>
<span>                                        index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vegesim</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vege_netclu_walktrap</span><span class="op">$</span><span class="va">cluster_info</span> <span class="co"># 3</span></span></code></pre></div>
<pre><code><span><span class="co">##     partition_name n_clust</span></span>
<span><span class="co">## K_3            K_3       3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="compare-the-bioregionalizations">3. Compare the bioregionalizations<a class="anchor" aria-label="anchor" href="#compare-the-bioregionalizations"></a>
</h2>
<p>Before comparing the bioregionalizations, we build a common
<code>data.frame</code> containing the three distinct
bioregionalizations. <br></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">vege_hclu_hierarclust</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span>                         <span class="va">vege_netclu_walktrap</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span>                         by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"K_3_hclu"</span>, <span class="st">"K_3_netclu"</span><span class="op">)</span></span>
<span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">comp</span>,</span>
<span>                         <span class="va">vege_nhclu_kmeans</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span>                         by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"K_3_hclu"</span>, <span class="st">"K_3_netclu"</span>, <span class="st">"K_3_nhclu"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     ID K_3_hclu K_3_netclu K_3_nhclu</span></span>
<span><span class="co">## 1  512        1          1         1</span></span>
<span><span class="co">## 2  799        1          3         1</span></span>
<span><span class="co">## 3  375        2          1         2</span></span>
<span><span class="co">## 4  476        2          1         2</span></span>
<span><span class="co">## 5  971        1          3         1</span></span>
<span><span class="co">## 6 1282        1          3         1</span></span></code></pre>
<p>We can now run the function
<code><a href="../reference/compare_bioregionalizations.html">compare_bioregionalizations()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hclu_vs_netclu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_bioregionalizations.html">compare_bioregionalizations</a></span><span class="op">(</span></span>
<span>  bioregionalizations <span class="op">=</span> <span class="va">comp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K_3_hclu"</span>, <span class="st">"K_3_netclu"</span>, <span class="st">"K_3_nhclu"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  store_pairwise_membership <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cor_frequency <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  store_confusion_matrix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">hclu_vs_netclu</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 7</span></span>
<span><span class="co">##  $ args                         :List of 4</span></span>
<span><span class="co">##   ..$ indices                  : chr [1:2] "rand" "jaccard"</span></span>
<span><span class="co">##   ..$ cor_frequency            : logi TRUE</span></span>
<span><span class="co">##   ..$ store_pairwise_membership: logi TRUE</span></span>
<span><span class="co">##   ..$ store_confusion_matrix   : logi TRUE</span></span>
<span><span class="co">##  $ inputs                       : Named int [1:2] 715 3</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:2] "number_items" "number_bioregionalizations"</span></span>
<span><span class="co">##  $ pairwise_membership          : logi [1:255255, 1:3] TRUE FALSE FALSE TRUE TRUE TRUE ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:255255] "1_2" "1_3" "1_4" "1_5" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:3] "K_3_hclu" "K_3_netclu" "K_3_nhclu"</span></span>
<span><span class="co">##  $ freq_item_pw_membership      : Named num [1:255255] 2 1 1 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:255255] "1_2" "1_3" "1_4" "1_5" ...</span></span>
<span><span class="co">##  $ bioregionalization_freq_cor  : Named num [1:3] 0.851 0.737 0.893</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:3] "K_3_hclu" "K_3_netclu" "K_3_nhclu"</span></span>
<span><span class="co">##  $ confusion_matrix             :List of 3</span></span>
<span><span class="co">##   ..$ K_3_hclu%K_3_netclu : Named int [1:4] 63316 41892 36800 113247</span></span>
<span><span class="co">##   .. ..- attr(*, "names")= chr [1:4] "a" "b" "c" "d"</span></span>
<span><span class="co">##   ..$ K_3_hclu%K_3_nhclu  : Named int [1:4] 85543 19665 11248 138799</span></span>
<span><span class="co">##   .. ..- attr(*, "names")= chr [1:4] "a" "b" "c" "d"</span></span>
<span><span class="co">##   ..$ K_3_netclu%K_3_nhclu: Named int [1:4] 66314 33802 30477 124662</span></span>
<span><span class="co">##   .. ..- attr(*, "names")= chr [1:4] "a" "b" "c" "d"</span></span>
<span><span class="co">##  $ bioregionalization_comparison:'data.frame':   3 obs. of  3 variables:</span></span>
<span><span class="co">##   ..$ bioregionalization_comparison: chr [1:3] "K_3_hclu%K_3_netclu" "K_3_hclu%K_3_nhclu" "K_3_netclu%K_3_nhclu"</span></span>
<span><span class="co">##   ..$ rand                         : num [1:3] 0.692 0.879 0.748</span></span>
<span><span class="co">##   ..$ jaccard                      : num [1:3] 0.446 0.735 0.508</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:2] "bioregion.bioregionalization.comparison" "list"</span></span></code></pre>
<p><code><a href="../reference/compare_bioregionalizations.html">compare_bioregionalizations()</a></code> produces several outputs
which: - look within each bioregionalization how sites are assigned to
bioregions - compare different bioregionalizations by analysing whether
they produce similar pairwise memberships</p>
<p>Let’s first look at pairwise membership within
bioregionalization.</p>
<div class="section level3">
<h3 id="pairwise-membership">3.1 Pairwise membership<a class="anchor" aria-label="anchor" href="#pairwise-membership"></a>
</h3>
<p>The number of pairwise combinations for <span class="math inline">\(n\)</span> sites equals <span class="math inline">\(n(n-1)/2\)</span>. So in our case, where we have
715 sites, we do end up with 2.55255^{5} pairwise combinations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">pairwise_membership</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Pairwise memberships look for each pairs of site whether they are
assigned to the same or to a different bioregion. Let’s look at the
sites 1 and 9 across the different bioregionalization:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    ID K_3_hclu K_3_netclu K_3_nhclu</span></span>
<span><span class="co">## 1 512        1          1         1</span></span>
<span><span class="co">## 9 948        1          3         1</span></span></code></pre>
<p>We can see that the sites 1 and 9 are classified in the same
bioregion in the first two bioregionalizations, but not in the third
one.<br>
The <code>$pairwise_membership</code> output of
<code><a href="../reference/compare_bioregionalizations.html">compare_bioregionalizations()</a></code> shows this as a
<code>TRUE/FALSE</code> statement.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">pairwise_membership</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##      K_3_hclu K_3_netclu K_3_nhclu</span></span>
<span><span class="co">## 1_9      TRUE      FALSE      TRUE</span></span>
<span><span class="co">## 1_10     TRUE      FALSE      TRUE</span></span>
<span><span class="co">## 1_11     TRUE      FALSE      TRUE</span></span></code></pre>
<p>The number of times each pair of sites are clustered together
(i.e. the sum of rows of the table in <code>$pairwise_membership</code>)
is available in the <code>$freq_item_pw_membership</code> output:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">freq_item_pw_membership</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 1_2 1_9 </span></span>
<span><span class="co">##   2   2</span></span></code></pre>
<p>The sites 1 and 2 were never classified in the same bioregion across
the three bioregionalizations. Sites 1 and 9 were classified in the same
bioregion in two bioregionalizations. If we look at the total
frequencies:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">freq_item_pw_membership</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##      0      1      2      3 </span></span>
<span><span class="co">## 111723  41539  45403  56590</span></span></code></pre>
<p>we see that the most dominant situation is when sites are never
assigned to the same bioregion.</p>
</div>
<div class="section level3">
<h3 id="confusion-matrix">3.2 Confusion matrix<a class="anchor" aria-label="anchor" href="#confusion-matrix"></a>
</h3>
<p>The confusion matrix allows to compare different bioregionalizations
by looking at the similarity of their pairwise memberships. To do so,
the function computes a confusion matrix with four elements:</p>
<p>. <span class="math inline">\(a\)</span> number of pairs of sites
grouped in bioregionalization 1 and in bioregionalization 2 . <span class="math inline">\(b\)</span> number of pairs of sites grouped in
bioregionalization 1 but not in bioregionalization 2 . <span class="math inline">\(c\)</span> number of pairs of sites not grouped in
bioregionalization 1 but grouped in bioregionalization 2 . <span class="math inline">\(d\)</span> number of pairs of sites not grouped in
both bioregionalization 1 &amp; 2</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">confusion_matrix</span></span></code></pre></div>
<pre><code><span><span class="co">## $`K_3_hclu%K_3_netclu`</span></span>
<span><span class="co">##      a      b      c      d </span></span>
<span><span class="co">##  63316  41892  36800 113247 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`K_3_hclu%K_3_nhclu`</span></span>
<span><span class="co">##      a      b      c      d </span></span>
<span><span class="co">##  85543  19665  11248 138799 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`K_3_netclu%K_3_nhclu`</span></span>
<span><span class="co">##      a      b      c      d </span></span>
<span><span class="co">##  66314  33802  30477 124662</span></span></code></pre>
<p>Based on the confusion matrices, we can compute a range of indices to
indicate the agreement among bioregionalizations. As of now, we have
implemented:<br><br><em>Rand index</em> <span class="math inline">\((a+d)/(a+b+c+d)\)</span> The Rand index measures
agreement among bioregionalizations by accounting for both the pairs of
sites that are grouped, but also the pairs of sites that are not
grouped.<br><br><em>Jaccard index </em> <span class="math inline">\(a/(a+b+c)\)</span> The Jaccard index measures
agreement among bioregionalizations by only accounting for pairs of
sites that are grouped.</p>
<p>These two metrics are complementary, because the Jaccard index will
tell if bioregionalizations are similar in their clustering structure,
whereas the Rand index will tell if bioregionalizations are similar not
only in the pairs of items clustered together, but also in terms of the
pairs of sites that are not clustered together. For example, take two
bioregionalizations which never group together the same pairs of sites.
Their Jaccard index will be 0, whereas the Rand index can be &gt; 0 due
to the sites that are not grouped together.</p>
<p>Additional indices can be manually computed by the users on the basis
of the list of confusion matrices.</p>
<p>In some cases, users may be interested in finding which of the
bioregionalizations is most representative of all bioregionalizations To
find it out, we can compare the pairwise membership of each
bioregionalization with the total frequency of pairwise membership
across all bioregionalizations. This correlation can be requested with
<code>cor_frequency = TRUE</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hclu_vs_netclu</span><span class="op">$</span><span class="va">bioregionalization_freq_cor</span></span></code></pre></div>
<pre><code><span><span class="co">##   K_3_hclu K_3_netclu  K_3_nhclu </span></span>
<span><span class="co">##  0.8507872  0.7365956  0.8934004</span></span></code></pre>
<p>Here the third bioregionalization is the most representative of all
bioregionalizations.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
