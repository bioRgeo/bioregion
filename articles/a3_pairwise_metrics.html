<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Pairwise similarity/dissimilarity metrics • bioregion</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Pairwise similarity/dissimilarity metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioregion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bioregion.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/a1_install_binary_files.html">1. Installation of the binary files</a></li>
    <li><a class="dropdown-item" href="../articles/a2_matrix_and_network_formats.html">2. Matrix and network formats</a></li>
    <li><a class="dropdown-item" href="../articles/a3_pairwise_metrics.html">3. Pairwise similarity/dissimilarity metrics</a></li>
    <li><a class="dropdown-item" href="../articles/a4_1_hierarchical_clustering.html">4.1 Hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_2_non_hierarchical_clustering.html">4.2 Non-hierarchical clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_3_network_clustering.html">4.3 Network clustering</a></li>
    <li><a class="dropdown-item" href="../articles/a4_4_microbenchmark.html">4.4 Microbenchmark</a></li>
    <li><a class="dropdown-item" href="../articles/a5_1_visualization.html">5.1 Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/a5_2_compare_bioregionalizations.html">5.2 Compare bioregionalizations</a></li>
    <li><a class="dropdown-item" href="../articles/a5_3_summary_metrics.html">5.3 Summary metrics</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications">
<li><a class="dropdown-item" href="../articles/citations.html">Citing articles</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bioRgeo/bioregion/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bioRgeo/bioregion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>3. Pairwise similarity/dissimilarity metrics</h1>
                        <h4 data-toc-skip class="author">Maxime
Lenormand, Boris Leroy and Pierre Denelle</h4>
            
            <h4 data-toc-skip class="date">2025-05-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bioRgeo/bioregion/blob/master/vignettes/a3_pairwise_metrics.Rmd" class="external-link"><code>vignettes/a3_pairwise_metrics.Rmd</code></a></small>
      <div class="d-none name"><code>a3_pairwise_metrics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="compute-pairwise-similarity-metrics">Compute pairwise similarity metrics<a class="anchor" aria-label="anchor" href="#compute-pairwise-similarity-metrics"></a>
</h2>
<p>The function <a href="https://bioRgeo.github.io/bioregion/reference/similarity.html">similarity</a>
computes well-known and customized pairwise similarity metrics based on
a co-occurrence <code>matrix</code>, such as <a href="https://biorgeo.github.io/bioregion/reference/vegemat.html" class="external-link">vegemat</a>.
In the example below, the <code>Simpson</code> similarity index is
computed between each pair of sites.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.html">similarity</a></span><span class="op">(</span><span class="va">vegemat</span>, </span>
<span>                  metric <span class="op">=</span> <span class="st">"Simpson"</span>, </span>
<span>                  formula <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                  method <span class="op">=</span> <span class="st">"prodmat"</span><span class="op">)</span></span>
<span><span class="va">sim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of similarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of similarity metrics:  1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2   Simpson</span></span>
<span><span class="co">## 2     35    36 0.9767442</span></span>
<span><span class="co">## 3     35    37 0.9689922</span></span>
<span><span class="co">## 4     35    38 0.9457364</span></span>
<span><span class="co">## 5     35    39 0.9457364</span></span>
<span><span class="co">## 6     35    84 0.2790698</span></span>
<span><span class="co">## 7     35    85 0.9147287</span></span>
<span><span class="co">## 8     35    86 1.0000000</span></span>
<span><span class="co">## 9     35    87 0.9922481</span></span>
<span><span class="co">## 10    35    88 0.9844961</span></span>
<span><span class="co">## 11    35    89 0.6821705</span></span></code></pre>
<p>The resulting <code>data.frame</code> is stored in a
<code>bioregion.pairwise.metric</code> object, which contains the
Simpson similarity metric between each pair of sites. The function <a href="https://bioRgeo.github.io/bioregion/reference/similarity.html">similarity</a>
can handle three types of metrics: metrics based on <code>abc</code>,
metrics based on <code>ABC</code>, and one metric based on the Euclidean
distance.</p>
<p>The first kind of metrics such as Jaccard, the turnover component of
Jaccard <span class="citation">(Baselga, 2012)</span>, Simpson or
Sørensen are based on presence data with <span class="math inline">\(a\)</span> the number of species shared by a pair
of sites, <span class="math inline">\(b\)</span> species only present in
the first site and <span class="math inline">\(c\)</span> species only
present in the second site.</p>
<p><span class="math display">\[\displaystyle Jaccard = 1 - \frac{b +
c}{a + b + c}\]</span> <span class="math display">\[\displaystyle
Jaccardturn = 1 - \frac{2 \cdot min(b, c)}{a + 2 \cdot min(b,
c)}\]</span> <span class="math display">\[\displaystyle Sorensen = 1 -
\frac{b + c}{2 \cdot a + b + c}\]</span> <span class="math display">\[\displaystyle Simpson = 1 - \frac{min(b, c)}{a +
min(b, c)}\]</span> Two methods can be used to compute the
<code>abc</code> based metrics. The first method is based on a matrix
product (performed with the <a href="https://www.rdocumentation.org/packages/Matrix/versions/1.5-1/topics/matrix-products" class="external-link">tcrossprod</a>
function from the R package <a href="https://www.rdocumentation.org/packages/Matrix/versions/1.5-1" class="external-link">Matrix</a>).
The method is fast but is greedy in memory… The second method is based
on a <a href="https://github.com/bioRgeo/bioregion/blob/master/src/abc.cpp" class="external-link">three
loops function</a> coded in C++ and largely inspired by the <a href="https://www.rdocumentation.org/packages/ecodist/versions/2.0.9/topics/bcdist" class="external-link">bcdist</a>
function from the R package <a href="https://www.rdocumentation.org/packages/ecodist/versions/2.0.9" class="external-link">ecodist</a>
(version 2.0.7). It is less efficient than the matrix product but allows
to handle co-occurrence matrix with a large number of sites and/or
species.</p>
<p>The second kind of metrics such as Bray-Curtis and the turnover
component of Bray-Curtis <span class="citation">(Baselga, 2012)</span>
are based on abundance data with <span class="math inline">\(A\)</span>
the sum of the lesser values for common species shared by a pair of
sites. <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> are the total number of specimens
counted at both sites minus <span class="math inline">\(A\)</span>. Only
three loops function is available for the <code>ABC</code> based
metrics.</p>
<p><span class="math display">\[\displaystyle Bray = 1 - \frac{B + C}{2
\cdot A + B + C}\]</span> <span class="math display">\[\displaystyle
Brayturn = 1 - \frac{min(B, C)}{A + min(B, C)}\]</span></p>
<p>The main advantage of the <a href="https://bioRgeo.github.io/bioregion/reference/similarity.html">similarity</a>
function is to compute and return several metrics, to allow the
computation of customized metric with the <code>formula</code> argument
and to include the possibility of returning the quantities <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
and <span class="math inline">\(c\)</span> and/or <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>
and <span class="math inline">\(C\)</span>. This feature is particularly
interesting to compute similarity metrics on large co-occurrence
matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.html">similarity</a></span><span class="op">(</span><span class="va">vegemat</span>, </span>
<span>                  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>,<span class="st">"ABC"</span>,<span class="st">"Simpson"</span>,<span class="st">"Bray"</span><span class="op">)</span>, </span>
<span>                  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 - pmin(b,c) / (a + pmin(b,c))"</span>, <span class="st">"1 - (B + C) / (2*A + B + C)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of similarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of similarity metrics:  4 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2   Simpson       Bray   a  b   c   A   B     C</span></span>
<span><span class="co">## 2     35    36 0.9767442 0.01901485 126  3 741 420   3 43333</span></span>
<span><span class="co">## 3     35    37 0.9689922 0.03745203 125  4 534 366  57 18756</span></span>
<span><span class="co">## 4     35    38 0.9457364 0.04025289 122  7 440 347  76 16471</span></span>
<span><span class="co">## 5     35    39 0.9457364 0.09754761 122  7 501 356  67  6520</span></span>
<span><span class="co">## 6     35    84 0.2790698 0.18757921  36 93 177  74 349   292</span></span>
<span><span class="co">## 7     35    85 0.9147287 0.13256181 118 11 614 378  45  4902</span></span>
<span><span class="co">## 8     35    86 1.0000000 0.02663928 129  0 753 415   8 30319</span></span>
<span><span class="co">## 9     35    87 0.9922481 0.02332663 128  1 909 406  17 33981</span></span>
<span><span class="co">## 10    35    88 0.9844961 0.02198536 127  2 812 395  28 35115</span></span>
<span><span class="co">## 11    35    89 0.6821705 0.15954416  88 41 177 196 227  1838</span></span>
<span><span class="co">##    1 - pmin(b,c) / (a + pmin(b,c)) 1 - (B + C) / (2*A + B + C)</span></span>
<span><span class="co">## 2                        0.9767442                  0.01901485</span></span>
<span><span class="co">## 3                        0.9689922                  0.03745203</span></span>
<span><span class="co">## 4                        0.9457364                  0.04025289</span></span>
<span><span class="co">## 5                        0.9457364                  0.09754761</span></span>
<span><span class="co">## 6                        0.2790698                  0.18757921</span></span>
<span><span class="co">## 7                        0.9147287                  0.13256181</span></span>
<span><span class="co">## 8                        1.0000000                  0.02663928</span></span>
<span><span class="co">## 9                        0.9922481                  0.02332663</span></span>
<span><span class="co">## 10                       0.9844961                  0.02198536</span></span>
<span><span class="co">## 11                       0.6821705                  0.15954416</span></span></code></pre>
<p>It is also possible to compute Euclidean similarity between each pair
of sites following this equation:</p>
<p><span class="math display">\[\displaystyle Euclidean = \frac{1}{1 +
d_{ij}}\]</span> where <span class="math inline">\(d_{ij}\)</span> is
the Euclidean distance between site <span class="math inline">\(i\)</span> and site <span class="math inline">\(j\)</span> in terms of species composition.</p>
</div>
<div class="section level2">
<h2 id="compute-pairwise-dissimilarity-metrics">Compute pairwise dissimilarity metrics<a class="anchor" aria-label="anchor" href="#compute-pairwise-dissimilarity-metrics"></a>
</h2>
<p>The <a href="https://bioRgeo.github.io/bioregion/reference/dissimilarity.html">dissimilarity</a>
function is very similar, with the sole exception that it computes the
dissimilarity version of the available metrics. It corresponds to 1
minus the similarity metrics, except for the Euclidean dissimilarity,
which corresponds to the Euclidean distance (i.e. <span class="math inline">\(d_{ij}\)</span>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">vegemat</span>, </span>
<span>                        metric <span class="op">=</span> <span class="st">"Sorensen"</span>, </span>
<span>                        formula <span class="op">=</span> <span class="st">"(b + c) / (2*a + b + c)"</span><span class="op">)</span></span>
<span><span class="va">dissim</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of dissimilarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of dissimilarity metrics:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2  Sorensen (b + c) / (2*a + b + c)</span></span>
<span><span class="co">## 2     35    36 0.7469880               0.7469880</span></span>
<span><span class="co">## 3     35    37 0.6827411               0.6827411</span></span>
<span><span class="co">## 4     35    38 0.6468886               0.6468886</span></span>
<span><span class="co">## 5     35    39 0.6755319               0.6755319</span></span>
<span><span class="co">## 6     35    84 0.7894737               0.7894737</span></span>
<span><span class="co">## 7     35    85 0.7259001               0.7259001</span></span>
<span><span class="co">## 8     35    86 0.7448071               0.7448071</span></span>
<span><span class="co">## 9     35    87 0.7804460               0.7804460</span></span>
<span><span class="co">## 10    35    88 0.7621723               0.7621723</span></span>
<span><span class="co">## 11    35    89 0.5532995               0.5532995</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="from-similarity-to-dissimilarity-and-back-again">From similarity to dissimilarity (and back again)<a class="anchor" aria-label="anchor" href="#from-similarity-to-dissimilarity-and-back-again"></a>
</h2>
<p>The functions <a href="https://bioRgeo.github.io/bioregion/reference/dissimilarity_to_similarity.html">similarity_to_dissimilarity</a>
and <a href="https://bioRgeo.github.io/bioregion/reference/dissimilarity_to_similarity.html">dissimilarity_to_similarity</a>
and can be used to switch easily switch between similarity and
dissimilarity metrics.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.html">similarity</a></span><span class="op">(</span><span class="va">vegemat</span>, </span>
<span>                  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>,<span class="st">"Sorensen"</span><span class="op">)</span>, </span>
<span>                  formula <span class="op">=</span> <span class="st">"1 - (b + c) / (2*a + b + c)"</span><span class="op">)</span></span>
<span><span class="va">sim1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of similarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of similarity metrics:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2  Sorensen   a  b   c 1 - (b + c) / (2*a + b + c)</span></span>
<span><span class="co">## 2     35    36 0.2530120 126  3 741                   0.2530120</span></span>
<span><span class="co">## 3     35    37 0.3172589 125  4 534                   0.3172589</span></span>
<span><span class="co">## 4     35    38 0.3531114 122  7 440                   0.3531114</span></span>
<span><span class="co">## 5     35    39 0.3244681 122  7 501                   0.3244681</span></span>
<span><span class="co">## 6     35    84 0.2105263  36 93 177                   0.2105263</span></span>
<span><span class="co">## 7     35    85 0.2740999 118 11 614                   0.2740999</span></span>
<span><span class="co">## 8     35    86 0.2551929 129  0 753                   0.2551929</span></span>
<span><span class="co">## 9     35    87 0.2195540 128  1 909                   0.2195540</span></span>
<span><span class="co">## 10    35    88 0.2378277 127  2 812                   0.2378277</span></span>
<span><span class="co">## 11    35    89 0.4467005  88 41 177                   0.4467005</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dissim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">vegemat</span>, </span>
<span>                         metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"abc"</span>,<span class="st">"Sorensen"</span><span class="op">)</span>, </span>
<span>                         formula <span class="op">=</span> <span class="st">"(b + c) / (2*a + b + c)"</span><span class="op">)</span></span>
<span><span class="va">dissim1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of dissimilarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of dissimilarity metrics:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2  Sorensen   a  b   c (b + c) / (2*a + b + c)</span></span>
<span><span class="co">## 2     35    36 0.7469880 126  3 741               0.7469880</span></span>
<span><span class="co">## 3     35    37 0.6827411 125  4 534               0.6827411</span></span>
<span><span class="co">## 4     35    38 0.6468886 122  7 440               0.6468886</span></span>
<span><span class="co">## 5     35    39 0.6755319 122  7 501               0.6755319</span></span>
<span><span class="co">## 6     35    84 0.7894737  36 93 177               0.7894737</span></span>
<span><span class="co">## 7     35    85 0.7259001 118 11 614               0.7259001</span></span>
<span><span class="co">## 8     35    86 0.7448071 129  0 753               0.7448071</span></span>
<span><span class="co">## 9     35    87 0.7804460 128  1 909               0.7804460</span></span>
<span><span class="co">## 10    35    88 0.7621723 127  2 812               0.7621723</span></span>
<span><span class="co">## 11    35    89 0.5532995  88 41 177               0.5532995</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dissim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity_to_dissimilarity.html">similarity_to_dissimilarity</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span></span>
<span><span class="va">dissim2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of dissimilarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of dissimilarity metrics:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2  Sorensen   a  b   c 1 - (b + c) / (2*a + b + c)</span></span>
<span><span class="co">## 2     35    36 0.7469880 126  3 741                   0.7469880</span></span>
<span><span class="co">## 3     35    37 0.6827411 125  4 534                   0.6827411</span></span>
<span><span class="co">## 4     35    38 0.6468886 122  7 440                   0.6468886</span></span>
<span><span class="co">## 5     35    39 0.6755319 122  7 501                   0.6755319</span></span>
<span><span class="co">## 6     35    84 0.7894737  36 93 177                   0.7894737</span></span>
<span><span class="co">## 7     35    85 0.7259001 118 11 614                   0.7259001</span></span>
<span><span class="co">## 8     35    86 0.7448071 129  0 753                   0.7448071</span></span>
<span><span class="co">## 9     35    87 0.7804460 128  1 909                   0.7804460</span></span>
<span><span class="co">## 10    35    88 0.7621723 127  2 812                   0.7621723</span></span>
<span><span class="co">## 11    35    89 0.5532995  88 41 177                   0.5532995</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity_to_similarity.html">dissimilarity_to_similarity</a></span><span class="op">(</span><span class="va">dissim1</span><span class="op">)</span></span>
<span><span class="va">sim2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Data.frame of similarity between sites</span></span>
<span><span class="co">##  - Total number of sites:  715 </span></span>
<span><span class="co">##  - Total number of species:  3697 </span></span>
<span><span class="co">##  - Number of rows:  255255 </span></span>
<span><span class="co">##  - Number of similarity metrics:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Site1 Site2  Sorensen   a  b   c (b + c) / (2*a + b + c)</span></span>
<span><span class="co">## 2     35    36 0.2530120 126  3 741               0.2530120</span></span>
<span><span class="co">## 3     35    37 0.3172589 125  4 534               0.3172589</span></span>
<span><span class="co">## 4     35    38 0.3531114 122  7 440               0.3531114</span></span>
<span><span class="co">## 5     35    39 0.3244681 122  7 501               0.3244681</span></span>
<span><span class="co">## 6     35    84 0.2105263  36 93 177               0.2105263</span></span>
<span><span class="co">## 7     35    85 0.2740999 118 11 614               0.2740999</span></span>
<span><span class="co">## 8     35    86 0.2551929 129  0 753               0.2551929</span></span>
<span><span class="co">## 9     35    87 0.2195540 128  1 909               0.2195540</span></span>
<span><span class="co">## 10    35    88 0.2378277 127  2 812               0.2378277</span></span>
<span><span class="co">## 11    35    89 0.4467005  88 41 177               0.4467005</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="comparison-with-other-r-packages">Comparison with other R packages<a class="anchor" aria-label="anchor" href="#comparison-with-other-r-packages"></a>
</h2>
<p><code>bioregion</code> is not the only R package that allows the
computation of similarity, dissimilarity, distance, and <span class="math inline">\(\beta\)</span>-diversity metrics based on a
(site-species) co-occurrence <code>matrix</code>. In this section, we
focus on several functions provided by the packages <a href="https://cran.r-project.org/package=adespatial" class="external-link">adespatial</a>, <a href="https://cran.r-project.org/package=betapart" class="external-link">betapart</a>, <a href="https://cran.r-project.org/package=ecodist" class="external-link">ecodist</a>, and <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a>.</p>
<p>The table below displays the main differences between these packages
in terms of dissimilarity metric computation. The <code>bioregion</code>
package is the only one that allows the computation of several metrics
returned as a <code>data.frame</code> in a network format. It also
supports the use of custom formulas based on the <code>a</code>,
<code>b</code>, <code>c</code>, <code>A</code>, <code>B</code> and
<code>C</code> components. This flexibility is also available in <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> via the
<code>designdist</code> function.</p>
<p><code>bioregion</code> also allows the computation of the
<code>a</code>, <code>b</code>, <code>c</code>, <code>A</code>,
<code>B</code> and <code>C</code> components. Users can choose to
extract none of the components, only the three <code>abc</code>
components, only the three <code>ABC</code> components, or all six
components. These components (<code>abc</code> or <code>ABC</code>
separately) can also be accessed in <a href="https://cran.r-project.org/package=adespatial" class="external-link">adespatial</a>
using the <code>beta.div.comp</code> function, and in <a href="https://cran.r-project.org/package=betapart" class="external-link">betapart</a> using
<code>betapart.core</code> and <code>betapart.core.abund</code>.
Finally, the <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> package, via
the <code>designdist</code> function, also allows the extraction of the
<code>a</code>, <code>b</code>, <code>c</code>, <code>A</code>,
<code>B</code> or <code>C</code> components separately.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="17%">
<col width="12%">
<col width="21%">
<col width="15%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>adespatial (0.3-28)</th>
<th>betapart (1.6)</th>
<th>bioregion (1.2.0)</th>
<th>ecodist (2.1.3)</th>
<th>vegan (2.6-10)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Format</strong></td>
<td>matrix</td>
<td>matrix</td>
<td>data.frame (network)</td>
<td>matrix</td>
<td>matrix</td>
</tr>
<tr class="even">
<td><strong>Custom formulas</strong></td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
</tr>
<tr class="odd">
<td><strong>abc/ABC</strong></td>
<td>yes (abc or ABC)</td>
<td>yes (abc or ABC)</td>
<td>yes (abc and ABC)</td>
<td>no</td>
<td>yes (a, b, c, A, B or C)</td>
</tr>
<tr class="even">
<td><strong>Several metrics</strong></td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="basic-comparison-jaccard-and-bray-curtis">Basic comparison (Jaccard and Bray-Curtis)<a class="anchor" aria-label="anchor" href="#basic-comparison-jaccard-and-bray-curtis"></a>
</h3>
<p>We first present a basic comparison of the computation of two
well-known metrics, Jaccard and Bray-Curtis, based on a small
co-occurrence <code>matrix</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nbsite</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nbsp</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">comat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nbsite</span><span class="op">*</span><span class="va">nbsp</span><span class="op">)</span>, <span class="va">nbsite</span>, <span class="va">nbsp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nbsite</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">comat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nbsp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comatbin</span> <span class="op">&lt;-</span> <span class="va">comat</span></span>
<span><span class="va">comatbin</span><span class="op">[</span><span class="va">comat</span> <span class="op">&gt;</span> <span class="fl">0.7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">comatbin</span><span class="op">[</span><span class="va">comat</span> <span class="op">&lt;=</span> <span class="fl">0.7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<div class="section level4">
<h4 id="jaccard">Jaccard<a class="anchor" aria-label="anchor" href="#jaccard"></a>
</h4>
<p>We propose below a comparison of computation time for generating a
Jaccard dissimilarity matrix based on the <code>comatbin</code> defined
above. It should be noted that the output of <code>beta.div</code> and
<code>dissimilarity</code>requires an additional step to obtain a
dissimilarity matrix. Specifically, <code>beta.div</code> returns the
root mean square of the desired quantity, and as shown above,
<code>dissimilarity</code> outputs the metric in a network
(<code>data.frame</code>) format, as it supports the computation of
multiple metrics.</p>
<p>The <code>beta.pair</code> function is used for the <a href="https://cran.r-project.org/package=betapart" class="external-link">betapart</a> package.
Two functions, <code>distance</code> and <code>bcdist</code>, are used
from the <a href="https://cran.r-project.org/package=ecodist" class="external-link">ecodist</a> package.
We also use the two available functions, <code>vegdist</code> and
<code>designdist</code>, from the <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> package.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comp_j</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  adespatial <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">beta.div</span><span class="op">(</span><span class="va">comatbin</span>, </span>
<span>                               method <span class="op">=</span> <span class="st">"jaccard"</span>,</span>
<span>                               samp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                               nperm <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               save.D <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span>                 <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span>
<span>                 <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">*</span><span class="va">d</span></span>
<span>                 <span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">}</span>,</span>
<span>  betapart <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">beta.pair</span><span class="op">(</span><span class="va">comatbin</span>, </span>
<span>                              index.family <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span></span>
<span>               <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">beta.jac</span><span class="op">)</span></span>
<span>               <span class="va">dissim</span><span class="op">$</span><span class="va">betapart</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">}</span>,</span>
<span>  bioregion <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comatbin</span>, </span>
<span>                                   metric <span class="op">=</span> <span class="st">"Jaccard"</span><span class="op">)</span></span>
<span>                <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/net_to_mat.html">net_to_mat</a></span><span class="op">(</span><span class="va">d</span>,   </span>
<span>                                weight <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                squared <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                symmetrical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                     <span class="va">dissim</span><span class="op">$</span><span class="va">bioregion</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  ecodist_dist <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">distance</span><span class="op">(</span><span class="va">comatbin</span>, </span>
<span>                                 method <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span></span>
<span>                   <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                   <span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_dist</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  ecodist_bcdist <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">bcdist</span><span class="op">(</span><span class="va">comatbin</span><span class="op">)</span></span>
<span>                     <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                     <span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_bcdist</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  vegan_veg <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">vegdist</span><span class="op">(</span><span class="va">comatbin</span>,</span>
<span>                             method <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span></span>
<span>                <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                <span class="va">dissim</span><span class="op">$</span><span class="va">vegan_veg</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  vegan_design <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">comatbin</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"(A+B-2*J)/(A+B-J)"</span>,</span>
<span>                                   terms <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span>                   <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                   <span class="va">dissim</span><span class="op">$</span><span class="va">vegan_design</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>                      </span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After ensuring that all the functions return the same dissimilarity
matrix,</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">betapart</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">bioregion</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_dist</span> , digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_bcdist</span> , digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">vegan_veg</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">vegan_design</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">all_identical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>we proceed with a comparison of their computation times.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_j</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: milliseconds</span></span>
<span><span class="co">##            expr        min         lq       mean     median         uq</span></span>
<span><span class="co">##      adespatial 272.218724 273.104897 278.303994 278.755109 280.762368</span></span>
<span><span class="co">##        betapart   1.746668   1.807250   1.880627   1.844174   1.895234</span></span>
<span><span class="co">##       bioregion  15.436869  15.518731  16.305045  16.151992  17.069373</span></span>
<span><span class="co">##    ecodist_dist 150.825151 156.296656 187.529010 160.610345 166.123441</span></span>
<span><span class="co">##  ecodist_bcdist   3.347312   3.615502   3.621953   3.648154   3.699570</span></span>
<span><span class="co">##       vegan_veg   1.293012   1.310715   2.070693   2.343516   2.363889</span></span>
<span><span class="co">##    vegan_design   1.334678   1.419738   1.521514   1.444108   1.568846</span></span>
<span><span class="co">##         max neval</span></span>
<span><span class="co">##  286.051903    10</span></span>
<span><span class="co">##    2.249385    10</span></span>
<span><span class="co">##   17.606345    10</span></span>
<span><span class="co">##  427.788794    10</span></span>
<span><span class="co">##    3.835193    10</span></span>
<span><span class="co">##    2.700586    10</span></span>
<span><span class="co">##    2.046406    10</span></span></code></pre>
<p>On this very small example, the functions from <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> outperform the
others in terms of computation time. They are followed by
<code>bcdist</code> and <code>beta.pair</code>. Our
<code>dissimilarity</code> function performs slightly slower, partly due
to the additional reformatting step (from matrix to network and back).
The <code>distance</code> and <code>beta.div</code> functions rank
significantly lower in terms of speed.</p>
</div>
<div class="section level4">
<h4 id="bray-curtis">Bray-Curtis<a class="anchor" aria-label="anchor" href="#bray-curtis"></a>
</h4>
<p>We present below a similar example using the Bray-Curtis
dissimilarity metric, based on the <code>comat</code> defined above.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dissim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comp_bc</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  adespatial <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">beta.div</span><span class="op">(</span><span class="va">comat</span>, </span>
<span>                               method <span class="op">=</span> <span class="st">"percentdiff"</span>,</span>
<span>                               samp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                               nperm <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               save.D <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span>                 <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span>
<span>                 <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">*</span><span class="va">d</span></span>
<span>                 <span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">}</span>,</span>
<span>  betapart <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">beta.pair.abund</span><span class="op">(</span><span class="va">comat</span>, </span>
<span>                                    index.family <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span>               <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">beta.bray</span><span class="op">)</span></span>
<span>               <span class="va">dissim</span><span class="op">$</span><span class="va">betapart</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">}</span>,</span>
<span>  bioregion <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dissimilarity.html">dissimilarity</a></span><span class="op">(</span><span class="va">comatbin</span>, </span>
<span>                                    metric <span class="op">=</span> <span class="st">"Bray"</span><span class="op">)</span></span>
<span>                 <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/net_to_mat.html">net_to_mat</a></span><span class="op">(</span><span class="va">d</span>,   </span>
<span>                                 weight <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 squared <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 symmetrical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                 <span class="va">dissim</span><span class="op">$</span><span class="va">bioregion</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  ecodist_dist <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">distance</span><span class="op">(</span><span class="va">comat</span>, </span>
<span>                                 method <span class="op">=</span> <span class="st">"bray-curtis"</span><span class="op">)</span></span>
<span>                   <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                   <span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_dist</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  ecodist_bcdist <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">bcdist</span><span class="op">(</span><span class="va">comat</span><span class="op">)</span></span>
<span>                     <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                     <span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_bcdist</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  vegan_veg <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">vegdist</span><span class="op">(</span><span class="va">comatbin</span>,</span>
<span>                             method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span>                <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                <span class="va">dissim</span><span class="op">$</span><span class="va">vegan_veg</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>  vegan_design <span class="op">=</span> <span class="op">{</span> <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">designdist</span><span class="op">(</span><span class="va">comat</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"(A+B-2*J)/(A+B)"</span>,</span>
<span>                                   terms <span class="op">=</span> <span class="st">"minimum"</span><span class="op">)</span></span>
<span>                   <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>                   <span class="va">dissim</span><span class="op">$</span><span class="va">vegan_design</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">}</span>,</span>
<span>                      </span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here again after ensuring that all the functions return the same
dissimilarity matrix,</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">betapart</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">bioregion</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_dist</span> , digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">ecodist_bcdist</span> , digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">vegan_veg</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">adespatial</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="va">dissim</span><span class="op">$</span><span class="va">vegan_design</span>, digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">all_identical</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>we proceed with a comparison of their computation times.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_bc</span></span></code></pre></div>
<pre><code><span><span class="co">## Unit: milliseconds</span></span>
<span><span class="co">##            expr        min         lq       mean     median         uq</span></span>
<span><span class="co">##      adespatial 273.974488 275.006894 283.970756 285.652798 289.739640</span></span>
<span><span class="co">##        betapart 302.981295 318.581057 331.410405 320.983778 353.094493</span></span>
<span><span class="co">##       bioregion  10.514900  10.648059  11.696890  10.891738  13.415629</span></span>
<span><span class="co">##    ecodist_dist  82.883092  90.772987 106.753786  99.619891 129.888135</span></span>
<span><span class="co">##  ecodist_bcdist   5.984290   6.002484   6.105390   6.062812   6.227314</span></span>
<span><span class="co">##       vegan_veg   1.242808   1.270690   1.803566   1.795173   2.339884</span></span>
<span><span class="co">##    vegan_design   1.368342   1.376668   1.502784   1.433899   1.633596</span></span>
<span><span class="co">##         max neval</span></span>
<span><span class="co">##  293.142265    10</span></span>
<span><span class="co">##  353.744666    10</span></span>
<span><span class="co">##   14.139309    10</span></span>
<span><span class="co">##  131.316018    10</span></span>
<span><span class="co">##    6.252481    10</span></span>
<span><span class="co">##    2.367716    10</span></span>
<span><span class="co">##    1.723685    10</span></span></code></pre>
<p>The functions from <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> continue to
outperform the others. They are again followed by <code>bcdist</code>,
while our <code>dissimilarity</code> function remains slightly slower.
The <code>distance</code> and <code>beta.div</code> functions, joined by
<code>beta.pair.abund</code>, rank significantly lower in terms of
computation speed.</p>
</div>
</div>
<div class="section level3">
<h3 id="systematic-comparison-jaccard-and-bray-curtis">Systematic comparison (Jaccard and Bray-Curtis)<a class="anchor" aria-label="anchor" href="#systematic-comparison-jaccard-and-bray-curtis"></a>
</h3>
<p>These differences in computation times become noticeable only for
(site-species) co-occurrence <code>matrix</code> objects of significant
size. To better understand the computation times for such matrices, we
perform a similar experiment using a subset of functions
(<code>beta.pair</code> and <code>beta.pair.abund</code>,
<code>dissimilarity</code>, <code>bcdist</code>, <code>vegdist</code>,
and <code>designdist</code>) on datasets with varying numbers of sites
and species.</p>
<p>The plot below shows the results obtained for the Jaccard
dissimilarity metric based on 16 combinations of numbers of sites and
species (chosen among 500, 1000, 2000, and 5000), averaged over three
replications. We also include the results from a single simulation with
10,000 sites and species.</p>
<center>
<img align="bottom" width="100%" height="100%" src="../reference/figures/comparison_Jaccard.png">
</center>
<p>A similar plot showing the results obtained for the Bray-Curtis
dissimilarity metric is available below. In this case, the results based
on a single simulation with 10,000 sites and species exclude
<code>beta.pair.abund</code> because it took too much time to
compute.</p>
<center>
<img align="bottom" width="100%" height="100%" src="../reference/figures/comparison_Bray-Curtis.png">
</center>
<!--
# Converting other R objects into bioregion dissimilarity objects

Work in progress

# Enrich a similarity/dissimilarity object

Work in progress
-->
<hr>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Baselga2012" class="csl-entry">
Baselga, A. (2012). The relationship between species replacement,
dissimilarity derived from nestedness, and nestedness. <em>Global
Ecology and Biogeography</em>, <em>21</em>(12), 1223–1232.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand, Boris Leroy, Pierre Denelle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
